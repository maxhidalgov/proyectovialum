import{r as o,X as E,E as L,c as f,b as t,e as a,F as k,au as J,o as n,f as O,m as P,t as s,n as R,a3 as U,v as i,d as V,i as Y}from"./index-DYMceNWG.js";import{V as x,b as D}from"./VCard-CBHxwNdg.js";import{V as M,a as m}from"./VRow-q--0_byE.js";import{V as w}from"./VSelect-DkqZfatN.js";import{V as b}from"./VAlert-ByNqPXc9.js";import{V as $}from"./VDataTable-BuD5hFFF.js";import"./VAvatar--oB_bTjf.js";import"./VImg-DJXENaQY.js";import"./transition-BdNk6NMH.js";import"./VCardText-4lG1nYAG.js";/* empty css              */import"./VTextField-uHRdvwvX.js";import"./VInput-Bfuylp40.js";import"./forwardRefs-DWGaNmQL.js";import"./VList-CIuBNxRS.js";import"./VDivider-CtqN3et3.js";import"./VOverlay-B0LZfzvn.js";import"./VMenu-3wN_fvCw.js";import"./VCheckboxBtn-CIqsUzBX.js";import"./VSelectionControl-mQQLVTOm.js";import"./VChip--B5kh3pi.js";const me={__name:"index",setup(j){const d=o(new Date().getMonth()+1),p=o(new Date().getFullYear()),g=o(0),y=o(0),v=o(!1),u=o(""),c=o({}),T=o([]),N=o([]),A=[{title:"Enero",value:1},{title:"Febrero",value:2},{title:"Marzo",value:3},{title:"Abril",value:4},{title:"Mayo",value:5},{title:"Junio",value:6},{title:"Julio",value:7},{title:"Agosto",value:8},{title:"Septiembre",value:9},{title:"Octubre",value:10},{title:"Noviembre",value:11},{title:"Diciembre",value:12}],B=Array.from({length:5},(r,e)=>new Date().getFullYear()-e),F=[{title:"Proveedor",key:"proveedor"},{title:"Documentos",key:"cantidad"},{title:"Total Comprado",key:"total"}],C=async()=>{v.value=!0,u.value="";try{const e=(await J.get("/api/compras-terceros-mensuales",{params:{mes:d.value,anio:p.value}})).data;g.value=e.total_mes??0,y.value=e.cantidad??0,T.value=e.labels??[],N.value=e.diarias??[],c.value=e}catch(r){u.value="Error al cargar las compras: "+r.message}finally{v.value=!1}},S=E(()=>{var r;return(r=c.value)!=null&&r.proveedores?Object.entries(c.value.proveedores).map(([e,l])=>({proveedor:e,...l})):[]});return L(()=>{C()}),(r,e)=>(n(),f(k,null,[t(x,{class:"pa-4",elevation:"2"},{default:a(()=>[t(D,{class:"text-h6"},{default:a(()=>e[2]||(e[2]=[s("Compras Mensuales (Terceros)")])),_:1}),t(M,{dense:"",class:"mb-2"},{default:a(()=>[t(m,{cols:"6",md:"4"},{default:a(()=>[t(w,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=l=>d.value=l),items:A,label:"Mes","item-title":"title","item-value":"value",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),t(m,{cols:"6",md:"4"},{default:a(()=>[t(w,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=l=>p.value=l),items:R(B),label:"AÃ±o",density:"compact","hide-details":""},null,8,["modelValue","items"])]),_:1}),t(m,{cols:"12",md:"4"},{default:a(()=>[t(U,{color:"primary",onClick:C,loading:v.value},{default:a(()=>e[3]||(e[3]=[s(" Consultar ")])),_:1},8,["loading"])]),_:1})]),_:1}),u.value?(n(),O(b,{key:0,type:"error",class:"mb-2"},{default:a(()=>[s(i(u.value),1)]),_:1})):P("",!0),t(M,null,{default:a(()=>[t(m,{cols:"12",md:"6"},{default:a(()=>[t(b,{type:"info",variant:"tonal",class:"mb-4"},{default:a(()=>[e[4]||(e[4]=V("strong",null,"Total Compras del Mes:",-1)),s(" $"+i(g.value.toLocaleString()),1)]),_:1}),t(b,{type:"info",variant:"tonal",class:"mb-2"},{default:a(()=>[e[5]||(e[5]=V("strong",null,"Cantidad de Documentos:",-1)),s(" "+i(y.value),1)]),_:1})]),_:1})]),_:1})]),_:1}),t(x,{class:"mt-6",elevation:"2"},{default:a(()=>[t(D,null,{default:a(()=>e[6]||(e[6]=[s("Resumen por Proveedor")])),_:1}),t($,{items:S.value,headers:F,class:"elevation-1"},{headers:a(({columns:l})=>[V("tr",null,[(n(!0),f(k,null,Y(l,_=>(n(),f("th",{key:_.key,class:"text-white text-left"},i(_.title),1))),128))])]),"item.total":a(({item:l})=>[s(" $"+i(Number(l.total??0).toLocaleString()),1)]),_:1},8,["items"])]),_:1})],64))}};export{me as default};
