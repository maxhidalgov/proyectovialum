import{b4 as n,aY as b,r as s,E as D,f as V,e as r,o as c,b as a,a3 as g,Z as y,t as d,c as m,F as L,i as R,v as k}from"./index-Bbf9NtO_.js";import{V as j}from"./VContainer-CT8eMPy7.js";import{V as z,a as I}from"./VRow-e2eJeLw2.js";import{V as M}from"./VDataTable-bxdMY2XJ.js";import{V as O}from"./VChip-DRg--sXz.js";import{V as Y}from"./VTextField-BML0o-9-.js";import{V as Z}from"./VSnackbar-DW5ZftGb.js";/* empty css              */import"./VSelect-CaTpVbiJ.js";import"./VInput-BQ9KC5pQ.js";import"./transition-BVD5sUHd.js";import"./forwardRefs-DWGaNmQL.js";import"./VList-B-rGQG8c.js";import"./VAvatar-CFjRqMQj.js";import"./VImg-DDK4CAHl.js";import"./VDivider-gR8e3Iny.js";import"./VOverlay-DUm3p4jJ.js";import"./VMenu-B1TTIrK1.js";import"./VCheckboxBtn-sSehld79.js";import"./VSelectionControl-BaBBSdHs.js";import"./VTable-CeArmYJ_.js";import"./filter-C_GDCAu8.js";const q={key:0},G={key:1,class:"text-disabled"},Vo={__name:"listado-productos",setup(H){n.defaults.baseURL="https://proyectovialum-production.up.railway.app/";const x=b({nombre:"",tipo:"perfil",unidad_id:"",largo_total:"",peso_por_metro:""}),w=o=>{const e=o.map(t=>{var i;return(i=t.proveedor)==null?void 0:i.nombre}).filter(Boolean);return[...new Set(e)]},u=s([]),C=s([]),P=s([]),h=s([]),B=s([]),S=s(!1),U=s(null),p=s(""),l=b({visible:!1,text:"",color:"success"}),E=[{title:"Nombre",key:"nombre"},{title:"Tipo",key:"tipo"},{title:"Unidad",key:"unidad.nombre"},{title:"Proveedor",value:"proveedor"},{title:"Acciones",key:"acciones",sortable:!1}],v=(o,e="success")=>{l.text=o,l.color=e,l.visible=!0},T=async o=>{try{await n.delete(`/api/productos/${o}`),_(),v("Producto eliminado")}catch(e){console.error(e),v("Error al eliminar producto","error")}},F=o=>{S.value=!0,U.value=o,Object.assign(x,{id:o.id,nombre:o.nombre,tipo:o.tipo,unidad_id:o.unidad_id||"",largo_total:o.largo_total||"",peso_por_metro:o.peso_por_metro||""}),B.value=(o.colores_por_proveedor||[]).map(e=>({proveedor_id:e.proveedor_id,color_id:e.color_id,costo:e.costo}))},_=async()=>{try{const{data:o}=await n.get("/api/productos");console.log("ðŸ§ª Productos cargados:",o),u.value=o}catch(o){console.error("Error cargando productos:",o)}},N=async()=>{const o=await n.get("/api/colores");P.value=o.data},$=async()=>{const o=await n.get("/api/proveedores");C.value=o.data},A=async()=>{const o=await n.get("/api/unidades");h.value=o.data};return D(()=>{N(),$(),_(),A()}),(o,e)=>(c(),V(j,{fluid:""},{default:r(()=>[a(z,null,{default:r(()=>[a(I,{cols:"12",md:"10",lg:"8",class:"mx-auto mt-6"},{default:r(()=>[a(M,{items:u.value,headers:E,search:p.value,class:"elevation-1"},{top:r(()=>[a(Y,{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=t=>p.value=t),label:"Buscar producto",class:"mx-4","prepend-inner-icon":"mdi-magnify",clearable:"",dense:""},null,8,["modelValue"])]),"item.proveedor":r(({item:t})=>{var i;return[(i=t.colores_por_proveedor)!=null&&i.length?(c(),m("div",q,[(c(!0),m(L,null,R(w(t.colores_por_proveedor),f=>(c(),V(O,{key:f,class:"ma-1",size:"small",color:"secondary",variant:"tonal"},{default:r(()=>[d(k(f),1)]),_:2},1024))),128))])):(c(),m("span",G,"Sin proveedor"))]}),"item.acciones":r(({item:t})=>[a(g,{icon:"",color:"warning",onClick:i=>F(t)},{default:r(()=>[a(y,null,{default:r(()=>e[2]||(e[2]=[d("mdi-pencil")])),_:1})]),_:2},1032,["onClick"]),a(g,{icon:"",color:"error",onClick:i=>T(t.id)},{default:r(()=>[a(y,null,{default:r(()=>e[3]||(e[3]=[d("mdi-delete")])),_:1})]),_:2},1032,["onClick"])]),_:1},8,["items","search"])]),_:1})]),_:1}),a(Z,{modelValue:l.visible,"onUpdate:modelValue":e[1]||(e[1]=t=>l.visible=t),color:l.color,timeout:3e3,top:"",right:""},{default:r(()=>[d(k(l.text),1)]),_:1},8,["modelValue","color"])]),_:1}))}};export{Vo as default};
