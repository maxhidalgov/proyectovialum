import{V as w,b as _}from"./VCard-DDUdZnPX.js";import{V as x,a as u}from"./VRow-CaX3Kydw.js";import{V as D}from"./VSelect-DFdwYAYr.js";import{r,W as h,D as E,c as f,b as t,e as a,F as M,o as m,f as $,l as L,s,m as j,a2 as J,t as i,d as V,h as O}from"./index-DxDVIud2.js";import{V as b}from"./VAlert-Dzdszmfm.js";import{V as P}from"./VDataTable-Bgp1QYLg.js";import"./VAvatar-CEYI93iM.js";import"./VImg-BA7HEsas.js";import"./index-C8vwAKkA.js";import"./VCardText-BQlyKON9.js";/* empty css              */import"./VTextField-Rtzcm1op.js";import"./forwardRefs-DWGaNmQL.js";import"./VList-DfWJwJS9.js";import"./VDivider-BuzQZiu4.js";import"./VOverlay-B0BRNcHe.js";import"./VMenu-BHHWq93I.js";import"./VCheckboxBtn-IF7fnEeB.js";import"./VChip-BiltflKq.js";const ie={__name:"index",setup(R){const d=r(new Date().getMonth()+1),p=r(new Date().getFullYear()),T=[{title:"Proveedor",key:"proveedor"},{title:"Documentos",key:"cantidad"},{title:"Total Comprado",key:"total"}],A=[{title:"Enero",value:1},{title:"Febrero",value:2},{title:"Marzo",value:3},{title:"Abril",value:4},{title:"Mayo",value:5},{title:"Junio",value:6},{title:"Julio",value:7},{title:"Agosto",value:8},{title:"Septiembre",value:9},{title:"Octubre",value:10},{title:"Noviembre",value:11},{title:"Diciembre",value:12}],B=Array.from({length:5},(o,e)=>new Date().getFullYear()-e),y=r(0),g=r(0),v=r(!1),n=r("");r({});const c=r({}),F=r([]),N=r([]),C=async()=>{v.value=!0,n.value="";try{const o=await fetch(`http://localhost:8000/api/compras-terceros-mensuales?mes=${d.value}&anio=${p.value}`);if(!o.ok){const l=await o.text();throw new Error(l)}const e=await o.json();y.value=e.total_mes,g.value=e.cantidad,F.value=e.labels,N.value=e.diarias,c.value=e}catch(o){n.value="Error al cargar las compras: "+o.message}finally{v.value=!1}},S=h(()=>{var o;return(o=c.value)!=null&&o.proveedores?Object.entries(c.value.proveedores).map(([e,l])=>({proveedor:e,...l})):[]});return E(()=>{C()}),(o,e)=>(m(),f(M,null,[t(w,{class:"pa-4",elevation:"2"},{default:a(()=>[t(_,{class:"text-h6"},{default:a(()=>e[2]||(e[2]=[s("Compras Mensuales (Terceros)")])),_:1}),t(x,{dense:"",class:"mb-2"},{default:a(()=>[t(u,{cols:"6",md:"4"},{default:a(()=>[t(D,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=l=>d.value=l),items:A,label:"Mes","item-title":"title","item-value":"value",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),t(u,{cols:"6",md:"4"},{default:a(()=>[t(D,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=l=>p.value=l),items:j(B),label:"AÃ±o",density:"compact","hide-details":""},null,8,["modelValue","items"])]),_:1}),t(u,{cols:"12",md:"4"},{default:a(()=>[t(J,{color:"primary",onClick:C,loading:v.value},{default:a(()=>e[3]||(e[3]=[s(" Consultar ")])),_:1},8,["loading"])]),_:1})]),_:1}),n.value?(m(),$(b,{key:0,type:"error",class:"mb-2"},{default:a(()=>[s(i(n.value),1)]),_:1})):L("",!0),t(x,null,{default:a(()=>[t(u,{cols:"12",md:"6"},{default:a(()=>[t(b,{type:"info",variant:"tonal",class:"mb-4"},{default:a(()=>[e[4]||(e[4]=V("strong",null,"Total Compras del Mes:",-1)),s(" $"+i(y.value.toLocaleString()),1)]),_:1}),t(b,{type:"info",variant:"tonal",class:"mb-2"},{default:a(()=>[e[5]||(e[5]=V("strong",null,"Cantidad de Documentos:",-1)),s(" "+i(g.value),1)]),_:1})]),_:1})]),_:1})]),_:1}),t(w,{class:"mt-6",elevation:"2"},{default:a(()=>[t(_,null,{default:a(()=>e[6]||(e[6]=[s("Resumen por Proveedor")])),_:1}),t(P,{items:S.value,headers:T,class:"elevation-1"},{headers:a(({columns:l})=>[V("tr",null,[(m(!0),f(M,null,O(l,k=>(m(),f("th",{key:k.key,class:"text-white text-left"},i(k.title),1))),128))])]),"item.total":a(({item:l})=>[s(" $"+i(l.total.toLocaleString()),1)]),_:1},8,["items"])]),_:1})],64))}};export{ie as default};
