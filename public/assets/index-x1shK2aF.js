import{au as z,r,E as B,c as L,b as l,e as t,o as T,d as b,a3 as E,t as k}from"./index-DRX9M9WN.js";import N from"./ClienteTable-D2AGDizg.js";import{V as x,a as u}from"./VRow-DCUoJdo7.js";import{V as U}from"./VCard-BoNNJYpO.js";import{V as A}from"./VCardText-DVBw6ri8.js";import{V as F}from"./VTextField-CTI75BqX.js";import{V as P}from"./VSelect-CFChBydQ.js";import"./VChip-DcK6QxRS.js";import"./VAvatar-DagRnBOJ.js";import"./VImg-nNk6BlCn.js";import"./transition-DJoV2taJ.js";import"./VDataTable-BILqiKJ7.js";import"./VCheckboxBtn-CZni9Hks.js";import"./VSelectionControl-KPuG38O6.js";import"./VInput-CFHeTYPz.js";import"./VDivider-DHT4taBX.js";/* empty css              */import"./forwardRefs-DWGaNmQL.js";import"./VList-Di009mj3.js";import"./VOverlay-7L_Z2Pr0.js";import"./VMenu-Bi4kyHIV.js";async function R(){try{return(await z.get("/api/clientes")).data}catch(d){return console.error("Error al obtener clientes locales:",d),[]}}const oe={__name:"index",setup(d){const c=r([]),s=r([]),m=r(!1),p=r(!1),n=r(""),i=r(null),g=async()=>{try{p.value=!0,await z.post("/api/clientes/sincronizar-bsale"),alert("✅ Clientes sincronizados correctamente"),await f()}catch(a){console.error("Error sincronizando:",a),alert("❌ Error al sincronizar clientes. Por favor, verifica la consola.")}finally{p.value=!1}},f=async()=>{m.value=!0;const a=await R();console.log("Clientes locales:",a),Array.isArray(a)?(c.value=a,s.value=a):(console.warn("⚠️ Los datos no son un array válido:",a),c.value=[],s.value=[]),m.value=!1},v=()=>{let a=[...c.value];if(n.value){const e=n.value.toLowerCase();a=a.filter(o=>{var V,C,_,w,y;return((V=o.razon_social)==null?void 0:V.toLowerCase().includes(e))||((C=o.first_name)==null?void 0:C.toLowerCase().includes(e))||((_=o.last_name)==null?void 0:_.toLowerCase().includes(e))||((w=o.identification)==null?void 0:w.toLowerCase().includes(e))||((y=o.email)==null?void 0:y.toLowerCase().includes(e))})}i.value&&(a=a.filter(e=>e.tipo_cliente===i.value)),s.value=a};return B(()=>{f()}),(a,e)=>(T(),L("div",null,[l(x,{class:"mb-4"},{default:t(()=>[l(u,null,{default:t(()=>e[2]||(e[2]=[b("h1",{class:"text-h4 mb-2"},"👥 Clientes",-1),b("p",{class:"text-medium-emphasis"},"Clientes sincronizados desde Bsale",-1)])),_:1}),l(u,{cols:"auto"},{default:t(()=>[l(E,{onClick:g,color:"primary","prepend-icon":"mdi-sync",loading:p.value},{default:t(()=>e[3]||(e[3]=[k(" Sincronizar desde Bsale ")])),_:1},8,["loading"])]),_:1})]),_:1}),l(U,null,{default:t(()=>[l(A,null,{default:t(()=>[l(x,null,{default:t(()=>[l(u,{cols:"12",md:"6"},{default:t(()=>[l(F,{modelValue:n.value,"onUpdate:modelValue":e[0]||(e[0]=o=>n.value=o),label:"Buscar cliente",placeholder:"Buscar por nombre, RUT, email...","prepend-inner-icon":"mdi-magnify",clearable:"",outlined:"",dense:"",onInput:v},null,8,["modelValue"])]),_:1}),l(u,{cols:"12",md:"3"},{default:t(()=>[l(P,{modelValue:i.value,"onUpdate:modelValue":[e[1]||(e[1]=o=>i.value=o),v],items:[{title:"Todos",value:null},{title:"Empresas",value:"empresa"},{title:"Personas",value:"persona"}],label:"Tipo de cliente",outlined:"",dense:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),l(N,{clientes:s.value,loading:m.value},null,8,["clientes","loading"])]))}};export{oe as default};
