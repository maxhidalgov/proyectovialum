import{r as l,W as E,D as L,c as f,b as t,e as a,F as k,at as J,o as n,f as O,l as P,s,m as R,a2 as U,t as i,d as V,h as Y}from"./index-FGSunMJY.js";import{V as D,b as x}from"./VCard-Bbl-KwCa.js";import{V as M,a as m}from"./VRow-Crh3qFb1.js";import{V as w}from"./VSelect-B5ao1Opi.js";import{V as b}from"./VAlert-9RoHi22J.js";import{V as $}from"./VDataTable-th0k0Jza.js";import"./VAvatar-BlD84t2b.js";import"./VImg-BidAYaxB.js";import"./index-6-DCdOXz.js";import"./VCardText-D7e5QzJH.js";/* empty css              */import"./VTextField-RPy84ABs.js";import"./forwardRefs-DWGaNmQL.js";import"./VList-DUOSWP1W.js";import"./VDivider-5WSCDI51.js";import"./VOverlay-DYSkQdJ8.js";import"./VMenu-C4fADKBr.js";import"./VCheckboxBtn-DF8jgzm3.js";import"./VChip-BBgoliR1.js";const ue={__name:"index",setup(h){const d=l(new Date().getMonth()+1),p=l(new Date().getFullYear()),T=[{title:"Proveedor",key:"proveedor"},{title:"Documentos",key:"cantidad"},{title:"Total Comprado",key:"total"}],S=[{title:"Enero",value:1},{title:"Febrero",value:2},{title:"Marzo",value:3},{title:"Abril",value:4},{title:"Mayo",value:5},{title:"Junio",value:6},{title:"Julio",value:7},{title:"Agosto",value:8},{title:"Septiembre",value:9},{title:"Octubre",value:10},{title:"Noviembre",value:11},{title:"Diciembre",value:12}],A=Array.from({length:5},(r,e)=>new Date().getFullYear()-e),g=l(0),y=l(0),v=l(!1),u=l("");l({});const c=l({}),B=l([]),F=l([]),C=async()=>{v.value=!0,u.value="";try{const e=(await J.get("/api/dashboard/compras-terceros-mensuales",{params:{mes:d.value,anio:p.value,proveedor_id:proveedorSeleccionado.value}})).data;g.value=e.total_mes,y.value=e.cantidad,B.value=e.labels,F.value=e.diarias,c.value=e}catch(r){u.value="Error al cargar las compras: "+r.message}finally{v.value=!1}},N=E(()=>{var r;return(r=c.value)!=null&&r.proveedores?Object.entries(c.value.proveedores).map(([e,o])=>({proveedor:e,...o})):[]});return L(()=>{C()}),(r,e)=>(n(),f(k,null,[t(D,{class:"pa-4",elevation:"2"},{default:a(()=>[t(x,{class:"text-h6"},{default:a(()=>e[2]||(e[2]=[s("Compras Mensuales (Terceros)")])),_:1}),t(M,{dense:"",class:"mb-2"},{default:a(()=>[t(m,{cols:"6",md:"4"},{default:a(()=>[t(w,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=o=>d.value=o),items:S,label:"Mes","item-title":"title","item-value":"value",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1}),t(m,{cols:"6",md:"4"},{default:a(()=>[t(w,{modelValue:p.value,"onUpdate:modelValue":e[1]||(e[1]=o=>p.value=o),items:R(A),label:"AÃ±o",density:"compact","hide-details":""},null,8,["modelValue","items"])]),_:1}),t(m,{cols:"12",md:"4"},{default:a(()=>[t(U,{color:"primary",onClick:C,loading:v.value},{default:a(()=>e[3]||(e[3]=[s(" Consultar ")])),_:1},8,["loading"])]),_:1})]),_:1}),u.value?(n(),O(b,{key:0,type:"error",class:"mb-2"},{default:a(()=>[s(i(u.value),1)]),_:1})):P("",!0),t(M,null,{default:a(()=>[t(m,{cols:"12",md:"6"},{default:a(()=>[t(b,{type:"info",variant:"tonal",class:"mb-4"},{default:a(()=>[e[4]||(e[4]=V("strong",null,"Total Compras del Mes:",-1)),s(" $"+i(g.value.toLocaleString()),1)]),_:1}),t(b,{type:"info",variant:"tonal",class:"mb-2"},{default:a(()=>[e[5]||(e[5]=V("strong",null,"Cantidad de Documentos:",-1)),s(" "+i(y.value),1)]),_:1})]),_:1})]),_:1})]),_:1}),t(D,{class:"mt-6",elevation:"2"},{default:a(()=>[t(x,null,{default:a(()=>e[6]||(e[6]=[s("Resumen por Proveedor")])),_:1}),t($,{items:N.value,headers:T,class:"elevation-1"},{headers:a(({columns:o})=>[V("tr",null,[(n(!0),f(k,null,Y(o,_=>(n(),f("th",{key:_.key,class:"text-white text-left"},i(_.title),1))),128))])]),"item.total":a(({item:o})=>[s(" $"+i(o.total.toLocaleString()),1)]),_:1},8,["items"])]),_:1})],64))}};export{ue as default};
