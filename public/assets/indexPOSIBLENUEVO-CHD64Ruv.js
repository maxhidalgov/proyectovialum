import{av as $,r as d,E as I,aG as n,f as D,e as a,o as k,b as l,t as m,a3 as x,d as i,c as U,F as R,i as Z,v as u,Z as j}from"./index-BkN66Jee.js";import{_ as q}from"./AgregarVentanaModal2-YIbZFTCa.js";import{V as H}from"./VContainer-DHMbZyNg.js";import{V as E,b as B,c as M}from"./VCard-BIq9KtZy.js";import{V as w}from"./VCardText-yvZq5wFx.js";import{V as J,a as s}from"./VRow-zuKfOnXG.js";import{V as K}from"./VAutocomplete-CJYFT9o9.js";import{V as Q}from"./VTextField-CvSPcfDi.js";import{V as b}from"./VSelect-qe3QKkar.js";import{a as W}from"./VDataTable-DrR-NKoO.js";import{V as X}from"./VSpacer-DstO-xmX.js";import"./VistaBayWindow-BYf8gQa4.js";import"./VistaVentanaCorredera-Cvivq42t.js";import"./VSwitch-CKg5f6_W.js";import"./VInput-CN2X7-5r.js";import"./transition-ClaezFJr.js";import"./VSelectionControl-Fr9-jP0N.js";import"./VRadioGroup-BuD3u4GL.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VDialog-Vz5WCGXr.js";import"./VOverlay-CN7rzLfz.js";import"./forwardRefs-DWGaNmQL.js";import"./VDivider-izuRbe5V.js";import"./VForm-D1--ze3Q.js";import"./VAlert-B_cBy9LO.js";import"./VAvatar-CUG03JWJ.js";import"./VImg-B-BAd-J6.js";import"./VList-CGw_ag0t.js";/* empty css              */import"./VMenu-BRJgvGXh.js";import"./VCheckboxBtn-sD-GE5AJ.js";import"./VChip-B3ZmS2Q6.js";const So={__name:"indexPOSIBLENUEVO",setup(Y){const r=$({cliente_id:null,observaciones:"",material_id:null,color_id:null,tipo_vidrio_id:null,producto_vidrio_id:null}),z=d([]),p=d([]),c=d([]),C=d([]),g=d([]),V=d([]),v=d([]),y=d(!1),A=()=>{y.value=!0},S=async e=>{try{const{data:o}=await n.post("/api/cotizador/calcular-materiales",e);v.value.push({...e,costo:o.costo_total})}catch(o){console.error("Error calculando materiales:",o)}},N=e=>{v.value.splice(e,1)},P=async()=>{try{const e={...r,ventanas:v.value};await n.post("/api/cotizaciones",e),alert("Cotización guardada correctamente")}catch(e){console.error("Error guardando cotización:",e)}};I(async()=>{try{const[e,o,t,f,_,T]=await Promise.all([n.get("/api/clientes"),n.get("/api/materiales"),n.get("/api/colores"),n.get("/api/tipos-vidrio"),n.get("/api/tipos-ventana"),n.get("/api/productos-vidrio")]);z.value=e.data,p.value=o.data,c.value=t.data,C.value=f.data,g.value=_.data,V.value=T.data}catch(e){console.error("Error cargando catálogos:",e)}});const F=e=>{var o;return((o=g.value.find(t=>t.id===e))==null?void 0:o.nombre)||""},G=e=>{var o;return((o=p.value.find(t=>t.id===e))==null?void 0:o.nombre)||""},L=e=>{var o;return((o=c.value.find(t=>t.id===e))==null?void 0:o.nombre)||""},O=e=>{var o;return((o=V.value.find(t=>t.id===e))==null?void 0:o.nombre)||""};return(e,o)=>(k(),D(H,{fluid:""},{default:a(()=>[l(E,null,{default:a(()=>[l(B,null,{default:a(()=>o[7]||(o[7]=[m("Cotizador")])),_:1}),l(w,null,{default:a(()=>[l(J,null,{default:a(()=>[l(s,{cols:"12",md:"6"},{default:a(()=>[l(K,{label:"Cliente",items:z.value,modelValue:r.cliente_id,"onUpdate:modelValue":o[0]||(o[0]=t=>r.cliente_id=t),"item-title":"nombre","item-value":"id"},null,8,["items","modelValue"])]),_:1}),l(s,{cols:"12",md:"6"},{default:a(()=>[l(Q,{label:"Observaciones",modelValue:r.observaciones,"onUpdate:modelValue":o[1]||(o[1]=t=>r.observaciones=t)},null,8,["modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:a(()=>[l(b,{label:"Material",items:p.value,"item-title":"nombre","item-value":"id",modelValue:r.material_id,"onUpdate:modelValue":o[2]||(o[2]=t=>r.material_id=t)},null,8,["items","modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:a(()=>[l(b,{label:"Color",items:c.value,"item-title":"nombre","item-value":"id",modelValue:r.color_id,"onUpdate:modelValue":o[3]||(o[3]=t=>r.color_id=t)},null,8,["items","modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:a(()=>[l(b,{label:"Tipo de vidrio",items:C.value,"item-title":"nombre","item-value":"id",modelValue:r.tipo_vidrio_id,"onUpdate:modelValue":o[4]||(o[4]=t=>r.tipo_vidrio_id=t)},null,8,["items","modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:a(()=>[l(b,{label:"Producto de vidrio",items:V.value,"item-title":"nombre","item-value":"id",modelValue:r.producto_vidrio_id,"onUpdate:modelValue":o[5]||(o[5]=t=>r.producto_vidrio_id=t)},null,8,["items","modelValue"])]),_:1})]),_:1})]),_:1}),l(M,null,{default:a(()=>[l(x,{color:"primary",onClick:A},{default:a(()=>o[8]||(o[8]=[m(" Agregar Ventana ")])),_:1})]),_:1})]),_:1}),l(E,{class:"mt-4"},{default:a(()=>[l(B,null,{default:a(()=>o[9]||(o[9]=[m("Ventanas en esta cotización")])),_:1}),l(w,null,{default:a(()=>[l(W,null,{default:a(()=>[o[11]||(o[11]=i("thead",null,[i("tr",null,[i("th",null,"Ancho"),i("th",null,"Alto"),i("th",null,"Cantidad"),i("th",null,"Tipo ventana"),i("th",null,"Material"),i("th",null,"Color"),i("th",null,"Vidrio"),i("th",null,"Costo"),i("th")])],-1)),i("tbody",null,[(k(!0),U(R,null,Z(v.value,(t,f)=>{var _;return k(),U("tr",{key:f},[i("td",null,u(t.ancho),1),i("td",null,u(t.alto),1),i("td",null,u(t.cantidad),1),i("td",null,u(F(t.tipo_ventana_id)),1),i("td",null,u(G(t.material_id)),1),i("td",null,u(L(t.color_id)),1),i("td",null,u(O(t.producto_vidrio_id)),1),i("td",null,"$"+u((_=t.costo)==null?void 0:_.toLocaleString()),1),i("td",null,[l(x,{icon:"",color:"red",onClick:T=>N(f)},{default:a(()=>[l(j,null,{default:a(()=>o[10]||(o[10]=[m("mdi-delete")])),_:1})]),_:2},1032,["onClick"])])])}),128))])]),_:1})]),_:1}),l(M,null,{default:a(()=>[l(X),l(x,{color:"success",onClick:P},{default:a(()=>o[12]||(o[12]=[m(" Guardar Cotización ")])),_:1})]),_:1})]),_:1}),l(q,{mostrar:y.value,"onUpdate:mostrar":o[6]||(o[6]=t=>y.value=t),onGuardar:S,tiposVentana:g.value,colores:c.value,materiales:p.value,tiposVidrio:C.value,productosVidrio:V.value},null,8,["mostrar","tiposVentana","colores","materiales","tiposVidrio","productosVidrio"])]),_:1}))}};export{So as default};
