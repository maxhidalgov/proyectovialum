import{r as k,E as $,au as m,f as _,e,k as g,o as x,b as i,t as n,a3 as s,n as f,Z as d,v as u}from"./index-DYMceNWG.js";import{V as E,b as w}from"./VCard-CBHxwNdg.js";import{V as A}from"./VSpacer-B375I71-.js";import{V as B}from"./VDataTable-BuD5hFFF.js";import{V as D}from"./VChip--B5kh3pi.js";import"./VAvatar--oB_bTjf.js";import"./VImg-DJXENaQY.js";import"./transition-BdNk6NMH.js";import"./VCardText-4lG1nYAG.js";/* empty css              */import"./VSelect-DkqZfatN.js";import"./VTextField-uHRdvwvX.js";import"./VInput-Bfuylp40.js";import"./forwardRefs-DWGaNmQL.js";import"./VList-CIuBNxRS.js";import"./VDivider-CtqN3et3.js";import"./VOverlay-B0LZfzvn.js";import"./VMenu-3wN_fvCw.js";import"./VCheckboxBtn-CIqsUzBX.js";import"./VSelectionControl-mQQLVTOm.js";const X={__name:"index",setup(h){const v="https://proyectovialum-backend-production.up.railway.app",c=g(),p=k([]),z=[{title:"ID",value:"id"},{title:"Cliente",value:"cliente"},{title:"Vendedor",value:"vendedor"},{title:"Fecha",value:"fecha"},{title:"Estado",value:"estado"},{title:"Acciones",value:"acciones",sortable:!1}],C=t=>{switch(t){case"Evaluación":return"grey";case"Aprobada":return"green";case"Rechazada":return"red";default:return"blue"}},b=t=>{c.push(`/cotizacion-ver?id=${t.id}`)},V=t=>{c.push(`/cotizacion-editar?id=${t.id}`)},y=async t=>{if(confirm(`¿Deseas duplicar la cotización #${t.id}?`))try{const a=await m.post(`/api/cotizaciones/${t.id}/duplicar`);alert("Cotización duplicada con éxito"),c.push(`/cotizacion-editar?id=${a.data.id}`)}catch(a){console.error(a),alert("Error al duplicar la cotización")}};return $(async()=>{try{const t=await m.get("/api/cotizaciones");p.value=Array.isArray(t.data)?t.data:[]}catch(t){console.error("Error al cargar cotizaciones:",t),p.value=[]}}),(t,a)=>(x(),_(E,null,{default:e(()=>[i(w,null,{default:e(()=>[a[2]||(a[2]=n(" Cotizaciones ")),i(A),i(s,{color:"primary",onClick:a[0]||(a[0]=o=>f(c).push({name:"cotizador"}))},{default:e(()=>a[1]||(a[1]=[n("Nueva")])),_:1})]),_:1}),i(B,{headers:z,items:p.value,"items-per-page":10,class:"elevation-1"},{"item.cliente":e(({item:o})=>{var r;return[n(u(((r=o.cliente)==null?void 0:r.razon_social)||"—"),1)]}),"item.vendedor":e(({item:o})=>{var r;return[n(u(((r=o.vendedor)==null?void 0:r.name)||"—"),1)]}),"item.estado":e(({item:o})=>{var r;return[i(D,{color:C((r=o.estado)==null?void 0:r.nombre)},{default:e(()=>{var l;return[n(u(((l=o.estado)==null?void 0:l.nombre)||"—"),1)]}),_:2},1032,["color"])]}),"item.acciones":e(({item:o})=>{var r;return[i(s,{icon:"",onClick:l=>b(o)},{default:e(()=>[i(d,null,{default:e(()=>a[3]||(a[3]=[n("mdi-eye")])),_:1})]),_:2},1032,["onClick"]),i(s,{icon:"",onClick:l=>V(o),disabled:((r=o.estado)==null?void 0:r.nombre)==="Aprobada"},{default:e(()=>[i(d,null,{default:e(()=>a[4]||(a[4]=[n("mdi-pencil")])),_:1})]),_:2},1032,["onClick","disabled"]),i(s,{icon:"",href:`${f(v)}/api/cotizaciones/${o.id}/pdf`,target:"_blank"},{default:e(()=>[i(d,null,{default:e(()=>a[5]||(a[5]=[n("mdi-file-pdf-box")])),_:1})]),_:2},1032,["href"]),i(s,{icon:"",onClick:l=>y(o)},{default:e(()=>[i(d,null,{default:e(()=>a[6]||(a[6]=[n("mdi-content-copy")])),_:1})]),_:2},1032,["onClick"])]}),_:1},8,["items"])]),_:1}))}};export{X as default};
