import{j as T,r as x,X as P,E,ar as B,f as b,e as o,k as R,o as p,b as r,m as V,t as l,v as s,a3 as C,Z as A,d,c as U}from"./index-BAT6t6dn.js";import{V as j}from"./VContainer-BzGFklfp.js";import{V as v,b as f}from"./VCard-BwJMo3Sa.js";import{V as I}from"./VSpacer-DI5E1xVm.js";import{V as q}from"./VCardText-BzaBTWSG.js";import{V as D,a as m}from"./VRow-D-y_YGx3.js";import{V as M}from"./VChip-Cn1fsBNb.js";import{V as L}from"./VDataTable--xW2Rabd.js";import{V as O}from"./VAlert-KDtKTwGG.js";/* empty css              */import"./VAvatar-B1MGj36n.js";import"./VImg-CddH4jLD.js";import"./transition-nEvIYTAk.js";import"./VSelect-lk15yJVS.js";import"./VTextField-BwzlFcri.js";import"./VInput-CdCpa2l2.js";import"./forwardRefs-DWGaNmQL.js";import"./VList-C2cLds-k.js";import"./VDivider-B77JXK-_.js";import"./VOverlay-eVUtE9Lb.js";import"./VMenu-c_WJAP6D.js";import"./VCheckboxBtn-DArM_N6A.js";import"./VSelectionControl-C2iAaFOT.js";import"./filter-MkpO6Exy.js";const X={key:0},_t={__name:"cotizacion-ver",setup(Z){const y=T(),w=R(),k=y.query.id,n=x(null),z=[{title:"Tipo de ventana",value:"tipo_ventana_id"},{title:"Ancho (mm)",value:"ancho"},{title:"Alto (mm)",value:"alto"},{title:"Cantidad",value:"cantidad"},{title:"Color",value:"color.nombre"},{title:"Vidrio",value:"producto_vidrio_proveedor_id"},{title:"Costo",value:"costo"},{title:"Precio Unitario",value:"precio"},{title:"Precio Total",value:"precio_total"}],F=[{title:"Descripción",value:"descripcion"},{title:"Cantidad",value:"cantidad"},{title:"Precio Unitario",value:"precio_unitario"},{title:"Total",value:"total"}],_=P(()=>{var u;return(u=n.value)!=null&&u.detalles?n.value.detalles.filter(e=>e.tipo_item==="producto"):[]}),N=u=>{switch(u){case"Evaluación":return"grey";case"Aprobada":return"green";case"Rechazada":return"red";default:return"blue"}},$=()=>{w.push({name:"cotizaciones"})},S=()=>{const u=window.location.hostname==="localhost"?"http://localhost:8000":"https://proyectovialum-production.up.railway.app";window.open(`${u}/api/cotizaciones/${n.value.id}/pdf`,"_blank")};return E(async()=>{try{const{data:u}=await B.get(`/api/cotizaciones/${k}`);n.value=u}catch(u){console.error("Error al cargar cotización:",u)}}),(u,e)=>(p(),b(j,null,{default:o(()=>[r(v,{class:"mb-4"},{default:o(()=>[r(f,null,{default:o(()=>{var a,t;return[l(" Cotización #"+s((a=n.value)==null?void 0:a.id)+" ",1),r(C,{class:"ml-2",color:"secondary",onClick:S,disabled:!((t=n.value)!=null&&t.id)},{default:o(()=>e[0]||(e[0]=[l(" Descargar PDF ")])),_:1},8,["disabled"]),r(I),r(C,{icon:"",onClick:$},{default:o(()=>[r(A,null,{default:o(()=>e[1]||(e[1]=[l("mdi-arrow-left")])),_:1})]),_:1})]}),_:1}),r(q,null,{default:o(()=>[r(D,null,{default:o(()=>[r(m,{cols:"12",sm:"6"},{default:o(()=>{var a,t;return[e[2]||(e[2]=d("strong",null,"Cliente:",-1)),l(" "+s((t=(a=n.value)==null?void 0:a.cliente)==null?void 0:t.nombre),1)]}),_:1}),r(m,{cols:"12",sm:"6"},{default:o(()=>{var a,t;return[e[3]||(e[3]=d("strong",null,"Vendedor:",-1)),l(" "+s((t=(a=n.value)==null?void 0:a.vendedor)==null?void 0:t.name),1)]}),_:1}),r(m,{cols:"12",sm:"6"},{default:o(()=>{var a;return[e[4]||(e[4]=d("strong",null,"Fecha:",-1)),l(" "+s((a=n.value)==null?void 0:a.fecha),1)]}),_:1}),r(m,{cols:"12",sm:"6"},{default:o(()=>{var a,t;return[e[5]||(e[5]=d("strong",null,"Estado:",-1)),r(M,{color:N((t=(a=n.value)==null?void 0:a.estado)==null?void 0:t.nombre)},{default:o(()=>{var i,c;return[l(s(((c=(i=n.value)==null?void 0:i.estado)==null?void 0:c.nombre)||"—"),1)]}),_:1},8,["color"])]}),_:1}),r(m,{cols:"12"},{default:o(()=>{var a;return[e[6]||(e[6]=d("strong",null,"Observaciones:",-1)),e[7]||(e[7]=d("br",null,null,-1)),l(" "+s(((a=n.value)==null?void 0:a.observaciones)||"—"),1)]}),_:1})]),_:1})]),_:1})]),_:1}),r(v,null,{default:o(()=>{var a;return[r(f,null,{default:o(()=>e[8]||(e[8]=[l("Ventanas")])),_:1}),r(L,{headers:z,items:((a=n.value)==null?void 0:a.ventanas)||[],"items-per-page":5,class:"elevation-1"},{"item.tipo_ventana_id":o(({item:t})=>{var i;return[l(s(((i=t.tipo_ventana)==null?void 0:i.nombre)||"—"),1)]}),"item.producto_vidrio_proveedor_id":o(({item:t})=>{var i,c,g;return[l(s(((c=(i=t.producto_vidrio_proveedor)==null?void 0:i.producto)==null?void 0:c.nombre)||"—")+" ",1),(g=t.producto_vidrio_proveedor)!=null&&g.proveedor?(p(),U("span",X," ("+s(t.producto_vidrio_proveedor.proveedor.nombre)+") ",1)):V("",!0)]}),"item.costo":o(({item:t})=>{var i;return[l(" $"+s(((i=Number(t.costo))==null?void 0:i.toLocaleString("es-CL",{minimumFractionDigits:0}))||0),1)]}),"item.precio":o(({item:t})=>{var i;return[l(" $"+s(((i=Number(t.precio))==null?void 0:i.toLocaleString("es-CL",{minimumFractionDigits:0}))||0),1)]}),"item.precio_total":o(({item:t})=>{var i;return[l(" $"+s(((i=Number(t.precio_total))==null?void 0:i.toLocaleString("es-CL",{minimumFractionDigits:0}))||0),1)]}),_:1},8,["items"]),r(D,{justify:"end",class:"px-6 pb-4"},{default:o(()=>[r(m,{cols:"12",sm:"4",class:"text-right"},{default:o(()=>[r(O,{type:"success",variant:"tonal",border:"start","border-color":"green"},{default:o(()=>{var t,i;return[e[9]||(e[9]=d("strong",null,"Total general:",-1)),l(" $"+s(((i=(t=n.value)==null?void 0:t.total_general)==null?void 0:i.toLocaleString("es-CL",{minimumFractionDigits:0}))||0),1)]}),_:1})]),_:1})]),_:1})]}),_:1}),_.value.length>0?(p(),b(v,{key:0,class:"mt-4"},{default:o(()=>[r(f,null,{default:o(()=>e[10]||(e[10]=[l("Productos")])),_:1}),r(L,{headers:F,items:_.value,"items-per-page":5,class:"elevation-1"},{"item.precio_unitario":o(({item:a})=>{var t;return[l(" $"+s(((t=Number(a.precio_unitario))==null?void 0:t.toLocaleString("es-CL",{minimumFractionDigits:0}))||0),1)]}),"item.total":o(({item:a})=>{var t;return[l(" $"+s(((t=Number(a.total))==null?void 0:t.toLocaleString("es-CL",{minimumFractionDigits:0}))||0),1)]}),_:1},8,["items"])]),_:1})):V("",!0)]),_:1}))}};export{_t as default};
