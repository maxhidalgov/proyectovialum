import{aE as G,r as d,E as I,aP as n,f as D,e as a,o as k,b as l,t as m,a3 as x,d as i,c as T,F as R,i as Z,v as u,Z as j}from"./index-zXGCFGIg.js";import{_ as q}from"./AgregarVentanaModal2-Ca_5PTI_.js";import{V as H}from"./VContainer-CpOFiaMQ.js";import{V as U,b as B,c as M}from"./VCard-BivyUXWm.js";import{V as w}from"./VCardText-C6b6sPjd.js";import{V as J,a as s}from"./VRow-C1LQQmap.js";import{V as K}from"./VAutocomplete-12hiAiJ8.js";import{V as Q}from"./VTextField-B1sfjoWq.js";import{V as b}from"./VSelect-DPytfcsj.js";import{a as W}from"./VDataTable-CyyfS5q2.js";import{V as X}from"./VSpacer-Cu14cexP.js";import"./VistaBayWindow-C0Hl_Okn.js";import"./VistaVentanaCorredera-DgPVd85-.js";import"./VSwitch-CWB8uIkB.js";import"./VInput-pyJZwFq9.js";import"./transition-BvxzZJi3.js";import"./VSelectionControl-DgQkzTB8.js";import"./VRadioGroup-3z3PapYG.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VDialog-DbzeL1Fr.js";import"./VOverlay-C3-CcM7k.js";import"./forwardRefs-DWGaNmQL.js";import"./VDivider-Dz9kH9oT.js";import"./VForm-jEwAazGb.js";import"./VAlert-DnyJZ4VW.js";import"./VAvatar-MgFTNfdu.js";import"./VImg-CHMTV0xF.js";import"./VList-B-_lPbF_.js";/* empty css              */import"./filter-C9QZNLH-.js";import"./VMenu-5q30PoDq.js";import"./VCheckboxBtn-D0lPBrIw.js";import"./VChip-8OtzmJWd.js";const So={__name:"indexPOSIBLENUEVO",setup(Y){const r=G({cliente_id:null,observaciones:"",material_id:null,color_id:null,tipo_vidrio_id:null,producto_vidrio_id:null}),z=d([]),p=d([]),c=d([]),C=d([]),g=d([]),V=d([]),v=d([]),y=d(!1),A=()=>{y.value=!0},P=async e=>{try{const{data:o}=await n.post("/api/cotizador/calcular-materiales",e);v.value.push({...e,costo:o.costo_total})}catch(o){console.error("Error calculando materiales:",o)}},S=e=>{v.value.splice(e,1)},N=async()=>{try{const e={...r,ventanas:v.value};await n.post("/api/cotizaciones",e),alert("Cotización guardada correctamente")}catch(e){console.error("Error guardando cotización:",e)}};I(async()=>{try{const[e,o,t,f,_,E]=await Promise.all([n.get("/api/clientes"),n.get("/api/materiales"),n.get("/api/colores"),n.get("/api/tipos-vidrio"),n.get("/api/tipos-ventana"),n.get("/api/productos-vidrio")]);z.value=e.data,p.value=o.data,c.value=t.data,C.value=f.data,g.value=_.data,V.value=E.data}catch(e){console.error("Error cargando catálogos:",e)}});const F=e=>{var o;return((o=g.value.find(t=>t.id===e))==null?void 0:o.nombre)||""},L=e=>{var o;return((o=p.value.find(t=>t.id===e))==null?void 0:o.nombre)||""},O=e=>{var o;return((o=c.value.find(t=>t.id===e))==null?void 0:o.nombre)||""},$=e=>{var o;return((o=V.value.find(t=>t.id===e))==null?void 0:o.nombre)||""};return(e,o)=>(k(),D(H,{fluid:""},{default:a(()=>[l(U,null,{default:a(()=>[l(B,null,{default:a(()=>o[7]||(o[7]=[m("Cotizador")])),_:1}),l(w,null,{default:a(()=>[l(J,null,{default:a(()=>[l(s,{cols:"12",md:"6"},{default:a(()=>[l(K,{label:"Cliente",items:z.value,modelValue:r.cliente_id,"onUpdate:modelValue":o[0]||(o[0]=t=>r.cliente_id=t),"item-title":"nombre","item-value":"id"},null,8,["items","modelValue"])]),_:1}),l(s,{cols:"12",md:"6"},{default:a(()=>[l(Q,{label:"Observaciones",modelValue:r.observaciones,"onUpdate:modelValue":o[1]||(o[1]=t=>r.observaciones=t)},null,8,["modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:a(()=>[l(b,{label:"Material",items:p.value,"item-title":"nombre","item-value":"id",modelValue:r.material_id,"onUpdate:modelValue":o[2]||(o[2]=t=>r.material_id=t)},null,8,["items","modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:a(()=>[l(b,{label:"Color",items:c.value,"item-title":"nombre","item-value":"id",modelValue:r.color_id,"onUpdate:modelValue":o[3]||(o[3]=t=>r.color_id=t)},null,8,["items","modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:a(()=>[l(b,{label:"Tipo de vidrio",items:C.value,"item-title":"nombre","item-value":"id",modelValue:r.tipo_vidrio_id,"onUpdate:modelValue":o[4]||(o[4]=t=>r.tipo_vidrio_id=t)},null,8,["items","modelValue"])]),_:1}),l(s,{cols:"6",md:"3"},{default:a(()=>[l(b,{label:"Producto de vidrio",items:V.value,"item-title":"nombre","item-value":"id",modelValue:r.producto_vidrio_id,"onUpdate:modelValue":o[5]||(o[5]=t=>r.producto_vidrio_id=t)},null,8,["items","modelValue"])]),_:1})]),_:1})]),_:1}),l(M,null,{default:a(()=>[l(x,{color:"primary",onClick:A},{default:a(()=>o[8]||(o[8]=[m(" Agregar Ventana ")])),_:1})]),_:1})]),_:1}),l(U,{class:"mt-4"},{default:a(()=>[l(B,null,{default:a(()=>o[9]||(o[9]=[m("Ventanas en esta cotización")])),_:1}),l(w,null,{default:a(()=>[l(W,null,{default:a(()=>[o[11]||(o[11]=i("thead",null,[i("tr",null,[i("th",null,"Ancho"),i("th",null,"Alto"),i("th",null,"Cantidad"),i("th",null,"Tipo ventana"),i("th",null,"Material"),i("th",null,"Color"),i("th",null,"Vidrio"),i("th",null,"Costo"),i("th")])],-1)),i("tbody",null,[(k(!0),T(R,null,Z(v.value,(t,f)=>{var _;return k(),T("tr",{key:f},[i("td",null,u(t.ancho),1),i("td",null,u(t.alto),1),i("td",null,u(t.cantidad),1),i("td",null,u(F(t.tipo_ventana_id)),1),i("td",null,u(L(t.material_id)),1),i("td",null,u(O(t.color_id)),1),i("td",null,u($(t.producto_vidrio_id)),1),i("td",null,"$"+u((_=t.costo)==null?void 0:_.toLocaleString()),1),i("td",null,[l(x,{icon:"",color:"red",onClick:E=>S(f)},{default:a(()=>[l(j,null,{default:a(()=>o[10]||(o[10]=[m("mdi-delete")])),_:1})]),_:2},1032,["onClick"])])])}),128))])]),_:1})]),_:1}),l(M,null,{default:a(()=>[l(X),l(x,{color:"success",onClick:N},{default:a(()=>o[12]||(o[12]=[m(" Guardar Cotización ")])),_:1})]),_:1})]),_:1}),l(q,{mostrar:y.value,"onUpdate:mostrar":o[6]||(o[6]=t=>y.value=t),onGuardar:P,tiposVentana:g.value,colores:c.value,materiales:p.value,tiposVidrio:C.value,productosVidrio:V.value},null,8,["mostrar","tiposVentana","colores","materiales","tiposVidrio","productosVidrio"])]),_:1}))}};export{So as default};
