import{av as G,r as d,E as I,aO as n,f as D,e as a,o as k,b as t,t as m,a3 as x,d as i,c as U,F as R,i as Z,v as u,Z as j}from"./index-Cu3tphjX.js";import{_ as q}from"./AgregarVentanaModal2-CWCSpw8o.js";import{V as H}from"./VContainer-BWJRpcfK.js";import{V as E,b as B,c as M}from"./VCard-B1AyIHFd.js";import{V as w}from"./VCardText-c2SX0qgU.js";import{V as J,a as s}from"./VRow-561BeA05.js";import{V as K}from"./VAutocomplete-B4eFkTtO.js";import{V as Q}from"./VTextField-aWHR9hJp.js";import{V as b}from"./VSelect-BWCy4kkM.js";import{a as W}from"./VDataTable-WIbtfv1u.js";import{V as X}from"./VSpacer-CdM4Gc-D.js";import"./VistaBayWindow-BCQr6ITg.js";import"./VistaVentanaCorredera-C45JHmUM.js";import"./VInput-Teqm9z0g.js";import"./transition-Cj8qiHBk.js";import"./VSelectionControl-CH4xzn42.js";import"./VRadioGroup-CBucfv4r.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./VDialog-Db0rPBsI.js";import"./VOverlay-DB8k9TJr.js";import"./forwardRefs-DWGaNmQL.js";import"./VDivider-Cq_kmRT3.js";import"./VForm-CvCneUme.js";import"./VAlert-i_4i1Au_.js";import"./VAvatar-Btr2veI_.js";import"./VImg-DYslh2c-.js";import"./VList-BEOL-0y0.js";/* empty css              */import"./VMenu-CVbnNKkq.js";import"./VCheckboxBtn-DSwUSxvh.js";import"./VChip-xE4TOXZB.js";const Ao={__name:"indexPOSIBLENUEVO",setup(Y){const r=G({cliente_id:null,observaciones:"",material_id:null,color_id:null,tipo_vidrio_id:null,producto_vidrio_id:null}),z=d([]),p=d([]),c=d([]),C=d([]),g=d([]),V=d([]),v=d([]),y=d(!1),A=()=>{y.value=!0},S=async e=>{try{const{data:o}=await n.post("/api/cotizador/calcular-materiales",e);v.value.push({...e,costo:o.costo_total})}catch(o){console.error("Error calculando materiales:",o)}},N=e=>{v.value.splice(e,1)},O=async()=>{try{const e={...r,ventanas:v.value};await n.post("/api/cotizaciones",e),alert("Cotización guardada correctamente")}catch(e){console.error("Error guardando cotización:",e)}};I(async()=>{try{const[e,o,l,f,_,T]=await Promise.all([n.get("/api/clientes"),n.get("/api/materiales"),n.get("/api/colores"),n.get("/api/tipos-vidrio"),n.get("/api/tipos-ventana"),n.get("/api/productos-vidrio")]);z.value=e.data,p.value=o.data,c.value=l.data,C.value=f.data,g.value=_.data,V.value=T.data}catch(e){console.error("Error cargando catálogos:",e)}});const P=e=>{var o;return((o=g.value.find(l=>l.id===e))==null?void 0:o.nombre)||""},F=e=>{var o;return((o=p.value.find(l=>l.id===e))==null?void 0:o.nombre)||""},L=e=>{var o;return((o=c.value.find(l=>l.id===e))==null?void 0:o.nombre)||""},$=e=>{var o;return((o=V.value.find(l=>l.id===e))==null?void 0:o.nombre)||""};return(e,o)=>(k(),D(H,{fluid:""},{default:a(()=>[t(E,null,{default:a(()=>[t(B,null,{default:a(()=>o[7]||(o[7]=[m("Cotizador")])),_:1}),t(w,null,{default:a(()=>[t(J,null,{default:a(()=>[t(s,{cols:"12",md:"6"},{default:a(()=>[t(K,{label:"Cliente",items:z.value,modelValue:r.cliente_id,"onUpdate:modelValue":o[0]||(o[0]=l=>r.cliente_id=l),"item-title":"nombre","item-value":"id"},null,8,["items","modelValue"])]),_:1}),t(s,{cols:"12",md:"6"},{default:a(()=>[t(Q,{label:"Observaciones",modelValue:r.observaciones,"onUpdate:modelValue":o[1]||(o[1]=l=>r.observaciones=l)},null,8,["modelValue"])]),_:1}),t(s,{cols:"6",md:"3"},{default:a(()=>[t(b,{label:"Material",items:p.value,"item-title":"nombre","item-value":"id",modelValue:r.material_id,"onUpdate:modelValue":o[2]||(o[2]=l=>r.material_id=l)},null,8,["items","modelValue"])]),_:1}),t(s,{cols:"6",md:"3"},{default:a(()=>[t(b,{label:"Color",items:c.value,"item-title":"nombre","item-value":"id",modelValue:r.color_id,"onUpdate:modelValue":o[3]||(o[3]=l=>r.color_id=l)},null,8,["items","modelValue"])]),_:1}),t(s,{cols:"6",md:"3"},{default:a(()=>[t(b,{label:"Tipo de vidrio",items:C.value,"item-title":"nombre","item-value":"id",modelValue:r.tipo_vidrio_id,"onUpdate:modelValue":o[4]||(o[4]=l=>r.tipo_vidrio_id=l)},null,8,["items","modelValue"])]),_:1}),t(s,{cols:"6",md:"3"},{default:a(()=>[t(b,{label:"Producto de vidrio",items:V.value,"item-title":"nombre","item-value":"id",modelValue:r.producto_vidrio_id,"onUpdate:modelValue":o[5]||(o[5]=l=>r.producto_vidrio_id=l)},null,8,["items","modelValue"])]),_:1})]),_:1})]),_:1}),t(M,null,{default:a(()=>[t(x,{color:"primary",onClick:A},{default:a(()=>o[8]||(o[8]=[m(" Agregar Ventana ")])),_:1})]),_:1})]),_:1}),t(E,{class:"mt-4"},{default:a(()=>[t(B,null,{default:a(()=>o[9]||(o[9]=[m("Ventanas en esta cotización")])),_:1}),t(w,null,{default:a(()=>[t(W,null,{default:a(()=>[o[11]||(o[11]=i("thead",null,[i("tr",null,[i("th",null,"Ancho"),i("th",null,"Alto"),i("th",null,"Cantidad"),i("th",null,"Tipo ventana"),i("th",null,"Material"),i("th",null,"Color"),i("th",null,"Vidrio"),i("th",null,"Costo"),i("th")])],-1)),i("tbody",null,[(k(!0),U(R,null,Z(v.value,(l,f)=>{var _;return k(),U("tr",{key:f},[i("td",null,u(l.ancho),1),i("td",null,u(l.alto),1),i("td",null,u(l.cantidad),1),i("td",null,u(P(l.tipo_ventana_id)),1),i("td",null,u(F(l.material_id)),1),i("td",null,u(L(l.color_id)),1),i("td",null,u($(l.producto_vidrio_id)),1),i("td",null,"$"+u((_=l.costo)==null?void 0:_.toLocaleString()),1),i("td",null,[t(x,{icon:"",color:"red",onClick:T=>N(f)},{default:a(()=>[t(j,null,{default:a(()=>o[10]||(o[10]=[m("mdi-delete")])),_:1})]),_:2},1032,["onClick"])])])}),128))])]),_:1})]),_:1}),t(M,null,{default:a(()=>[t(X),t(x,{color:"success",onClick:O},{default:a(()=>o[12]||(o[12]=[m(" Guardar Cotización ")])),_:1})]),_:1})]),_:1}),t(q,{mostrar:y.value,"onUpdate:mostrar":o[6]||(o[6]=l=>y.value=l),onGuardar:S,tiposVentana:g.value,colores:c.value,materiales:p.value,tiposVidrio:C.value,productosVidrio:V.value},null,8,["mostrar","tiposVentana","colores","materiales","tiposVidrio","productosVidrio"])]),_:1}))}};export{Ao as default};
