import{d as ae}from"./debounce-DeDBwGcv.js";import{r as I,X as D,a as vo,f as N,o as b,e as i,m as oo,c as to,F as Vo,b as a,i as Ro,ab as Co,ac as xo,P as de,ad as Po,aL as Yo,af as To,I as ue,J as Oe,aM as Me,ag as Ko,aN as Re,az as Ue,aO as Io,Z as U,aP as Le,aq as le,aB as Be,aQ as me,ah as pe,ae as Uo,ao as fe,aC as Fe,aR as ve,N as qe,ax as Ge,av as ge,aG as Ve,Y as Z,an as be,aS as He,aT as We,E as he,ar as K,d as J,t as u,aU as $o,aV as zo,v as R,a3 as W,aW as Ye,aw as Ke,ay as Je,aX as Qe,aE as jo,aY as te,j as Xe,k as Ze,w as Fo,aZ as oa}from"./index-BvfQPV0N.js";/* empty css                                                                */import{_ as Jo}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Shapes-DW6qcN1k.js";import{_ as ea,a as aa,b as la,c as ta}from"./VistaBayWindow-CuLiholl.js";import{_ as ia,a as ra,b as na,c as sa,d as ca,e as da,f as ua,g as ma,h as pa,i as fa}from"./AgregarVentanaModal2-BIBiY5LI.js";import va from"./ModalProductos-BNVEDujr.js";import{_ as ga}from"./VistaVentanaCorredera-DbOePJmS.js";import{b as Eo,V as go,d as So,c as _e}from"./VCard-CinWIJLb.js";import{V as po}from"./VDivider-BpWSazon.js";import{V as co,a as T}from"./VRow-D3aY5PKO.js";import{V as fo}from"./VTextField-B4VmNjS8.js";import{V as qo}from"./VAutocomplete-Bl_FDpeR.js";import{a as wo,b as Oo,d as Mo,V as Va}from"./VList-Bx4XFBEr.js";import{V as ko}from"./VSelect-BqlDueew.js";import{V as ye}from"./VSpacer-BDMjHd_h.js";import{u as ba,m as ha}from"./VOverlay-9DZnkhUb.js";import{V as _a}from"./VContainer-9im5ZaQE.js";import{V as ya}from"./VDialog-DZe8np8P.js";import{V as Ca}from"./VTextarea-BGi4UPuF.js";import{V as Go}from"./VCardText-BS-UVcGE.js";import{V as ie}from"./VDataTable-LWZ6A2SJ.js";import{V as re}from"./VAlert-BhOg_jqb.js";import{V as xa}from"./VImg-BgC9H45U.js";import{V as Pa}from"./VForm-CfAhLxIV.js";import"./VSwitch-C1VPwLYF.js";import"./VInput-BHIiLFNN.js";import"./transition-G8jXjCNh.js";import"./VSelectionControl-Dp-XQzR0.js";import"./VRadioGroup-C1y_l-M1.js";import"./VTooltip-CQL7mSLn.js";import"./forwardRefs-DWGaNmQL.js";import"./VChip-B_9e-xcw.js";import"./VAvatar-CAVw4-C3.js";import"./VCheckbox-ahyzN_mU.js";import"./VCheckboxBtn-0m9q25Ip.js";/* empty css              */import"./filter-DlAMle0g.js";import"./VMenu-Np42M1LE.js";import"./VTable-D5XG77cT.js";const so=8,Aa={__name:"SeccionArmador",props:{seccion:{type:Object,required:!0},x:{type:Number,required:!0},y:{type:Number,required:!0},anchoDisponible:{type:Number,required:!0},altoDisponible:{type:Number,required:!0},escala:{type:Number,default:1},nivel:{type:Number,default:0},path:{type:String,required:!0},pathSeleccionado:{type:String,default:null},tiposVentana:{type:Array,default:()=>[]},perfilDivisorH:{type:Number,default:null},perfilDivisorV:{type:Number,default:null}},emits:["seleccionar","dividir","asignar-tipo","eliminar"],setup(t,{emit:E}){const r=t,g=E,M=I(!1),f=D(()=>r.pathSeleccionado===r.path),h=D(()=>r.seccion.anchoFijo?Math.max(20,r.seccion.anchoFijo*r.escala):Math.max(20,r.anchoDisponible*(r.seccion.porcentaje||100)/100)),S=D(()=>r.seccion.altoFijo?Math.max(20,r.seccion.altoFijo*r.escala):Math.max(20,r.altoDisponible*(r.seccion.porcentaje||100)/100)),c=D(()=>({x:r.x,y:r.y,width:Math.max(1,h.value),height:Math.max(1,S.value),fill:Q(),stroke:"#999",strokeWidth:1,cornerRadius:Math.min(2,Math.max(0,h.value/10,S.value/10)),listening:!0})),F=D(()=>({x:r.x-2,y:r.y-2,width:Math.max(5,h.value+4),height:Math.max(5,S.value+4),stroke:f.value?"#FF5722":"#2196F3",strokeWidth:3,dash:[8,4],cornerRadius:Math.min(2,Math.max(0,h.value/10,S.value/10))})),B=D(()=>{var C,y,X;(C=r.seccion.subsecciones)!=null&&C.length;const p=r.y+S.value*(((X=(y=r.seccion.subsecciones)==null?void 0:y[0])==null?void 0:X.porcentaje)||50)/100;return{points:[r.x,p-so/2,r.x+h.value,p-so/2,r.x+h.value,p+so/2,r.x,p+so/2],closed:!0,fill:"#757575",stroke:"#424242",strokeWidth:1}}),$=D(()=>{var C,y;const p=r.x+h.value*(((y=(C=r.seccion.subsecciones)==null?void 0:C[0])==null?void 0:y.porcentaje)||50)/100;return{points:[p-so/2,r.y,p+so/2,r.y,p+so/2,r.y+S.value,p-so/2,r.y+S.value],closed:!0,fill:"#757575",stroke:"#424242",strokeWidth:1}});function w(p){if(r.seccion.orientacion==="vertical"){let C=r.x;for(let y=0;y<p;y++)C+=G(y),y<p-1&&(C+=so);return C}return r.x}function _(p){if(r.seccion.orientacion==="horizontal"){let C=r.y;for(let y=0;y<p;y++)C+=L(y),y<p-1&&(C+=so);return C}return r.y}function G(p){if(r.seccion.orientacion==="vertical"){const C=r.seccion.subsecciones[p];return h.value*(C.porcentaje||50)/100}return h.value}function L(p){if(r.seccion.orientacion==="horizontal"){const C=r.seccion.subsecciones[p];return S.value*(C.porcentaje||50)/100}return S.value}function Q(){return r.seccion.tipo==="ventana"?"#E3F2FD":r.seccion.tipo==="compuesta"?"transparent":"#FAFAFA"}function P(p){const C=r.tiposVentana.find(y=>y.id===p);return C?C.nombre:`Tipo ${p}`}function eo(p){g("seleccionar",r.path),p.cancelBubble=!0}function io(p){p.target.getLayer()&&(p.target.getLayer().getStage().container().style.cursor="pointer"),M.value=!0}function H(p){p.target.getLayer()&&(p.target.getLayer().getStage().container().style.cursor="default"),M.value=!1}return(p,C)=>{const y=vo("v-rect"),X=vo("v-text"),ro=vo("v-line"),_o=vo("SeccionArmador",!0),no=vo("v-group");return b(),N(no,null,{default:i(()=>{var uo;return[t.seccion.tipo!=="compuesta"?(b(),N(y,{key:0,config:c.value,onClick:eo,onMouseenter:io,onMouseleave:H},null,8,["config"])):oo("",!0),(f.value||M.value)&&t.seccion.tipo!=="compuesta"?(b(),N(y,{key:1,config:F.value},null,8,["config"])):oo("",!0),t.seccion.tipo==="ventana"&&t.seccion.tipoVentanaId?(b(),to(Vo,{key:2},[a(X,{config:{x:t.x+h.value/2,y:t.y+S.value/2,text:P(t.seccion.tipoVentanaId),fontSize:14,fill:"#333",align:"center",width:h.value,offsetY:7}},null,8,["config"]),a(ro,{config:{points:[t.x+10,t.y+10,t.x+h.value-10,t.y+10,t.x+h.value-10,t.y+S.value-10,t.x+10,t.y+S.value-10],closed:!0,stroke:"#2196F3",strokeWidth:2,dash:[5,5]}},null,8,["config"])],64)):t.seccion.tipo==="compuesta"&&((uo=t.seccion.subsecciones)==null?void 0:uo.length)>0?(b(),to(Vo,{key:3},[t.seccion.orientacion==="horizontal"?(b(),N(ro,{key:0,config:B.value},null,8,["config"])):oo("",!0),t.seccion.orientacion==="vertical"?(b(),N(ro,{key:1,config:$.value},null,8,["config"])):oo("",!0),(b(!0),to(Vo,null,Ro(t.seccion.subsecciones,(bo,ao)=>(b(),N(_o,{key:`${t.path}.${ao}`,seccion:bo,x:w(ao),y:_(ao),"ancho-disponible":G(ao),"alto-disponible":L(ao),escala:t.escala,nivel:t.nivel+1,path:`${t.path}.${ao}`,"path-seleccionado":t.pathSeleccionado,"tipos-ventana":t.tiposVentana,"perfil-divisor-h":t.perfilDivisorH,"perfil-divisor-v":t.perfilDivisorV,onSeleccionar:C[0]||(C[0]=lo=>p.$emit("seleccionar",lo)),onDividir:C[1]||(C[1]=lo=>p.$emit("dividir",lo)),onAsignarTipo:C[2]||(C[2]=lo=>p.$emit("asignar-tipo",lo)),onEliminar:C[3]||(C[3]=lo=>p.$emit("eliminar",lo))},null,8,["seccion","x","y","ancho-disponible","alto-disponible","escala","nivel","path","path-seleccionado","tipos-ventana","perfil-divisor-h","perfil-divisor-v"]))),128))],64)):(b(),to(Vo,{key:4},[a(X,{config:{x:t.x+h.value/2,y:t.y+S.value/2-10,text:"Click para dividir",fontSize:12,fill:"#999",align:"center",width:h.value,offsetY:6}},null,8,["config"]),a(X,{config:{x:t.x+h.value/2,y:t.y+S.value/2+10,text:"o asignar ventana",fontSize:10,fill:"#999",align:"center",width:h.value,offsetY:5}},null,8,["config"])],64)),oo("",!0)]}),_:1})}}},Ea=Jo(Aa,[["__scopeId","data-v-08033118"]]),No=Symbol.for("vuetify:v-expansion-panel"),Ce=xo({...To(),...ha()},"VExpansionPanelText"),ne=Co()({name:"VExpansionPanelText",props:Ce(),setup(t,E){let{slots:r}=E;const g=de(No);if(!g)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:M,onAfterLeave:f}=ba(t,g.isSelected);return Po(()=>a(Yo,{onAfterLeave:f},{default:()=>{var h;return[ue(a("div",{class:["v-expansion-panel-text",t.class],style:t.style},[r.default&&M.value&&a("div",{class:"v-expansion-panel-text__wrapper"},[(h=r.default)==null?void 0:h.call(r)])]),[[Oe,g.isSelected.value]])]}})),{}}}),xe=xo({color:String,expandIcon:{type:le,default:"$expand"},collapseIcon:{type:le,default:"$collapse"},hideActions:Boolean,focusable:Boolean,static:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean,...To(),...Le()},"VExpansionPanelTitle"),se=Co()({name:"VExpansionPanelTitle",directives:{Ripple:Me},props:xe(),setup(t,E){let{slots:r}=E;const g=de(No);if(!g)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:M,backgroundColorStyles:f}=Ko(t,"color"),{dimensionStyles:h}=Re(t),S=D(()=>({collapseIcon:t.collapseIcon,disabled:g.disabled.value,expanded:g.isSelected.value,expandIcon:t.expandIcon,readonly:t.readonly})),c=D(()=>g.isSelected.value?t.collapseIcon:t.expandIcon);return Po(()=>{var F;return ue(a("button",{class:["v-expansion-panel-title",{"v-expansion-panel-title--active":g.isSelected.value,"v-expansion-panel-title--focusable":t.focusable,"v-expansion-panel-title--static":t.static},M.value,t.class],style:[f.value,h.value,t.style],type:"button",tabindex:g.disabled.value?-1:void 0,disabled:g.disabled.value,"aria-expanded":g.isSelected.value,onClick:t.readonly?void 0:g.toggle},[a("span",{class:"v-expansion-panel-title__overlay"},null),(F=r.default)==null?void 0:F.call(r,S.value),!t.hideActions&&a(Io,{defaults:{VIcon:{icon:c.value}}},{default:()=>{var B;return[a("span",{class:"v-expansion-panel-title__icon"},[((B=r.actions)==null?void 0:B.call(r,S.value))??a(U,null,null)])]}})]),[[Ue("ripple"),t.ripple]])}),{}}}),Pe=xo({title:String,text:String,bgColor:String,...ve(),...Fe(),...fe(),...Uo(),...xe(),...Ce()},"VExpansionPanel"),Tl=Co()({name:"VExpansionPanel",props:Pe(),emits:{"group:selected":t=>!0},setup(t,E){let{slots:r}=E;const g=Be(t,No),{backgroundColorClasses:M,backgroundColorStyles:f}=Ko(t,"bgColor"),{elevationClasses:h}=me(t),{roundedClasses:S}=pe(t),c=D(()=>(g==null?void 0:g.disabled.value)||t.disabled),F=D(()=>g.group.items.value.reduce((w,_,G)=>(g.group.selected.value.includes(_.id)&&w.push(G),w),[])),B=D(()=>{const w=g.group.items.value.findIndex(_=>_.id===g.id);return!g.isSelected.value&&F.value.some(_=>_-w===1)}),$=D(()=>{const w=g.group.items.value.findIndex(_=>_.id===g.id);return!g.isSelected.value&&F.value.some(_=>_-w===-1)});return qe(No,g),Po(()=>{const w=!!(r.text||t.text),_=!!(r.title||t.title),G=se.filterProps(t),L=ne.filterProps(t);return a(t.tag,{class:["v-expansion-panel",{"v-expansion-panel--active":g.isSelected.value,"v-expansion-panel--before-active":B.value,"v-expansion-panel--after-active":$.value,"v-expansion-panel--disabled":c.value},S.value,M.value,t.class],style:[f.value,t.style]},{default:()=>[a("div",{class:["v-expansion-panel__shadow",...h.value]},null),a(Io,{defaults:{VExpansionPanelTitle:{...G},VExpansionPanelText:{...L}}},{default:()=>{var Q;return[_&&a(se,{key:"title"},{default:()=>[r.title?r.title():t.title]}),w&&a(ne,{key:"text"},{default:()=>[r.text?r.text():t.text]}),(Q=r.default)==null?void 0:Q.call(r)]}})]})}),{groupItem:g}}}),Sa=["default","accordion","inset","popout"],ka=xo({flat:Boolean,...We(),...He(Pe(),["bgColor","collapseIcon","color","eager","elevation","expandIcon","focusable","hideActions","readonly","ripple","rounded","tile","static"]),...be(),...To(),...Uo(),variant:{type:String,default:"default",validator:t=>Sa.includes(t)}},"VExpansionPanels"),Dl=Co()({name:"VExpansionPanels",props:ka(),emits:{"update:modelValue":t=>!0},setup(t,E){let{slots:r}=E;const{next:g,prev:M}=Ge(t,No),{themeClasses:f}=ge(t),h=D(()=>t.variant&&`v-expansion-panels--variant-${t.variant}`);return Ve({VExpansionPanel:{bgColor:Z(t,"bgColor"),collapseIcon:Z(t,"collapseIcon"),color:Z(t,"color"),eager:Z(t,"eager"),elevation:Z(t,"elevation"),expandIcon:Z(t,"expandIcon"),focusable:Z(t,"focusable"),hideActions:Z(t,"hideActions"),readonly:Z(t,"readonly"),ripple:Z(t,"ripple"),rounded:Z(t,"rounded"),static:Z(t,"static")}}),Po(()=>a(t.tag,{class:["v-expansion-panels",{"v-expansion-panels--flat":t.flat,"v-expansion-panels--tile":t.tile},f.value,h.value,t.class],style:t.style},{default:()=>{var S;return[(S=r.default)==null?void 0:S.call(r,{prev:M,next:g})]}})),{next:g,prev:M}}}),Ia={class:"canvas-container"};const Ho=800,Wo=500,ce=50,Na={__name:"ArmadorUniversal",props:{ancho:{type:Number,default:2e3},alto:{type:Number,default:2e3},colorMarco:{type:String,default:"blanco"},configuracionInicial:{type:Object,default:null},tiposVentana:{type:Array,default:()=>[]}},emits:["guardar","cancelar"],setup(t,{expose:E,emit:r}){const g=t,M=r,f=I({ancho:g.ancho,alto:g.alto,perfilMarcoId:null,perfilDivisorHorizontalId:null,perfilDivisorVerticalId:null,secciones:[{tipo:"vacio",tipoVentanaId:null,orientacion:null,subsecciones:[],porcentaje:100}]}),h=I([]),S=I([]),c=I(null),F=I(0),B={width:Ho,height:Wo},$=D(()=>{const x=Ho-ce*2,s=Wo-ce*2,k=x/f.value.ancho,q=s/f.value.alto;return Math.min(k,q,1)*.9}),w=D(()=>30),_=D(()=>f.value.ancho*$.value),G=D(()=>f.value.alto*$.value),L=D(()=>_.value-w.value*2),Q=D(()=>G.value-w.value*2),P=D(()=>({x:(Ho-_.value)/2,y:(Wo-G.value)/2})),eo=D(()=>({x:0,y:0,width:_.value,height:G.value,fill:"#D0D0D0",stroke:"#333",strokeWidth:2}));he(async()=>{try{const s=(await K.get("/api/productos")).data;h.value=s.filter(k=>[3,4,5].includes(k.tipo_producto_id)),S.value=s.filter(k=>[3,4,5].includes(k.tipo_producto_id)),console.log("âœ… Perfiles cargados:",{marcos:h.value.length,divisores:S.value.length})}catch(x){console.error("âŒ Error cargando perfiles:",x)}g.configuracionInicial&&(f.value={...f.value,...g.configuracionInicial})});function io(x){x.target===x.target.getStage()&&(c.value=null)}function H(x){console.log("ğŸ¯ SecciÃ³n seleccionada:",x),c.value=x}function p({path:x,orientacion:s}){console.log("âœ‚ï¸ Dividir secciÃ³n:",x,"orientaciÃ³n:",s),ro(x,s)}function C({path:x,tipoVentanaId:s}){console.log("ğŸªŸ Asignar tipo ventana:",s,"a secciÃ³n:",x),_o(x,s)}function y(x){console.log("ğŸ—‘ï¸ Eliminar secciÃ³n:",x),no(x)}function X(x){var q;const s=x.split(".").map(Number);let k=f.value.secciones;for(let mo=0;mo<s.length;mo++){const yo=s[mo];if(mo===s.length-1)return k[yo];k=((q=k[yo])==null?void 0:q.subsecciones)||[]}return null}function ro(x,s){const k=X(x);if(!k)return;const q=100;if((s==="horizontal"?f.value.alto:f.value.ancho)<q*2){alert(`La secciÃ³n es muy pequeÃ±a para dividir. MÃ­nimo ${q*2}mm en direcciÃ³n ${s}.`);return}k.tipo="compuesta",k.orientacion=s,k.subsecciones=[{tipo:"vacio",tipoVentanaId:null,orientacion:null,subsecciones:[],porcentaje:50},{tipo:"vacio",tipoVentanaId:null,orientacion:null,subsecciones:[],porcentaje:50}],F.value++}function _o(x,s){const k=X(x);k&&(k.tipo="ventana",k.tipoVentanaId=s,k.subsecciones=[],F.value++)}function no(x){const s=x.split(".").map(Number);if(s.length===1){alert('No se puede eliminar la secciÃ³n raÃ­z. Usa "Reiniciar" para comenzar de nuevo.');return}let k=f.value.secciones;for(let q=0;q<s.length-1;q++)k=k[s[q]].subsecciones;if(k.splice(s[s.length-1],1),k.length===1){const q=X(s.slice(0,-1).join("."));q&&Object.assign(q,k[0])}c.value=null,F.value++}function uo(x){c.value&&ro(c.value,x)}function bo(x){c.value&&_o(c.value,x)}function ao(){c.value&&no(c.value)}function lo(){confirm("Â¿EstÃ¡s seguro de reiniciar el armador? Se perderÃ¡n todos los cambios.")&&(f.value.secciones=[{tipo:"vacio",tipoVentanaId:null,orientacion:null,subsecciones:[],porcentaje:100}],c.value=null,F.value++)}function Lo(){console.log("ğŸ“¤ Exportando configuraciÃ³n:",f.value),M("guardar",f.value)}return E({getConfiguracion:()=>f.value,setConfiguracion:x=>{f.value={...f.value,...x},F.value++}}),(x,s)=>{const k=vo("v-rect"),q=vo("v-group"),mo=vo("v-layer"),yo=vo("v-stage");return b(),N(go,{class:"pa-4"},{default:i(()=>[a(Eo,{class:"d-flex align-center"},{default:i(()=>[a(U,{left:""},{default:i(()=>s[8]||(s[8]=[u("mdi-window-maximize")])),_:1}),s[9]||(s[9]=u(" Armador Universal de Ventanas "))]),_:1}),a(po,{class:"my-3"}),a(co,{dense:"",class:"mb-4"},{default:i(()=>[a(T,{cols:"12",md:"3"},{default:i(()=>[a(fo,{modelValue:f.value.ancho,"onUpdate:modelValue":s[0]||(s[0]=z=>f.value.ancho=z),modelModifiers:{number:!0},label:"Ancho Total (mm)",type:"number",density:"compact",variant:"outlined",min:"100"},null,8,["modelValue"])]),_:1}),a(T,{cols:"12",md:"3"},{default:i(()=>[a(fo,{modelValue:f.value.alto,"onUpdate:modelValue":s[1]||(s[1]=z=>f.value.alto=z),modelModifiers:{number:!0},label:"Alto Total (mm)",type:"number",density:"compact",variant:"outlined",min:"100"},null,8,["modelValue"])]),_:1}),a(T,{cols:"12",md:"6"},{default:i(()=>[a(qo,{modelValue:f.value.perfilMarcoId,"onUpdate:modelValue":s[2]||(s[2]=z=>f.value.perfilMarcoId=z),items:h.value,"item-title":"nombre","item-value":"id",label:"Perfil del Marco",density:"compact",variant:"outlined",clearable:""},{item:i(({props:z,item:Y})=>[a(wo,$o(zo(z)),{prepend:i(()=>[a(U,null,{default:i(()=>s[10]||(s[10]=[u("mdi-border-all")])),_:1})]),default:i(()=>[a(Oo,null,{default:i(()=>[u(R(Y.raw.nombre),1)]),_:2},1024),a(Mo,null,{default:i(()=>[u("CÃ³digo: "+R(Y.raw.codigo),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items"])]),_:1})]),_:1}),a(co,{dense:"",class:"mb-4"},{default:i(()=>[a(T,{cols:"12",md:"6"},{default:i(()=>[a(qo,{modelValue:f.value.perfilDivisorHorizontalId,"onUpdate:modelValue":s[3]||(s[3]=z=>f.value.perfilDivisorHorizontalId=z),items:S.value,"item-title":"nombre","item-value":"id",label:"Perfil Divisor Horizontal",density:"compact",variant:"outlined",clearable:""},{item:i(({props:z,item:Y})=>[a(wo,$o(zo(z)),{prepend:i(()=>[a(U,null,{default:i(()=>s[11]||(s[11]=[u("mdi-minus")])),_:1})]),default:i(()=>[a(Oo,null,{default:i(()=>[u(R(Y.raw.nombre),1)]),_:2},1024),a(Mo,null,{default:i(()=>[u("CÃ³digo: "+R(Y.raw.codigo),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items"])]),_:1}),a(T,{cols:"12",md:"6"},{default:i(()=>[a(qo,{modelValue:f.value.perfilDivisorVerticalId,"onUpdate:modelValue":s[4]||(s[4]=z=>f.value.perfilDivisorVerticalId=z),items:S.value,"item-title":"nombre","item-value":"id",label:"Perfil Divisor Vertical",density:"compact",variant:"outlined",clearable:""},{item:i(({props:z,item:Y})=>[a(wo,$o(zo(z)),{prepend:i(()=>[a(U,null,{default:i(()=>s[12]||(s[12]=[u("mdi-slash-forward")])),_:1})]),default:i(()=>[a(Oo,null,{default:i(()=>[u(R(Y.raw.nombre),1)]),_:2},1024),a(Mo,null,{default:i(()=>[u("CÃ³digo: "+R(Y.raw.codigo),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items"])]),_:1})]),_:1}),a(po,{class:"my-3"}),J("div",Ia,[a(yo,{config:B,onMousedown:io},{default:i(()=>[a(mo,null,{default:i(()=>[a(k,{config:{x:0,y:0,width:B.width,height:B.height,fill:"#f5f5f5",stroke:"#ddd",strokeWidth:1}},null,8,["config"]),a(q,{config:P.value},{default:i(()=>[a(k,$o(zo(eo.value)),null,16),(b(!0),to(Vo,null,Ro(f.value.secciones,(z,Y)=>(b(),N(Ea,{key:`seccion-${Y}-${F.value}`,seccion:z,x:w.value,y:w.value,"ancho-disponible":L.value,"alto-disponible":Q.value,escala:$.value,nivel:0,path:`${Y}`,"path-seleccionado":c.value,"tipos-ventana":t.tiposVentana,"perfil-divisor-h":f.value.perfilDivisorHorizontalId,"perfil-divisor-v":f.value.perfilDivisorVerticalId,onSeleccionar:H,onDividir:p,onAsignarTipo:C,onEliminar:y},null,8,["seccion","x","y","ancho-disponible","alto-disponible","escala","path","path-seleccionado","tipos-ventana","perfil-divisor-h","perfil-divisor-v"]))),128))]),_:1},8,["config"])]),_:1})]),_:1})]),c.value?(b(),N(go,{key:0,variant:"tonal",class:"mt-4 pa-3"},{default:i(()=>[a(So,{class:"d-flex align-center justify-space-between"},{default:i(()=>[J("span",null,[a(U,{left:""},{default:i(()=>s[13]||(s[13]=[u("mdi-cursor-default-click")])),_:1}),u(" SecciÃ³n seleccionada: "+R(c.value),1)]),a(W,{size:"small",icon:"",onClick:s[5]||(s[5]=z=>c.value=null)},{default:i(()=>[a(U,null,{default:i(()=>s[14]||(s[14]=[u("mdi-close")])),_:1})]),_:1})]),_:1}),a(co,{dense:"",class:"mt-2"},{default:i(()=>[a(T,{cols:"6",md:"3"},{default:i(()=>[a(W,{block:"",color:"primary",variant:"tonal",onClick:s[6]||(s[6]=z=>uo("horizontal"))},{default:i(()=>[a(U,{left:""},{default:i(()=>s[15]||(s[15]=[u("mdi-arrow-split-horizontal")])),_:1}),s[16]||(s[16]=u(" Dividir Horizontal "))]),_:1})]),_:1}),a(T,{cols:"6",md:"3"},{default:i(()=>[a(W,{block:"",color:"primary",variant:"tonal",onClick:s[7]||(s[7]=z=>uo("vertical"))},{default:i(()=>[a(U,{left:""},{default:i(()=>s[17]||(s[17]=[u("mdi-arrow-split-vertical")])),_:1}),s[18]||(s[18]=u(" Dividir Vertical "))]),_:1})]),_:1}),a(T,{cols:"12",md:"4"},{default:i(()=>{var z;return[a(ko,{"model-value":(z=X(c.value))==null?void 0:z.tipoVentanaId,items:t.tiposVentana,"item-title":"nombre","item-value":"id",label:"Asignar Tipo de Ventana",density:"compact",variant:"outlined","onUpdate:modelValue":bo},null,8,["model-value","items"])]}),_:1}),a(T,{cols:"12",md:"2"},{default:i(()=>[a(W,{block:"",color:"error",variant:"tonal",onClick:ao},{default:i(()=>[a(U,{left:""},{default:i(()=>s[19]||(s[19]=[u("mdi-delete")])),_:1}),s[20]||(s[20]=u(" Eliminar "))]),_:1})]),_:1})]),_:1})]),_:1})):oo("",!0),a(_e,{class:"mt-4"},{default:i(()=>[a(W,{color:"secondary",variant:"outlined",onClick:lo},{default:i(()=>[a(U,{left:""},{default:i(()=>s[21]||(s[21]=[u("mdi-refresh")])),_:1}),s[22]||(s[22]=u(" Reiniciar "))]),_:1}),a(ye),a(W,{color:"primary",onClick:Lo},{default:i(()=>[a(U,{left:""},{default:i(()=>s[23]||(s[23]=[u("mdi-check")])),_:1}),s[24]||(s[24]=u(" Aplicar ConfiguraciÃ³n "))]),_:1})]),_:1}),oo("",!0)]),_:1})}}},Ta=Jo(Na,[["__scopeId","data-v-933c13a9"]]),Da=xo({text:String,...To(),...Uo()},"VToolbarTitle"),Ae=Co()({name:"VToolbarTitle",props:Da(),setup(t,E){let{slots:r}=E;return Po(()=>{const g=!!(r.default||r.text||t.text);return a(t.tag,{class:["v-toolbar-title",t.class],style:t.style},{default:()=>{var M;return[g&&a("div",{class:"v-toolbar-title__placeholder"},[r.text?r.text():t.text,(M=r.default)==null?void 0:M.call(r)])]}})}),{}}}),$a=[null,"prominent","default","comfortable","compact"],za=xo({absolute:Boolean,collapse:Boolean,color:String,density:{type:String,default:"default",validator:t=>$a.includes(t)},extended:Boolean,extensionHeight:{type:[Number,String],default:48},flat:Boolean,floating:Boolean,height:{type:[Number,String],default:64},image:String,title:String,...Qe(),...To(),...ve(),...fe(),...Uo({tag:"header"}),...be()},"VToolbar"),ja=Co()({name:"VToolbar",props:za(),setup(t,E){var _;let{slots:r}=E;const{backgroundColorClasses:g,backgroundColorStyles:M}=Ko(Z(t,"color")),{borderClasses:f}=Ye(t),{elevationClasses:h}=me(t),{roundedClasses:S}=pe(t),{themeClasses:c}=ge(t),{rtlClasses:F}=Ke(),B=Je(!!(t.extended||(_=r.extension)!=null&&_.call(r))),$=D(()=>parseInt(Number(t.height)+(t.density==="prominent"?Number(t.height):0)-(t.density==="comfortable"?8:0)-(t.density==="compact"?16:0),10)),w=D(()=>B.value?parseInt(Number(t.extensionHeight)+(t.density==="prominent"?Number(t.extensionHeight):0)-(t.density==="comfortable"?4:0)-(t.density==="compact"?8:0),10):0);return Ve({VBtn:{variant:"text"}}),Po(()=>{var P;const G=!!(t.title||r.title),L=!!(r.image||t.image),Q=(P=r.extension)==null?void 0:P.call(r);return B.value=!!(t.extended||Q),a(t.tag,{class:["v-toolbar",{"v-toolbar--absolute":t.absolute,"v-toolbar--collapse":t.collapse,"v-toolbar--flat":t.flat,"v-toolbar--floating":t.floating,[`v-toolbar--density-${t.density}`]:!0},g.value,f.value,h.value,S.value,c.value,F.value,t.class],style:[M.value,t.style]},{default:()=>[L&&a("div",{key:"image",class:"v-toolbar__image"},[r.image?a(Io,{key:"image-defaults",disabled:!t.image,defaults:{VImg:{cover:!0,src:t.image}}},r.image):a(xa,{key:"image-img",cover:!0,src:t.image},null)]),a(Io,{defaults:{VTabs:{height:jo($.value)}}},{default:()=>{var eo,io,H;return[a("div",{class:"v-toolbar__content",style:{height:jo($.value)}},[r.prepend&&a("div",{class:"v-toolbar__prepend"},[(eo=r.prepend)==null?void 0:eo.call(r)]),G&&a(Ae,{key:"title",text:t.title},{text:r.title}),(io=r.default)==null?void 0:io.call(r),r.append&&a("div",{class:"v-toolbar__append"},[(H=r.append)==null?void 0:H.call(r)])])]}}),a(Io,{defaults:{VTabs:{height:jo(w.value)}}},{default:()=>[a(Yo,null,{default:()=>[B.value&&a("div",{class:"v-toolbar__extension",style:{height:jo(w.value)}},[Q])]})]})]})}),{contentHeight:$,extensionHeight:w}}}),wa={style:{position:"relative"}},Oa={class:"font-weight-medium"},Ma={key:0,class:"text-caption text-grey"},Ra={class:"d-flex justify-end"},Ua={key:3,class:"mt-6"},La=.45,Ba={__name:"index",setup(t){const E=I([]),r=I([]),g=Ze(),M=Xe(),f=I(!1),h=I(null),S=D(()=>{const n={};for(const e of r.value)n[Number(e.id)]=e.nombre;return n}),c=te({cliente_id:null,observaciones:"",material:"",color:"",tipoVidrio:"",productoVidrioProveedor:"",ventanas:[],productos:[]}),F=[{id:1,nombre:"Fija"},{id:2,nombre:"Proyectante"},{id:3,nombre:"Corredera"}];I({});const B=I(!1),$=te({cliente:null}),w=I([]),_=I([]),G=I([]),L=I([]),Q=I([]),P=I([]),eo=I(!1),io=I(null),H=I(""),p=I(!1);I("");const C=I(!1);I(0);const y=I({razon_social:"",identification:"",email:"",phone:"",address:"",ciudad:"",comuna:"",giro:""});D(()=>L.value.flatMap(n=>!n.colores_por_proveedor||!Array.isArray(n.colores_por_proveedor)?[]:n.colores_por_proveedor.map(e=>{var o;return{id:`${n.id}-${e.proveedor_id}`,producto_id:n.id,proveedor_id:e.proveedor_id,nombre:`${n.nombre} (${((o=e.proveedor)==null?void 0:o.nombre)||"Proveedor desconocido"})`}})));const X=D(()=>{const n=c.tipoVidrio;return L.value.filter(e=>e.tipo_producto_id===n).flatMap(e=>!e.colores_por_proveedor||!Array.isArray(e.colores_por_proveedor)?[]:e.colores_por_proveedor.map(o=>{var l;return{id:o.id,producto_id:e.id,proveedor_id:o.proveedor_id,nombre:`${e.nombre} (${((l=o.proveedor)==null?void 0:l.nombre)||"Proveedor desconocido"})`}}))});he(async()=>{var n;console.log("ğŸ”„ Iniciando carga de datos..."),M.query.id&&(f.value=!0,h.value=M.query.id,console.log("ğŸ“ MODO EDICIÃ“N activado - ID:",h.value));try{const[e,o,l,V,v]=await Promise.all([K.get("/api/tipos_material"),K.get("/api/colores"),K.get("/api/tipos_producto"),K.get("/api/productos"),K.get("/api/tipos_ventana")]);console.log("âœ… Datos bÃ¡sicos cargados"),w.value=e.data,_.value=o.data,G.value=l.data.filter(A=>[1,2].includes(A.id)),L.value=V.data.filter(A=>[1,2].includes(A.tipo_producto_id)),console.log("ğŸ“¦ PRODUCTOS DE VIDRIO CARGADOS:",L.value.length),console.log("ğŸ“¦ Primer producto:",L.value[0]),L.value[0]&&(console.log("   - Tiene colores_por_proveedor?",!!L.value[0].colores_por_proveedor),console.log("   - Es array?",Array.isArray(L.value[0].colores_por_proveedor)),console.log("   - Cantidad:",(n=L.value[0].colores_por_proveedor)==null?void 0:n.length)),r.value=v.data,console.log("TIPOS VENTANA CARGADOS:",r.value),console.log("ğŸ”„ Cargando primeros clientes..."),ze(),f.value&&await _o(),document.addEventListener("click",A=>{const j=A.target;!j.closest(".v-text-field")&&!j.closest(".v-card")&&(p.value=!1)})}catch(e){console.error("âŒ Error cargando datos:",e),alert("Error cargando datos: "+e.message)}});const ro=n=>(n=parseInt(n),L.value.flatMap(e=>!e.colores_por_proveedor||!Array.isArray(e.colores_por_proveedor)?[]:e.colores_por_proveedor.map(o=>({id:o.id,producto_id:e.id,proveedor_id:o.proveedor_id}))).find(e=>e.id===n)),_o=async()=>{try{console.log("ğŸ“¥ Cargando cotizaciÃ³n ID:",h.value);const e=(await K.get(`/api/cotizaciones/${h.value}`)).data;console.log("âœ… CotizaciÃ³n cargada:",e),console.log("ğŸ“¦ DETALLES COMPLETOS:",e.detalles),e.cliente&&($.cliente=e.cliente,c.cliente_id=e.cliente.id,H.value=e.cliente.razon_social),c.observaciones=e.observaciones||"",e.ventanas&&e.ventanas.length>0&&(c.ventanas=e.ventanas.map(o=>{const l=ro(o.producto_vidrio_proveedor_id);return{tipo:o.tipo_ventana_id,ancho:o.ancho,alto:o.alto,cantidad:o.cantidad||1,color:o.color_id,tipoVidrio:o.tipo_vidrio_id,productoVidrioProveedor:o.producto_vidrio_proveedor_id,productoVidrio:l==null?void 0:l.producto_id,proveedorVidrio:l==null?void 0:l.proveedor_id,costo:o.costo||0,costo_unitario:o.costo_unitario||0,costo_total:o.costo||0,precio:o.precio||0,precio_unitario:o.precio_unitario||0,hojas_totales:o.hojas_totales,hojas_moviles:o.hojas_moviles,materiales:o.materiales||[],tipoVentanaIzquierda:o.tipo_ventana_izquierda,tipoVentanaCentro:o.tipo_ventana_centro,tipoVentanaDerecha:o.tipo_ventana_derecha,ancho_izquierda:o.ancho_izquierda,ancho_centro:o.ancho_centro,ancho_derecha:o.ancho_derecha,id:o.id}}),console.log("âœ… Ventanas cargadas:",c.ventanas.length)),e.detalles&&e.detalles.length>0&&(c.productos=e.detalles.filter(o=>o.tipo_item==="producto").map(o=>{console.log("ğŸ“¦ Detalle del producto:",o);const l=o.producto_lista||o.productoLista||{},V=o.lista_precio||o.listaPrecio||{},v=l.tipo_producto||l.tipoProducto||{},A=l.unidad||{};return{id:o.id,producto_lista_id:o.producto_lista_id,lista_precio_id:o.lista_precio_id,descripcion:o.descripcion,cantidad:o.cantidad,precio_venta:o.precio_unitario,total:o.total,codigo:l.codigo||"",nombre:l.nombre||o.descripcion,tipo:v.nombre||"",unidad:A.nombre||A.simbolo||"",precio_costo:V.precio_costo||0,margen:V.margen||0}}),console.log("âœ… Productos cargados:",c.productos.length),console.log("ğŸ“¦ Primer producto mapeado:",c.productos[0]))}catch(n){console.error("âŒ Error cargando cotizaciÃ³n:",n),alert("Error al cargar la cotizaciÃ³n"),g.push({name:"cotizaciones"})}},no=I(!1),uo=I(!1),bo=I(!1),ao=I(null),lo=[{title:"Tipo",key:"tipo"},{title:"Ancho",key:"ancho"},{title:"Alto",key:"alto"},{title:"Cantidad",key:"cantidad"},{title:"Precio",key:"precio",align:"end"},{title:"Acciones",key:"acciones",sortable:!1}],Lo=[{title:"CÃ³digo",key:"codigo"},{title:"Nombre",key:"nombre"},{title:"Color",key:"color"},{title:"Proveedor",key:"proveedor"},{title:"Tipo",key:"tipo_producto"},{title:"Unidad",key:"unidad"},{title:"Cantidad",key:"cantidad"},{title:"Precio Costo",key:"precio_costo",align:"end"},{title:"Precio Venta",key:"precio_venta",align:"end"},{title:"Acciones",key:"acciones",sortable:!1}],x=()=>{ao.value=null,no.value=!0},s=()=>{uo.value=!uo.value},k=()=>{bo.value=!0},q=n=>{ao.value={...c.ventanas[n],index:n},no.value=!0},mo=n=>{console.log("VENTANA RECIBIDA:",n),n.index!==void 0?c.ventanas[n.index]={...n}:c.ventanas.push({...n}),no.value=!1},yo=n=>{console.log("ğŸ“¦ PRODUCTOS RECIBIDOS DEL MODAL:",n),n.forEach(e=>{var l,V,v,A,j,m,O;const o={producto_lista_id:e.producto_lista_id,lista_precio_id:e.lista_precio_id,nombre:e.nombre||((l=e.producto)==null?void 0:l.nombre),codigo:e.codigo||((V=e.producto)==null?void 0:V.codigo_proveedor),color:e.color||"-",proveedor:e.proveedor||"-",tipo_producto:e.tipo||((A=(v=e.producto)==null?void 0:v.tipoProducto)==null?void 0:A.nombre)||"-",unidad:e.unidad||((m=(j=e.producto)==null?void 0:j.unidad)==null?void 0:m.abreviacion)||"-",cantidad:e.cantidad,precio_costo:e.precio_costo,margen:e.margen,precio_venta:e.precio_venta,descripcion:e.descripcion||e.nombre||((O=e.producto)==null?void 0:O.nombre)||"",total:e.precio_venta*e.cantidad,esVidrio:e.esVidrio||!1,ancho_mm:e.ancho_mm||null,alto_mm:e.alto_mm||null,m2:e.m2||null,pulido:e.pulido||!1};console.log("âœ… PRODUCTO AGREGADO A COTIZACIÃ“N:",o),c.productos.push(o)})},z=n=>{c.productos.splice(n,1)},Y=n=>new Intl.NumberFormat("es-CL").format(n||0),Ee=n=>{c.ventanas.splice(n,1)},Se=ae(async(n,e)=>{if(!n.productoVidrio||!n.proveedorVidrio){console.warn("âš ï¸ Faltan datos en el payload para calcular materiales:",n);return}try{const o=await K.post("/api/cotizador/calcular-materiales",n);e.costo_unitario=o.data.costo_unitario;const l=Number(e.cantidad)>0?Number(e.cantidad):1;e.costo_total=o.data.costo_unitario*l;const V=Math.ceil(o.data.costo_unitario/(1-La));e.precio_unitario=V,e.precio=V*l,e.materiales=o.data.materiales}catch(o){console.error("âŒ Error al calcular materiales",o),e.costo_total=0,e.materiales=[]}},1e3);Fo(()=>c.ventanas,n=>{n.forEach(e=>{Fo(()=>[e.tipo,e.ancho,e.alto,e.cantidad,e.material,e.color,e.tipoVidrio,e.productoVidrioProveedor,e.hojas_totales,e.hojas_moviles],()=>{const o=[];e.tipo||o.push("tipo_ventana_id faltante"),e.ancho||o.push("ancho faltante"),e.alto||o.push("alto faltante"),(!e.cantidad||e.cantidad<=0)&&o.push("cantidad invÃ¡lida"),e.productoVidrioProveedor||o.push("productoVidrioProveedor faltante");const l=ro(e.productoVidrioProveedor);if(l||o.push(`relaciÃ³n producto-proveedor no encontrada (ID: ${e.productoVidrioProveedor})`),o.length>0){console.warn(`âŒ No se puede recalcular la ventana (tipo ${e.tipo}):`,o.join(", "));return}const V={...e,productoVidrio:l.producto_id,proveedorVidrio:l.proveedor_id,hojas_moviles:e.tipo===3||e.tipo===46?e.hojas_moviles:void 0};console.log("âœ… Recalculando ventana:",V),Se(V,e)},{deep:!0,immediate:!1})})},{deep:!0}),Fo(()=>$.cliente,n=>{console.log("âœ… Cliente seleccionado:",n),n&&(console.log("âœ… Nombre:",n.razon_social),console.log("âœ… RUT:",n.identification))});const ke=()=>{C.value=!0},Ie=async()=>{var e,o;const n=(e=H.value)==null?void 0:e.trim();if(console.log("ğŸ” BÃšSQUEDA LOCAL:",n),$.cliente&&n!==$.cliente.razon_social&&($.cliente=null,c.cliente_id=null),!n||n.length<2){P.value=[],p.value=!1;return}eo.value=!0,p.value=!0;try{const l=await K.get(`/api/clientes/buscar?q=${encodeURIComponent(n)}`);console.log("âœ… RESPUESTA LOCAL:",l.data),((o=l.data)==null?void 0:o.length)>0?(P.value=l.data.map(V=>({id:V.id,razon_social:V.razon_social||`${V.first_name||""} ${V.last_name||""}`.trim()||"Sin nombre",identification:V.identification||"",email:V.email||"",phone:V.phone||""})),console.log("âœ… CLIENTES PROCESADOS:",P.value),p.value=!0):(P.value=[],p.value=!1,console.log("âŒ NO HAY CLIENTES"))}catch(l){console.error("âŒ ERROR:",l),P.value=[],p.value=!1}finally{eo.value=!1}},Ne=n=>{console.log("âœ… CLIENTE SELECCIONADO:",n),$.cliente=n,c.cliente_id=n.id,H.value=n.razon_social,p.value=!1,P.value=[]},Te=()=>{P.value.length>0&&(p.value=!0)},De=()=>{H.value="",P.value=[],p.value=!1,$.cliente=null},$e=async()=>{var n,e;try{console.log("ğŸ’¾ Guardando cliente local:",y.value);const o=await K.post("/api/clientes",y.value);console.log("âœ… Respuesta completa:",o.data);const l=o.data.cliente||o.data;console.log("âœ… Cliente creado:",l),P.value.push(l),$.cliente=l,c.cliente_id=l.id,H.value=l.razon_social,p.value=!1,P.value=[],C.value=!1,y.value={razon_social:"",identification:"",email:"",phone:"",address:"",ciudad:""},console.log("âœ… Cliente seleccionado:",$.cliente),console.log("âœ… Cliente ID asignado:",c.cliente_id),console.log("âœ… TÃ©rmino bÃºsqueda:",H.value),alert("âœ… Cliente creado y seleccionado exitosamente")}catch(o){console.error("âŒ Error al crear cliente:",o),alert("âŒ Error al crear cliente: "+(((e=(n=o.response)==null?void 0:n.data)==null?void 0:e.message)||o.message))}};ae(async n=>{var e;if(n||(n=H.value),console.log("ğŸ” Buscando clientes con query:",n),!n||n.length<2){P.value=Q.value.slice(0,20),console.log("ğŸ“‹ Mostrando clientes iniciales:",P.value.length);return}eo.value=!0;try{console.log("ğŸŒ Buscando en API de Bsale...");const o=await K.get(`/api/bsale-clientes/buscar?q=${encodeURIComponent(n)}`);console.log("âœ… Respuesta de API:",o.data),o.data&&o.data.items&&o.data.items.length>0?(P.value=o.data.items.map(l=>{console.log("ğŸ” Procesando cliente:",l);let V="";l.company&&l.company.trim()?V=l.company.trim():l.firstName||l.lastName?V=`${l.firstName||""} ${l.lastName||""}`.trim():l.razon_social?V=l.razon_social:l.displayName?V=l.displayName:V="Cliente sin nombre",(!V||V.trim()==="")&&(V=`Cliente ID: ${l.id}`);const v={id:l.id,razon_social:V,identification:l.identification||"",email:l.email||"",phone:l.phone||"",address:l.address||"",city:l.city||"",municipality:l.municipality||"",first_name:l.firstName||"",last_name:l.lastName||"",company:l.company||"",tipo_cliente:l.companyOrPerson==1?"empresa":"persona"};return console.log("âœ… Cliente procesado:",v),v}),console.log("âœ… Total clientes procesados:",P.value.length),console.log("âœ… Lista final:",P.value),P.value.length>0&&(console.log("ğŸ” Primer cliente para autocomplete:",{id:P.value[0].id,razon_social:P.value[0].razon_social,hasId:!!P.value[0].id,hasTitle:!!P.value[0].razon_social}),setTimeout(()=>{io.value&&io.value.menu&&(console.log("ğŸ¯ Forzando apertura del menÃº..."),io.value.menu=!0)},100))):(console.log("âŒ No se encontraron clientes en la respuesta"),P.value=[])}catch(o){console.error("âŒ Error en bÃºsqueda:",o),console.error("âŒ Detalles del error:",(e=o.response)==null?void 0:e.data),P.value=[]}finally{eo.value=!1}},300);const ze=async()=>{var n;try{const e=await K.get("/api/bsale-clientes?limit=50&offset=0");console.log("âœ… Primeros clientes cargados:",e.data);const o=((n=e.data.items)==null?void 0:n.map(l=>({id:l.id,razon_social:l.razon_social||l.displayName||"Sin nombre",identification:l.identification,email:l.email,phone:l.phone,address:l.address,city:l.city,municipality:l.municipality,first_name:l.firstName,last_name:l.lastName,company:l.company,tipo_cliente:l.companyOrPerson==1?"empresa":"persona"})))||[];Q.value=o,P.value=o.slice(0,20),console.log("âœ… Clientes iniciales listos:",Q.value.length)}catch(e){console.error("âŒ Error cargando clientes iniciales:",e),P.value=[]}},je=async()=>{var e,o;await new Promise(l=>setTimeout(l,2e3));const n=[];console.log("ğŸ” INICIANDO CAPTURA DE IMÃGENES"),console.log("ğŸ” VENTANA REFS:",E.value),console.log("ğŸ” TOTAL VENTANAS:",c.ventanas.length);for(let l=0;l<c.ventanas.length;l++){const V=c.ventanas[l];console.log(`ğŸ” VENTANA ${l} - TIPO:`,V.tipo);try{const v=E.value[l];if(console.log(`ğŸ” COMPONENTE ${l}:`,v),console.log(`ğŸ” TIPO DE COMPONENTE ${l}:`,typeof v),console.log(`ğŸ” $el DE COMPONENTE ${l}:`,v==null?void 0:v.$el),console.log(`ğŸ” TIPO DE $el ${l}:`,typeof(v==null?void 0:v.$el)),v!=null&&v.exportarImagen&&typeof v.exportarImagen=="function"){console.log(`ğŸ”§ Usando exportarImagen() del componente ${l}`);try{const A=await v.exportarImagen();if(A&&A!==null){console.log(`âœ… IMAGEN ${l} CAPTURADA VIA exportarImagen:`,A.substring(0,50)),n.push(A);continue}else console.warn(`âš ï¸ exportarImagen() devolviÃ³ null para componente ${l}`)}catch(A){console.error(`âŒ Error en exportarImagen del componente ${l}:`,A)}}if(v!=null&&v.$el&&v.$el.nodeType===Node.ELEMENT_NODE&&typeof v.$el.querySelectorAll=="function"){console.log(`ğŸ” ELEMENTO DOM ${l} VÃLIDO:`,v.$el.tagName);const A=v.$el.querySelectorAll("canvas");console.log(`ğŸ” CANVAS ENCONTRADOS EN COMPONENTE ${l}:`,A.length);let j=null;for(let m=0;m<A.length;m++){const O=A[m];console.log(`ğŸ” CANVAS ${l}.${m} - DIMENSIONES:`,O.width,"x",O.height);try{const Ao=O.getContext("2d").getImageData(0,0,O.width,O.height).data.some(Do=>Do!==0);if(console.log(`ğŸ” CANVAS ${l}.${m} - TIENE CONTENIDO:`,Ao),Ao){j=O;break}}catch(ho){console.error(`âŒ Error verificando canvas ${l}.${m}:`,ho)}}if(j){try{const O=(e=j.getStage)==null?void 0:e.call(j);O&&(console.log(`ğŸ”„ Forzando redibujado de Konva en ventana ${l}`),O.draw(),await new Promise(ho=>setTimeout(ho,500)))}catch{console.log(`â„¹ï¸ Ventana ${l} no es Konva`)}const m=j.toDataURL("image/png");console.log(`âœ… IMAGEN ${l} CAPTURADA VIA CANVAS:`,m.substring(0,50)),n.push(m)}else if(A.length>0){console.log("ğŸ”§ Usando primer canvas aunque estÃ© vacÃ­o...");try{const m=A[0].toDataURL("image/png");n.push(m)}catch(m){console.error("âŒ Error en toDataURL:",m),n.push(null)}}else console.warn(`âš ï¸ No se encontraron canvas en componente ${l}`),n.push(null)}else{console.warn(`âš ï¸ Componente ${l} no tiene $el vÃ¡lido o querySelectorAll`),console.log("ğŸ” Â¿$el existe?:",!!(v!=null&&v.$el)),console.log("ğŸ” Â¿Es Element?:",(v==null?void 0:v.$el)instanceof Element),console.log("ğŸ” Â¿Tiene querySelectorAll?:",typeof((o=v==null?void 0:v.$el)==null?void 0:o.querySelectorAll)),console.log("ğŸ”§ Ãšltimo recurso: buscando canvas globalmente...");const A=document.querySelectorAll("canvas");if(console.log("ğŸ” Canvas globales encontrados:",A.length),A.length>l)try{const j=A[l].toDataURL("image/png");console.log(`âœ… IMAGEN ${l} CAPTURADA VIA BÃšSQUEDA GLOBAL`),n.push(j)}catch(j){console.error("âŒ Error en canvas global:",j),n.push(null)}else n.push(null)}}catch(v){console.error(`âŒ ERROR GENERAL capturando imagen ${l}:`,v),n.push(null)}}return console.log("ğŸ–¼ï¸ RESULTADO FINAL:",n.map((l,V)=>`${V}: ${l?"OK":"NULL"}`)),n},we=async()=>{var n,e,o;B.value=!0;try{const l=await je();console.log("ğŸ–¼ï¸ IMÃGENES CAPTURADAS:",l),console.log("ğŸ–¼ï¸ NÃšMERO DE IMÃGENES:",l.length),console.log("ğŸ–¼ï¸ PRIMERA IMAGEN (primeros 100 chars):",(n=l[0])==null?void 0:n.substring(0,100));const V=$.cliente;if(!V){alert("Debes seleccionar un cliente");return}const v=c.ventanas.length>0,A=c.productos&&c.productos.length>0;if(!v&&!A){alert("Debes agregar al menos una ventana o un producto a la cotizaciÃ³n");return}const j={cliente_id:V.id,vendedor_id:1,fecha:new Date().toISOString().split("T")[0],estado_cotizacion_id:c.estado_cotizacion_id??1,observaciones:c.observaciones,imagenes_ventanas:l,ventanas:c.ventanas.map(m=>{const O=ro(m.productoVidrioProveedor);return{id:m.id,tipo_ventana_id:m.tipo,ancho:m.ancho,alto:m.alto,cantidad:m.cantidad,color_id:m.color,producto_vidrio_proveedor_id:m.productoVidrioProveedor,producto_id:O==null?void 0:O.producto_id,proveedor_id:O==null?void 0:O.proveedor_id,costo:m.costo_total||m.costo||0,costo_unitario:m.costo_unitario||0,precio:m.precio||0,precio_unitario:m.precio_unitario||0,tipo_ventana_izquierda:m.tipoVentanaIzquierda??null,tipo_ventana_centro:m.tipoVentanaCentro??null,tipo_ventana_derecha:m.tipoVentanaDerecha??null,ancho_izquierda:m.ancho_izquierda??null,ancho_centro:m.ancho_centro??null,ancho_derecha:m.ancho_derecha??null,hojas_totales:m.hojas_totales??null,hojas_moviles:m.hojas_moviles??null,hoja_movil_seleccionada:m.hojaMovilSeleccionada??null,hoja1_al_frente:m.hoja1AlFrente??null}}),productos:(c.productos||[]).map(m=>({id:m.id,producto_lista_id:m.producto_lista_id,lista_precio_id:m.lista_precio_id,descripcion:m.descripcion||m.nombre||"",cantidad:m.cantidad,precio_unitario:m.precio_venta/m.cantidad,total:m.total||m.precio_venta*m.cantidad,esVidrio:m.esVidrio||!1,ancho_mm:m.ancho_mm||null,alto_mm:m.alto_mm||null,m2:m.m2||null,pulido:m.pulido||!1}))};console.log("ğŸ“¤ PAYLOAD A ENVIAR:",j),console.log("ğŸ“¤ VENTANAS ESPECÃFICAS:",j.ventanas),console.log("ğŸ“¤ PRODUCTOS ESPECÃFICOS:",j.productos),f.value?(console.log("ğŸ”„ Actualizando cotizaciÃ³n existente ID:",h.value),await K.put(`/api/cotizaciones/${h.value}`,j),alert("CotizaciÃ³n actualizada correctamente")):(console.log("âœ¨ Creando nueva cotizaciÃ³n"),await K.post("/api/cotizaciones",j),alert("CotizaciÃ³n guardada correctamente")),g.push({name:"cotizaciones"})}catch(l){console.error("Error al guardar cotizaciÃ³n:",l),(o=(e=l.response)==null?void 0:e.data)!=null&&o.message?alert(l.response.data.message):alert("Error al guardar la cotizaciÃ³n")}finally{B.value=!1}};return(n,e)=>(b(),to(Vo,null,[a(_a,{fluid:""},{default:i(()=>[a(go,{class:"pa-6",elevation:"2"},{default:i(()=>[a(Eo,{class:"text-h5 mb-4"},{default:i(()=>[u(R(f.value?"Editar CotizaciÃ³n":"Nueva CotizaciÃ³n"),1)]),_:1}),a(So,{class:"text-h5"},{default:i(()=>e[16]||(e[16]=[u("Datos generales")])),_:1}),a(po,{class:"mb-4"}),a(co,{dense:""},{default:i(()=>[a(T,{cols:"6",md:"4"},{default:i(()=>[a(co,{"no-gutters":"",align:"center"},{default:i(()=>[a(T,null,{default:i(()=>[J("div",wa,[a(fo,{modelValue:H.value,"onUpdate:modelValue":e[0]||(e[0]=o=>H.value=o),onInput:Ie,onFocus:Te,"onClick:clear":De,label:"Cliente",placeholder:"Buscar por RUT o nombre...",outlined:"",clearable:"",loading:eo.value,color:"primary","append-inner-icon":$.cliente?"mdi-check-circle":"mdi-magnify",hint:$.cliente?`Seleccionado: ${$.cliente.razon_social}`:"","persistent-hint":""},null,8,["modelValue","loading","append-inner-icon","hint"]),p.value&&P.value.length>0?(b(),N(go,{key:0,style:{position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto"},class:"mt-1",elevation:"8"},{default:i(()=>[a(Va,{density:"compact"},{default:i(()=>[(b(!0),to(Vo,null,Ro(P.value,o=>(b(),N(wo,{key:o.id,onClick:l=>Ne(o),class:"cursor-pointer",hover:""},{prepend:i(()=>[a(U,null,{default:i(()=>e[17]||(e[17]=[u("mdi-account")])),_:1})]),default:i(()=>[a(Oo,null,{default:i(()=>[u(R(o.razon_social),1)]),_:2},1024),a(Mo,null,{default:i(()=>[u(R(o.identification),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})):oo("",!0)])]),_:1}),a(T,{cols:"auto"},{default:i(()=>[a(W,{icon:"",color:"primary",onClick:ke,class:"ml-2"},{default:i(()=>[a(U,null,{default:i(()=>e[18]||(e[18]=[u("mdi-plus")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(co,{dense:""},{default:i(()=>[a(T,{cols:"4"},{default:i(()=>[a(Ca,{modelValue:c.observaciones,"onUpdate:modelValue":e[1]||(e[1]=o=>c.observaciones=o),label:"Observaciones","row-height":"15",rows:"1",outlined:"",color:"primary","auto-grow":""},null,8,["modelValue"])]),_:1})]),_:1}),a(po,{class:"my-4"}),a(So,{class:"text-h5"},{default:i(()=>e[19]||(e[19]=[u("Items de la CotizaciÃ³n")])),_:1}),a(po,{class:"mb-4"}),a(co,{class:"mb-4"},{default:i(()=>[a(T,{cols:"auto"},{default:i(()=>[a(W,{color:"primary",onClick:s,disabled:!r.value.length},{default:i(()=>[a(U,{left:""},{default:i(()=>e[20]||(e[20]=[u("mdi-window-closed-variant")])),_:1}),e[21]||(e[21]=u(" Ventana "))]),_:1},8,["disabled"])]),_:1}),a(T,{cols:"auto"},{default:i(()=>[a(W,{color:"success",onClick:k},{default:i(()=>[a(U,{left:""},{default:i(()=>e[22]||(e[22]=[u("mdi-package-variant")])),_:1}),e[23]||(e[23]=u(" Productos "))]),_:1})]),_:1})]),_:1}),a(Yo,null,{default:i(()=>[uo.value?(b(),N(go,{key:0,class:"mb-4",outlined:""},{default:i(()=>[a(Go,null,{default:i(()=>[a(So,{class:"text-subtitle-1 font-weight-bold"},{default:i(()=>e[24]||(e[24]=[u("Pre-configuraciÃ³n de Ventana")])),_:1}),a(co,{dense:"",class:"mt-2"},{default:i(()=>[a(T,{cols:"12",md:"6"},{default:i(()=>[a(ko,{modelValue:c.material,"onUpdate:modelValue":e[2]||(e[2]=o=>c.material=o),items:w.value,"item-title":"nombre","item-value":"id",label:"Material",outlined:"",dense:"",color:"primary"},null,8,["modelValue","items"])]),_:1}),a(T,{cols:"12",md:"6"},{default:i(()=>[a(ko,{modelValue:c.color,"onUpdate:modelValue":e[3]||(e[3]=o=>c.color=o),items:_.value,"item-title":"nombre","item-value":"id",label:"Color",outlined:"",dense:"",color:"primary"},null,8,["modelValue","items"])]),_:1}),a(T,{cols:"12",sm:"6"},{default:i(()=>[a(ko,{modelValue:c.tipoVidrio,"onUpdate:modelValue":e[4]||(e[4]=o=>c.tipoVidrio=o),items:G.value,"item-title":"nombre","item-value":"id",label:"Tipo de vidrio",outlined:"",dense:"",color:"primary"},null,8,["modelValue","items"])]),_:1}),a(T,{cols:"12",sm:"6"},{default:i(()=>[a(ko,{modelValue:c.productoVidrioProveedor,"onUpdate:modelValue":e[5]||(e[5]=o=>c.productoVidrioProveedor=o),items:X.value,"item-title":"nombre","item-value":"id",label:"Producto de vidrio",outlined:"",dense:"",color:"primary"},null,8,["modelValue","items"])]),_:1})]),_:1}),a(W,{color:"primary",onClick:x,block:"",class:"mt-2"},{default:i(()=>[a(U,{left:""},{default:i(()=>e[25]||(e[25]=[u("mdi-plus")])),_:1}),e[26]||(e[26]=u(" Agregar Ventana "))]),_:1})]),_:1})]),_:1})):oo("",!0)]),_:1}),c.ventanas.length>0?(b(),N(ie,{key:0,headers:lo,items:c.ventanas,class:"mt-4","items-per-page":5},{"item.tipo":i(({item:o})=>[u(R(S.value[Number(o.tipo)]||o.tipo),1)]),"item.acciones":i(({item:o,index:l})=>[a(W,{icon:"",onClick:V=>q(l)},{default:i(()=>[a(U,null,{default:i(()=>e[27]||(e[27]=[u("mdi-pencil")])),_:1})]),_:2},1032,["onClick"]),a(W,{icon:"",color:"error",onClick:V=>Ee(l)},{default:i(()=>[a(U,null,{default:i(()=>e[28]||(e[28]=[u("mdi-delete")])),_:1})]),_:2},1032,["onClick"])]),_:1},8,["items"])):(b(),N(re,{key:1,type:"info",variant:"tonal",class:"mt-4"},{default:i(()=>e[29]||(e[29]=[u(' No hay ventanas agregadas. Haz clic en "Agregar Ventana" para comenzar. ')])),_:1})),c.productos.length>0?(b(),N(ie,{key:2,headers:Lo,items:c.productos,class:"mt-4","items-per-page":5},{top:i(()=>[a(ja,{flat:"",color:"transparent"},{default:i(()=>[a(Ae,{class:"text-subtitle-1"},{default:i(()=>e[30]||(e[30]=[u("Productos")])),_:1})]),_:1})]),"item.nombre":i(({item:o})=>[J("div",null,[J("div",Oa,R(o.nombre),1),o.descripcion&&o.descripcion!==o.nombre?(b(),to("div",Ma,R(o.descripcion),1)):oo("",!0)])]),"item.precio_costo":i(({item:o})=>[u(" $"+R(Y(o.precio_costo)),1)]),"item.margen":i(({item:o})=>[u(R(o.margen)+"% ",1)]),"item.precio_venta":i(({item:o})=>[u(" $"+R(Y(o.precio_venta)),1)]),"item.acciones":i(({item:o,index:l})=>[a(W,{icon:"",color:"error",onClick:V=>z(l)},{default:i(()=>[a(U,null,{default:i(()=>e[31]||(e[31]=[u("mdi-delete")])),_:1})]),_:2},1032,["onClick"])]),_:1},8,["items"])):oo("",!0),a(ia,{mostrar:no.value,"onUpdate:mostrar":e[6]||(e[6]=o=>no.value=o),materiales:w.value,colores:_.value,tiposVidrio:G.value,productosVidrio:L.value,tiposVentana:r.value,ventana:ao.value,"material-default":c.material,"color-default":c.color,"tipo-vidrio-default":c.tipoVidrio,"producto-vidrio-default":c.productoVidrioProveedor,onGuardar:mo},null,8,["mostrar","materiales","colores","tiposVidrio","productosVidrio","tiposVentana","ventana","material-default","color-default","tipo-vidrio-default","producto-vidrio-default"]),a(va,{mostrar:bo.value,"onUpdate:mostrar":e[7]||(e[7]=o=>bo.value=o),onAgregarProductos:yo},null,8,["mostrar"]),a(po,{class:"my-4"}),J("div",Ra,[a(W,{color:"primary",loading:B.value,disabled:B.value,onClick:we},{loader:i(()=>[a(oa,{indeterminate:"",color:"white",size:"20"})]),default:i(()=>[u(" "+R(f.value?"Guardar Cambios":"Guardar CotizaciÃ³n"),1)]),_:1},8,["loading","disabled"])]),c.ventanas.length>0?(b(),to("div",Ua,[a(So,{class:"text-h5"},{default:i(()=>e[32]||(e[32]=[u("Vista previa de ventanas")])),_:1}),a(po,{class:"mb-4"}),(b(!0),to(Vo,null,Ro(c.ventanas,(o,l)=>(b(),to("div",{key:l,class:"mb-4"},[a(go,{class:"pa-4",outlined:""},{default:i(()=>[a(Eo,null,{default:i(()=>[u(R(S.value[o.tipo]||`Ventana ${l+1}`),1)]),_:2},1024),a(co,null,{default:i(()=>[a(T,{cols:"6"},{default:i(()=>{var V,v,A,j,m,O,ho,Bo,Ao,Do,Qo,Xo,Zo,oe,ee;return[o.tipo===1?(b(),N(ra,{key:0,ref_for:!0,ref:d=>{d&&(E.value[l]=d)},ancho:o.ancho,alto:o.alto,"color-marco":((V=_.value.find(d=>d.id===o.color))==null?void 0:V.nombre)||"blanco",material:o.material,tipoVidrio:o.tipoVidrio,productoVidrioProveedor:o.productoVidrioProveedor},null,8,["ancho","alto","color-marco","material","tipoVidrio","productoVidrioProveedor"])):o.tipo===2?(b(),N(ea,{key:1,ref_for:!0,ref:d=>{d&&(E.value[l]=d)},ancho:o.ancho,alto:o.alto,"color-marco":((v=_.value.find(d=>d.id===o.color))==null?void 0:v.nombre)||"blanco",material:o.material,tipoVidrio:o.tipoVidrio,productoVidrioProveedor:o.productoVidrioProveedor},null,8,["ancho","alto","color-marco","material","tipoVidrio","productoVidrioProveedor"])):o.tipo===45?(b(),N(aa,{key:2,ref_for:!0,ref:d=>{d&&(E.value[l]=d)},ancho:o.ancho,alto:o.alto,"color-marco":((A=_.value.find(d=>d.id===o.color))==null?void 0:A.nombre)||"blanco",material:o.material,tipoVidrio:o.tipoVidrio,productoVidrioProveedor:o.productoVidrioProveedor},null,8,["ancho","alto","color-marco","material","tipoVidrio","productoVidrioProveedor"])):o.tipo===56?(b(),N(na,{key:3,ref_for:!0,ref:d=>{d&&(E.value[l]=d)},ancho:o.ancho,alto:o.alto,"color-marco":((j=_.value.find(d=>d.id===o.color))==null?void 0:j.nombre)||"blanco",material:o.material,tipoVidrio:o.tipoVidrio,productoVidrioProveedor:o.productoVidrioProveedor},null,8,["ancho","alto","color-marco","material","tipoVidrio","productoVidrioProveedor"])):o.tipo===55?(b(),N(sa,{key:4,ref_for:!0,ref:d=>{d&&(E.value[l]=d)},ancho:o.ancho,alto:o.alto,"color-marco":((m=_.value.find(d=>d.id===o.color))==null?void 0:m.nombre)||"blanco",hoja1AlFrente:o.hoja1AlFrente,"hojas-moviles":o.hojas_moviles||2,"hoja-movil-seleccionada":o.hojaMovilSeleccionada||1},null,8,["ancho","alto","color-marco","hoja1AlFrente","hojas-moviles","hoja-movil-seleccionada"])):o.tipo===57?(b(),N(ca,{key:5,ref_for:!0,ref:d=>{d&&(E.value[l]=d)},ancho:o.ancho,alto:o.alto,"color-marco":((O=_.value.find(d=>d.id===o.color))==null?void 0:O.nombre)||"blanco",filas:o.filas||1,columnas:o.columnas||1,"altos-filas":o.altosFilas||[],"anchos-columnas":o.anchosColumnas||[],secciones:o.secciones||[[{tipo:1}]]},null,8,["ancho","alto","color-marco","filas","columnas","altos-filas","anchos-columnas","secciones"])):o.tipo===3?(b(),N(ga,{key:6,ref_for:!0,ref:d=>{d&&(E.value[l]=d)},ancho:o.ancho,alto:o.alto,"color-marco":((ho=_.value.find(d=>d.id===o.color))==null?void 0:ho.nombre)||"blanco",material:o.material,tipoVidrio:o.tipoVidrio,productoVidrioProveedor:o.productoVidrioProveedor,"hojas-totales":o.hojas_totales,"hojas-moviles":o.hojas_moviles,"hoja-movil-seleccionada":o.hojaMovilSeleccionada,"orden-hoja1-al-frente":o.hoja1AlFrente},null,8,["ancho","alto","color-marco","material","tipoVidrio","productoVidrioProveedor","hojas-totales","hojas-moviles","hoja-movil-seleccionada","orden-hoja1-al-frente"])):o.tipo===52?(b(),N(da,{key:7,ancho:o.ancho,alto:o.alto,"color-marco":((Bo=_.value.find(d=>d.id===o.color))==null?void 0:Bo.nombre)||"blanco",material:o.material,tipoVidrio:o.tipoVidrio,productoVidrioProveedor:o.productoVidrioProveedor,"hojas-totales":o.hojas_totales,"hojas-moviles":o.hojas_moviles,"hoja-movil-seleccionada":o.hojaMovilSeleccionada,"orden-hoja1-al-frente":o.hoja1AlFrente},null,8,["ancho","alto","color-marco","material","tipoVidrio","productoVidrioProveedor","hojas-totales","hojas-moviles","hoja-movil-seleccionada","orden-hoja1-al-frente"])):o.tipo===47?(b(),N(la,{key:8,ref_for:!0,ref:d=>{d&&(E.value[l]=d)},ancho:o.ancho,alto:o.alto,"color-marco":((Ao=_.value.find(d=>d.id===o.color))==null?void 0:Ao.nombre)||"blanco",material:o.material,tipoVidrio:o.tipoVidrio,productoVidrioProveedor:o.productoVidrioProveedor,"ancho-izquierda":o.ancho_izquierda,"ancho-centro":o.ancho_centro,"ancho-derecha":o.ancho_derecha,"tipo-ventana-izquierda":o.tipoVentanaIzquierda,"tipo-ventana-centro":o.tipoVentanaCentro,"tipo-ventana-derecha":o.tipoVentanaDerecha},null,8,["ancho","alto","color-marco","material","tipoVidrio","productoVidrioProveedor","ancho-izquierda","ancho-centro","ancho-derecha","tipo-ventana-izquierda","tipo-ventana-centro","tipo-ventana-derecha"])):o.tipo===46?(b(),N(ta,{key:9,ref_for:!0,ref:d=>{d&&(E.value[l]=d)},ancho:o.ancho,alto:o.alto,"color-marco":((Do=_.value.find(d=>d.id===o.color))==null?void 0:Do.nombre)||"blanco",material:o.material,tipoVidrio:o.tipoVidrio,productoVidrioProveedor:o.productoVidrioProveedor,"hojas-totales":o.hojas_totales,"hojas-moviles":o.hojas_moviles,"hoja-movil-seleccionada":o.hojaMovilSeleccionada,"orden-hoja1-al-frente":o.hoja1AlFrente},null,8,["ancho","alto","color-marco","material","tipoVidrio","productoVidrioProveedor","hojas-totales","hojas-moviles","hoja-movil-seleccionada","orden-hoja1-al-frente"])):o.tipo===53?(b(),N(ua,{key:10,ref_for:!0,ref:d=>{d&&(E.value[l]=d)},ancho:o.ancho,alto:o.alto,"color-marco":((Qo=_.value.find(d=>d.id===o.color))==null?void 0:Qo.nombre)||"blanco","lado-apertura":o.ladoApertura},null,8,["ancho","alto","color-marco","lado-apertura"])):o.tipo===49?(b(),N(ma,{key:11,ref_for:!0,ref:d=>{d&&(E.value[l]=d)},ancho:o.ancho,alto:o.alto,"color-marco":((Xo=_.value.find(d=>d.id===o.color))==null?void 0:Xo.nombre)||"blanco",material:o.material,tipoVidrio:o.tipoVidrio,productoVidrioProveedor:o.productoVidrioProveedor,"lado-inicial":o.ladoApertura||"izquierda"},null,8,["ancho","alto","color-marco","material","tipoVidrio","productoVidrioProveedor","lado-inicial"])):o.tipo===50?(b(),N(pa,{key:12,ref_for:!0,ref:d=>{d&&(E.value[l]=d)},ancho:o.ancho,alto:o.alto,"color-marco":((Zo=_.value.find(d=>d.id===o.color))==null?void 0:Zo.nombre)||"blanco",material:o.material,tipoVidrio:o.tipoVidrio,productoVidrioProveedor:o.productoVidrioProveedor,"lado-apertura":o.ladoApertura,"direccion-apertura":o.direccionApertura,"paso-libre":o.pasoLibre},null,8,["ancho","alto","color-marco","material","tipoVidrio","productoVidrioProveedor","lado-apertura","direccion-apertura","paso-libre"])):o.tipo===51?(b(),N(fa,{key:13,ref_for:!0,ref:d=>{d&&(E.value[l]=d)},ancho:o.ancho,alto:o.alto,"color-marco":((oe=_.value.find(d=>d.id===o.color))==null?void 0:oe.nombre)||"blanco","hoja-activa":o.hojaActiva,"direccion-apertura":o.direccionApertura,"paso-libre":o.pasoLibre},null,8,["ancho","alto","color-marco","hoja-activa","direccion-apertura","paso-libre"])):o.tipo===58?(b(),N(Ta,{key:14,ref_for:!0,ref:d=>{d&&(E.value[l]=d)},ancho:o.ancho,alto:o.alto,"color-marco":((ee=_.value.find(d=>d.id===o.color))==null?void 0:ee.nombre)||"blanco","configuracion-inicial":o.configuracionArmador,"tipos-ventana":F},null,8,["ancho","alto","color-marco","configuracion-inicial"])):oo("",!0)]}),_:2},1024),a(T,{cols:"6"},{default:i(()=>[a(go,{variant:"outlined"},{default:i(()=>[a(Eo,null,{default:i(()=>e[33]||(e[33]=[u("Detalles")])),_:1}),a(Go,null,{default:i(()=>[J("p",null,[e[34]||(e[34]=J("strong",null,"Ancho:",-1)),u(" "+R(o.ancho)+"mm",1)]),J("p",null,[e[35]||(e[35]=J("strong",null,"Alto:",-1)),u(" "+R(o.alto)+"mm",1)]),J("p",null,[e[36]||(e[36]=J("strong",null,"Cantidad:",-1)),u(" "+R(o.cantidad),1)]),J("p",null,[e[37]||(e[37]=J("strong",null,"Precio:",-1)),u(" $"+R(o.precio),1)])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))])):oo("",!0)]),_:1})]),_:1}),a(ya,{modelValue:C.value,"onUpdate:modelValue":e[15]||(e[15]=o=>C.value=o),"max-width":"600px"},{default:i(()=>[a(go,null,{default:i(()=>[a(Eo,{class:"text-h5 pa-4"},{default:i(()=>[a(U,{class:"mr-2",color:"primary"},{default:i(()=>e[38]||(e[38]=[u("mdi-account-plus")])),_:1}),e[39]||(e[39]=u(" Crear Cliente Nuevo "))]),_:1}),a(po),a(Go,{class:"pa-4"},{default:i(()=>[a(re,{type:"info",variant:"tonal",class:"mb-4"},{default:i(()=>e[40]||(e[40]=[u(" Este cliente se guardarÃ¡ en tu base de datos local. Para facturar, deberÃ¡s seleccionar un cliente sincronizado con Bsale. ")])),_:1}),a(Pa,{ref:"formCliente"},{default:i(()=>[a(co,null,{default:i(()=>[a(T,{cols:"12"},{default:i(()=>[a(fo,{modelValue:y.value.razon_social,"onUpdate:modelValue":e[8]||(e[8]=o=>y.value.razon_social=o),label:"RazÃ³n Social / Nombre *",rules:[o=>!!o||"RazÃ³n social es requerida"],required:"",outlined:""},null,8,["modelValue","rules"])]),_:1}),a(T,{cols:"12",md:"6"},{default:i(()=>[a(fo,{modelValue:y.value.identification,"onUpdate:modelValue":e[9]||(e[9]=o=>y.value.identification=o),label:"RUT",outlined:"",hint:"Formato: 12345678-9"},null,8,["modelValue"])]),_:1}),a(T,{cols:"12",md:"6"},{default:i(()=>[a(fo,{modelValue:y.value.email,"onUpdate:modelValue":e[10]||(e[10]=o=>y.value.email=o),label:"Email",type:"email",outlined:""},null,8,["modelValue"])]),_:1}),a(T,{cols:"12",md:"6"},{default:i(()=>[a(fo,{modelValue:y.value.phone,"onUpdate:modelValue":e[11]||(e[11]=o=>y.value.phone=o),label:"TelÃ©fono",outlined:""},null,8,["modelValue"])]),_:1}),a(T,{cols:"12",md:"6"},{default:i(()=>[a(fo,{modelValue:y.value.ciudad,"onUpdate:modelValue":e[12]||(e[12]=o=>y.value.ciudad=o),label:"Ciudad",outlined:""},null,8,["modelValue"])]),_:1}),a(T,{cols:"12"},{default:i(()=>[a(fo,{modelValue:y.value.address,"onUpdate:modelValue":e[13]||(e[13]=o=>y.value.address=o),label:"DirecciÃ³n",outlined:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},512)]),_:1}),a(po),a(_e,{class:"pa-4"},{default:i(()=>[a(ye),a(W,{color:"grey",text:"",onClick:e[14]||(e[14]=o=>C.value=!1)},{default:i(()=>e[41]||(e[41]=[u(" Cancelar ")])),_:1}),a(W,{color:"primary",onClick:$e},{default:i(()=>[a(U,{left:""},{default:i(()=>e[42]||(e[42]=[u("mdi-content-save")])),_:1}),e[43]||(e[43]=u(" Guardar Cliente "))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},$l=Jo(Ba,[["__scopeId","data-v-a6299cf5"]]);export{$l as default};
