import{d as le}from"./debounce-DXIiIT6J.js";import{r as k,X as z,a as go,f as N,o as b,e as t,m as ao,c as to,F as Vo,b as a,i as Lo,ab as Po,ac as xo,P as ue,ad as Ao,aL as Yo,af as To,I as pe,J as we,aM as Re,ag as Jo,aN as Le,az as Ue,aO as Do,Z as L,aP as Be,aq as ie,aB as Fe,aQ as me,ah as fe,ae as Uo,ao as ve,aC as qe,aR as ge,N as Ge,ax as He,av as _e,aG as Ve,Y as eo,an as be,aS as We,aT as Ye,E as he,ar as J,d as K,t as p,aU as zo,aV as jo,v as R,a3 as W,aW as Je,aw as Ke,ay as Xe,aX as Qe,aE as Oo,aY as te,j as Ze,k as oa,w as Fo,aZ as ea}from"./index-Bbf9NtO_.js";/* empty css                                                                */import{_ as Ko}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Shapes-DW6qcN1k.js";import{_ as aa,a as la,b as ia}from"./VistaBayWindow-DM4LqFKC.js";import{_ as ta,a as ra,b as na,c as sa,d as ca,e as da,f as ua,g as pa,h as ma,i as fa}from"./AgregarVentanaModal2-BhWdQGJB.js";import va from"./EditarVentanaModal-DNUr19Ou.js";import ga from"./ModalProductos-Cs1IrK7p.js";import{_ as _a}from"./VistaVentanaFijaS60-BmTkm7Cv.js";import{_ as Va}from"./VistaVentanaCorredera-BBQomx9q.js";import{b as Io,V as _o,d as So,c as ye}from"./VCard-C1PjMmAL.js";import{V as fo}from"./VDivider-gR8e3Iny.js";import{V as co,a as $}from"./VRow-e2eJeLw2.js";import{V as vo}from"./VTextField-BML0o-9-.js";import{V as qo}from"./VAutocomplete-DnnP3-kU.js";import{a as Mo,b as wo,d as Ro,V as ba}from"./VList-B-rGQG8c.js";import{V as ko}from"./VSelect-CaTpVbiJ.js";import{V as Ce}from"./VSpacer-ByV-CSYn.js";import{u as ha,m as ya}from"./VOverlay-DUm3p4jJ.js";import{V as Ca}from"./VContainer-CT8eMPy7.js";import{V as Pa}from"./VDialog-4rgjSyxk.js";import{V as xa}from"./VTextarea-cKmAB4GX.js";import{V as Go}from"./VCardText-BS7-d3lL.js";import{V as re}from"./VDataTable-bxdMY2XJ.js";import{V as ne}from"./VAlert-CYbz_vFs.js";import{V as Aa}from"./VImg-DDK4CAHl.js";import{V as Ea}from"./VForm-BY0SHyqZ.js";import"./VSwitch-BPDk1XMe.js";import"./VInput-BQ9KC5pQ.js";import"./transition-BVD5sUHd.js";import"./VSelectionControl-BaBBSdHs.js";import"./VRadioGroup-CvzlsW1i.js";import"./VTooltip-Bw5UplVk.js";import"./forwardRefs-DWGaNmQL.js";import"./VChip-DRg--sXz.js";import"./VAvatar-CFjRqMQj.js";import"./VCheckbox-D1qv0VMy.js";import"./VCheckboxBtn-sSehld79.js";/* empty css              */import"./filter-C_GDCAu8.js";import"./VMenu-B1TTIrK1.js";import"./VTable-CeArmYJ_.js";const so=8,Ia={__name:"SeccionArmador",props:{seccion:{type:Object,required:!0},x:{type:Number,required:!0},y:{type:Number,required:!0},anchoDisponible:{type:Number,required:!0},altoDisponible:{type:Number,required:!0},escala:{type:Number,default:1},nivel:{type:Number,default:0},path:{type:String,required:!0},pathSeleccionado:{type:String,default:null},tiposVentana:{type:Array,default:()=>[]},perfilDivisorH:{type:Number,default:null},perfilDivisorV:{type:Number,default:null}},emits:["seleccionar","dividir","asignar-tipo","eliminar"],setup(i,{emit:I}){const r=i,V=I,w=k(!1),g=z(()=>r.pathSeleccionado===r.path),y=z(()=>r.seccion.anchoFijo?Math.max(20,r.seccion.anchoFijo*r.escala):Math.max(20,r.anchoDisponible*(r.seccion.porcentaje||100)/100)),S=z(()=>r.seccion.altoFijo?Math.max(20,r.seccion.altoFijo*r.escala):Math.max(20,r.altoDisponible*(r.seccion.porcentaje||100)/100)),c=z(()=>({x:r.x,y:r.y,width:Math.max(1,y.value),height:Math.max(1,S.value),fill:X(),stroke:"#999",strokeWidth:1,cornerRadius:Math.min(2,Math.max(0,y.value/10,S.value/10)),listening:!0})),F=z(()=>({x:r.x-2,y:r.y-2,width:Math.max(5,y.value+4),height:Math.max(5,S.value+4),stroke:g.value?"#FF5722":"#2196F3",strokeWidth:3,dash:[8,4],cornerRadius:Math.min(2,Math.max(0,y.value/10,S.value/10))})),B=z(()=>{var P,C,Q;(P=r.seccion.subsecciones)!=null&&P.length;const v=r.y+S.value*(((Q=(C=r.seccion.subsecciones)==null?void 0:C[0])==null?void 0:Q.porcentaje)||50)/100;return{points:[r.x,v-so/2,r.x+y.value,v-so/2,r.x+y.value,v+so/2,r.x,v+so/2],closed:!0,fill:"#757575",stroke:"#424242",strokeWidth:1}}),j=z(()=>{var P,C;const v=r.x+y.value*(((C=(P=r.seccion.subsecciones)==null?void 0:P[0])==null?void 0:C.porcentaje)||50)/100;return{points:[v-so/2,r.y,v+so/2,r.y,v+so/2,r.y+S.value,v-so/2,r.y+S.value],closed:!0,fill:"#757575",stroke:"#424242",strokeWidth:1}});function M(v){if(r.seccion.orientacion==="vertical"){let P=r.x;for(let C=0;C<v;C++)P+=G(C),C<v-1&&(P+=so);return P}return r.x}function h(v){if(r.seccion.orientacion==="horizontal"){let P=r.y;for(let C=0;C<v;C++)P+=T(C),C<v-1&&(P+=so);return P}return r.y}function G(v){if(r.seccion.orientacion==="vertical"){const P=r.seccion.subsecciones[v];return y.value*(P.porcentaje||50)/100}return y.value}function T(v){if(r.seccion.orientacion==="horizontal"){const P=r.seccion.subsecciones[v];return S.value*(P.porcentaje||50)/100}return S.value}function X(){return r.seccion.tipo==="ventana"?"#E3F2FD":r.seccion.tipo==="compuesta"?"transparent":"#FAFAFA"}function E(v){const P=r.tiposVentana.find(C=>C.id===v);return P?P.nombre:`Tipo ${v}`}function lo(v){V("seleccionar",r.path),v.cancelBubble=!0}function ro(v){v.target.getLayer()&&(v.target.getLayer().getStage().container().style.cursor="pointer"),w.value=!0}function H(v){v.target.getLayer()&&(v.target.getLayer().getStage().container().style.cursor="default"),w.value=!1}return(v,P)=>{const C=go("v-rect"),Q=go("v-text"),no=go("v-line"),Co=go("SeccionArmador",!0),uo=go("v-group");return b(),N(uo,null,{default:t(()=>{var po;return[i.seccion.tipo!=="compuesta"?(b(),N(C,{key:0,config:c.value,onClick:lo,onMouseenter:ro,onMouseleave:H},null,8,["config"])):ao("",!0),(g.value||w.value)&&i.seccion.tipo!=="compuesta"?(b(),N(C,{key:1,config:F.value},null,8,["config"])):ao("",!0),i.seccion.tipo==="ventana"&&i.seccion.tipoVentanaId?(b(),to(Vo,{key:2},[a(Q,{config:{x:i.x+y.value/2,y:i.y+S.value/2,text:E(i.seccion.tipoVentanaId),fontSize:14,fill:"#333",align:"center",width:y.value,offsetY:7}},null,8,["config"]),a(no,{config:{points:[i.x+10,i.y+10,i.x+y.value-10,i.y+10,i.x+y.value-10,i.y+S.value-10,i.x+10,i.y+S.value-10],closed:!0,stroke:"#2196F3",strokeWidth:2,dash:[5,5]}},null,8,["config"])],64)):i.seccion.tipo==="compuesta"&&((po=i.seccion.subsecciones)==null?void 0:po.length)>0?(b(),to(Vo,{key:3},[i.seccion.orientacion==="horizontal"?(b(),N(no,{key:0,config:B.value},null,8,["config"])):ao("",!0),i.seccion.orientacion==="vertical"?(b(),N(no,{key:1,config:j.value},null,8,["config"])):ao("",!0),(b(!0),to(Vo,null,Lo(i.seccion.subsecciones,(bo,io)=>(b(),N(Co,{key:`${i.path}.${io}`,seccion:bo,x:M(io),y:h(io),"ancho-disponible":G(io),"alto-disponible":T(io),escala:i.escala,nivel:i.nivel+1,path:`${i.path}.${io}`,"path-seleccionado":i.pathSeleccionado,"tipos-ventana":i.tiposVentana,"perfil-divisor-h":i.perfilDivisorH,"perfil-divisor-v":i.perfilDivisorV,onSeleccionar:P[0]||(P[0]=Z=>v.$emit("seleccionar",Z)),onDividir:P[1]||(P[1]=Z=>v.$emit("dividir",Z)),onAsignarTipo:P[2]||(P[2]=Z=>v.$emit("asignar-tipo",Z)),onEliminar:P[3]||(P[3]=Z=>v.$emit("eliminar",Z))},null,8,["seccion","x","y","ancho-disponible","alto-disponible","escala","nivel","path","path-seleccionado","tipos-ventana","perfil-divisor-h","perfil-divisor-v"]))),128))],64)):(b(),to(Vo,{key:4},[a(Q,{config:{x:i.x+y.value/2,y:i.y+S.value/2-10,text:"Click para dividir",fontSize:12,fill:"#999",align:"center",width:y.value,offsetY:6}},null,8,["config"]),a(Q,{config:{x:i.x+y.value/2,y:i.y+S.value/2+10,text:"o asignar ventana",fontSize:10,fill:"#999",align:"center",width:y.value,offsetY:5}},null,8,["config"])],64)),ao("",!0)]}),_:1})}}},Sa=Ko(Ia,[["__scopeId","data-v-08033118"]]),No=Symbol.for("vuetify:v-expansion-panel"),Pe=xo({...To(),...ya()},"VExpansionPanelText"),se=Po()({name:"VExpansionPanelText",props:Pe(),setup(i,I){let{slots:r}=I;const V=ue(No);if(!V)throw new Error("[Vuetify] v-expansion-panel-text needs to be placed inside v-expansion-panel");const{hasContent:w,onAfterLeave:g}=ha(i,V.isSelected);return Ao(()=>a(Yo,{onAfterLeave:g},{default:()=>{var y;return[pe(a("div",{class:["v-expansion-panel-text",i.class],style:i.style},[r.default&&w.value&&a("div",{class:"v-expansion-panel-text__wrapper"},[(y=r.default)==null?void 0:y.call(r)])]),[[we,V.isSelected.value]])]}})),{}}}),xe=xo({color:String,expandIcon:{type:ie,default:"$expand"},collapseIcon:{type:ie,default:"$collapse"},hideActions:Boolean,focusable:Boolean,static:Boolean,ripple:{type:[Boolean,Object],default:!1},readonly:Boolean,...To(),...Be()},"VExpansionPanelTitle"),ce=Po()({name:"VExpansionPanelTitle",directives:{Ripple:Re},props:xe(),setup(i,I){let{slots:r}=I;const V=ue(No);if(!V)throw new Error("[Vuetify] v-expansion-panel-title needs to be placed inside v-expansion-panel");const{backgroundColorClasses:w,backgroundColorStyles:g}=Jo(i,"color"),{dimensionStyles:y}=Le(i),S=z(()=>({collapseIcon:i.collapseIcon,disabled:V.disabled.value,expanded:V.isSelected.value,expandIcon:i.expandIcon,readonly:i.readonly})),c=z(()=>V.isSelected.value?i.collapseIcon:i.expandIcon);return Ao(()=>{var F;return pe(a("button",{class:["v-expansion-panel-title",{"v-expansion-panel-title--active":V.isSelected.value,"v-expansion-panel-title--focusable":i.focusable,"v-expansion-panel-title--static":i.static},w.value,i.class],style:[g.value,y.value,i.style],type:"button",tabindex:V.disabled.value?-1:void 0,disabled:V.disabled.value,"aria-expanded":V.isSelected.value,onClick:i.readonly?void 0:V.toggle},[a("span",{class:"v-expansion-panel-title__overlay"},null),(F=r.default)==null?void 0:F.call(r,S.value),!i.hideActions&&a(Do,{defaults:{VIcon:{icon:c.value}}},{default:()=>{var B;return[a("span",{class:"v-expansion-panel-title__icon"},[((B=r.actions)==null?void 0:B.call(r,S.value))??a(L,null,null)])]}})]),[[Ue("ripple"),i.ripple]])}),{}}}),Ae=xo({title:String,text:String,bgColor:String,...ge(),...qe(),...ve(),...Uo(),...xe(),...Pe()},"VExpansionPanel"),jl=Po()({name:"VExpansionPanel",props:Ae(),emits:{"group:selected":i=>!0},setup(i,I){let{slots:r}=I;const V=Fe(i,No),{backgroundColorClasses:w,backgroundColorStyles:g}=Jo(i,"bgColor"),{elevationClasses:y}=me(i),{roundedClasses:S}=fe(i),c=z(()=>(V==null?void 0:V.disabled.value)||i.disabled),F=z(()=>V.group.items.value.reduce((M,h,G)=>(V.group.selected.value.includes(h.id)&&M.push(G),M),[])),B=z(()=>{const M=V.group.items.value.findIndex(h=>h.id===V.id);return!V.isSelected.value&&F.value.some(h=>h-M===1)}),j=z(()=>{const M=V.group.items.value.findIndex(h=>h.id===V.id);return!V.isSelected.value&&F.value.some(h=>h-M===-1)});return Ge(No,V),Ao(()=>{const M=!!(r.text||i.text),h=!!(r.title||i.title),G=ce.filterProps(i),T=se.filterProps(i);return a(i.tag,{class:["v-expansion-panel",{"v-expansion-panel--active":V.isSelected.value,"v-expansion-panel--before-active":B.value,"v-expansion-panel--after-active":j.value,"v-expansion-panel--disabled":c.value},S.value,w.value,i.class],style:[g.value,i.style]},{default:()=>[a("div",{class:["v-expansion-panel__shadow",...y.value]},null),a(Do,{defaults:{VExpansionPanelTitle:{...G},VExpansionPanelText:{...T}}},{default:()=>{var X;return[h&&a(ce,{key:"title"},{default:()=>[r.title?r.title():i.title]}),M&&a(se,{key:"text"},{default:()=>[r.text?r.text():i.text]}),(X=r.default)==null?void 0:X.call(r)]}})]})}),{groupItem:V}}}),ka=["default","accordion","inset","popout"],Da=xo({flat:Boolean,...Ye(),...We(Ae(),["bgColor","collapseIcon","color","eager","elevation","expandIcon","focusable","hideActions","readonly","ripple","rounded","tile","static"]),...be(),...To(),...Uo(),variant:{type:String,default:"default",validator:i=>ka.includes(i)}},"VExpansionPanels"),Ol=Po()({name:"VExpansionPanels",props:Da(),emits:{"update:modelValue":i=>!0},setup(i,I){let{slots:r}=I;const{next:V,prev:w}=He(i,No),{themeClasses:g}=_e(i),y=z(()=>i.variant&&`v-expansion-panels--variant-${i.variant}`);return Ve({VExpansionPanel:{bgColor:eo(i,"bgColor"),collapseIcon:eo(i,"collapseIcon"),color:eo(i,"color"),eager:eo(i,"eager"),elevation:eo(i,"elevation"),expandIcon:eo(i,"expandIcon"),focusable:eo(i,"focusable"),hideActions:eo(i,"hideActions"),readonly:eo(i,"readonly"),ripple:eo(i,"ripple"),rounded:eo(i,"rounded"),static:eo(i,"static")}}),Ao(()=>a(i.tag,{class:["v-expansion-panels",{"v-expansion-panels--flat":i.flat,"v-expansion-panels--tile":i.tile},g.value,y.value,i.class],style:i.style},{default:()=>{var S;return[(S=r.default)==null?void 0:S.call(r,{prev:w,next:V})]}})),{next:V,prev:w}}}),Na={class:"canvas-container"};const Ho=800,Wo=500,de=50,Ta={__name:"ArmadorUniversal",props:{ancho:{type:Number,default:2e3},alto:{type:Number,default:2e3},colorMarco:{type:String,default:"blanco"},configuracionInicial:{type:Object,default:null},tiposVentana:{type:Array,default:()=>[]}},emits:["guardar","cancelar"],setup(i,{expose:I,emit:r}){const V=i,w=r,g=k({ancho:V.ancho,alto:V.alto,perfilMarcoId:null,perfilDivisorHorizontalId:null,perfilDivisorVerticalId:null,secciones:[{tipo:"vacio",tipoVentanaId:null,orientacion:null,subsecciones:[],porcentaje:100}]}),y=k([]),S=k([]),c=k(null),F=k(0),B={width:Ho,height:Wo},j=z(()=>{const x=Ho-de*2,s=Wo-de*2,D=x/g.value.ancho,q=s/g.value.alto;return Math.min(D,q,1)*.9}),M=z(()=>30),h=z(()=>g.value.ancho*j.value),G=z(()=>g.value.alto*j.value),T=z(()=>h.value-M.value*2),X=z(()=>G.value-M.value*2),E=z(()=>({x:(Ho-h.value)/2,y:(Wo-G.value)/2})),lo=z(()=>({x:0,y:0,width:h.value,height:G.value,fill:"#D0D0D0",stroke:"#333",strokeWidth:2}));he(async()=>{try{const s=(await J.get("/api/productos")).data;y.value=s.filter(D=>[3,4,5].includes(D.tipo_producto_id)),S.value=s.filter(D=>[3,4,5].includes(D.tipo_producto_id)),console.log("âœ… Perfiles cargados:",{marcos:y.value.length,divisores:S.value.length})}catch(x){console.error("âŒ Error cargando perfiles:",x)}V.configuracionInicial&&(g.value={...g.value,...V.configuracionInicial})});function ro(x){x.target===x.target.getStage()&&(c.value=null)}function H(x){console.log("ğŸ¯ SecciÃ³n seleccionada:",x),c.value=x}function v({path:x,orientacion:s}){console.log("âœ‚ï¸ Dividir secciÃ³n:",x,"orientaciÃ³n:",s),no(x,s)}function P({path:x,tipoVentanaId:s}){console.log("ğŸªŸ Asignar tipo ventana:",s,"a secciÃ³n:",x),Co(x,s)}function C(x){console.log("ğŸ—‘ï¸ Eliminar secciÃ³n:",x),uo(x)}function Q(x){var q;const s=x.split(".").map(Number);let D=g.value.secciones;for(let mo=0;mo<s.length;mo++){const ho=s[mo];if(mo===s.length-1)return D[ho];D=((q=D[ho])==null?void 0:q.subsecciones)||[]}return null}function no(x,s){const D=Q(x);if(!D)return;const q=100;if((s==="horizontal"?g.value.alto:g.value.ancho)<q*2){alert(`La secciÃ³n es muy pequeÃ±a para dividir. MÃ­nimo ${q*2}mm en direcciÃ³n ${s}.`);return}D.tipo="compuesta",D.orientacion=s,D.subsecciones=[{tipo:"vacio",tipoVentanaId:null,orientacion:null,subsecciones:[],porcentaje:50},{tipo:"vacio",tipoVentanaId:null,orientacion:null,subsecciones:[],porcentaje:50}],F.value++}function Co(x,s){const D=Q(x);D&&(D.tipo="ventana",D.tipoVentanaId=s,D.subsecciones=[],F.value++)}function uo(x){const s=x.split(".").map(Number);if(s.length===1){alert('No se puede eliminar la secciÃ³n raÃ­z. Usa "Reiniciar" para comenzar de nuevo.');return}let D=g.value.secciones;for(let q=0;q<s.length-1;q++)D=D[s[q]].subsecciones;if(D.splice(s[s.length-1],1),D.length===1){const q=Q(s.slice(0,-1).join("."));q&&Object.assign(q,D[0])}c.value=null,F.value++}function po(x){c.value&&no(c.value,x)}function bo(x){c.value&&Co(c.value,x)}function io(){c.value&&uo(c.value)}function Z(){confirm("Â¿EstÃ¡s seguro de reiniciar el armador? Se perderÃ¡n todos los cambios.")&&(g.value.secciones=[{tipo:"vacio",tipoVentanaId:null,orientacion:null,subsecciones:[],porcentaje:100}],c.value=null,F.value++)}function Bo(){console.log("ğŸ“¤ Exportando configuraciÃ³n:",g.value),w("guardar",g.value)}return I({getConfiguracion:()=>g.value,setConfiguracion:x=>{g.value={...g.value,...x},F.value++}}),(x,s)=>{const D=go("v-rect"),q=go("v-group"),mo=go("v-layer"),ho=go("v-stage");return b(),N(_o,{class:"pa-4"},{default:t(()=>[a(Io,{class:"d-flex align-center"},{default:t(()=>[a(L,{left:""},{default:t(()=>s[8]||(s[8]=[p("mdi-window-maximize")])),_:1}),s[9]||(s[9]=p(" Armador Universal de Ventanas "))]),_:1}),a(fo,{class:"my-3"}),a(co,{dense:"",class:"mb-4"},{default:t(()=>[a($,{cols:"12",md:"3"},{default:t(()=>[a(vo,{modelValue:g.value.ancho,"onUpdate:modelValue":s[0]||(s[0]=O=>g.value.ancho=O),modelModifiers:{number:!0},label:"Ancho Total (mm)",type:"number",density:"compact",variant:"outlined",min:"100"},null,8,["modelValue"])]),_:1}),a($,{cols:"12",md:"3"},{default:t(()=>[a(vo,{modelValue:g.value.alto,"onUpdate:modelValue":s[1]||(s[1]=O=>g.value.alto=O),modelModifiers:{number:!0},label:"Alto Total (mm)",type:"number",density:"compact",variant:"outlined",min:"100"},null,8,["modelValue"])]),_:1}),a($,{cols:"12",md:"6"},{default:t(()=>[a(qo,{modelValue:g.value.perfilMarcoId,"onUpdate:modelValue":s[2]||(s[2]=O=>g.value.perfilMarcoId=O),items:y.value,"item-title":"nombre","item-value":"id",label:"Perfil del Marco",density:"compact",variant:"outlined",clearable:""},{item:t(({props:O,item:oo})=>[a(Mo,zo(jo(O)),{prepend:t(()=>[a(L,null,{default:t(()=>s[10]||(s[10]=[p("mdi-border-all")])),_:1})]),default:t(()=>[a(wo,null,{default:t(()=>[p(R(oo.raw.nombre),1)]),_:2},1024),a(Ro,null,{default:t(()=>[p("CÃ³digo: "+R(oo.raw.codigo),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items"])]),_:1})]),_:1}),a(co,{dense:"",class:"mb-4"},{default:t(()=>[a($,{cols:"12",md:"6"},{default:t(()=>[a(qo,{modelValue:g.value.perfilDivisorHorizontalId,"onUpdate:modelValue":s[3]||(s[3]=O=>g.value.perfilDivisorHorizontalId=O),items:S.value,"item-title":"nombre","item-value":"id",label:"Perfil Divisor Horizontal",density:"compact",variant:"outlined",clearable:""},{item:t(({props:O,item:oo})=>[a(Mo,zo(jo(O)),{prepend:t(()=>[a(L,null,{default:t(()=>s[11]||(s[11]=[p("mdi-minus")])),_:1})]),default:t(()=>[a(wo,null,{default:t(()=>[p(R(oo.raw.nombre),1)]),_:2},1024),a(Ro,null,{default:t(()=>[p("CÃ³digo: "+R(oo.raw.codigo),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items"])]),_:1}),a($,{cols:"12",md:"6"},{default:t(()=>[a(qo,{modelValue:g.value.perfilDivisorVerticalId,"onUpdate:modelValue":s[4]||(s[4]=O=>g.value.perfilDivisorVerticalId=O),items:S.value,"item-title":"nombre","item-value":"id",label:"Perfil Divisor Vertical",density:"compact",variant:"outlined",clearable:""},{item:t(({props:O,item:oo})=>[a(Mo,zo(jo(O)),{prepend:t(()=>[a(L,null,{default:t(()=>s[12]||(s[12]=[p("mdi-slash-forward")])),_:1})]),default:t(()=>[a(wo,null,{default:t(()=>[p(R(oo.raw.nombre),1)]),_:2},1024),a(Ro,null,{default:t(()=>[p("CÃ³digo: "+R(oo.raw.codigo),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items"])]),_:1})]),_:1}),a(fo,{class:"my-3"}),K("div",Na,[a(ho,{config:B,onMousedown:ro},{default:t(()=>[a(mo,null,{default:t(()=>[a(D,{config:{x:0,y:0,width:B.width,height:B.height,fill:"#f5f5f5",stroke:"#ddd",strokeWidth:1}},null,8,["config"]),a(q,{config:E.value},{default:t(()=>[a(D,zo(jo(lo.value)),null,16),(b(!0),to(Vo,null,Lo(g.value.secciones,(O,oo)=>(b(),N(Sa,{key:`seccion-${oo}-${F.value}`,seccion:O,x:M.value,y:M.value,"ancho-disponible":T.value,"alto-disponible":X.value,escala:j.value,nivel:0,path:`${oo}`,"path-seleccionado":c.value,"tipos-ventana":i.tiposVentana,"perfil-divisor-h":g.value.perfilDivisorHorizontalId,"perfil-divisor-v":g.value.perfilDivisorVerticalId,onSeleccionar:H,onDividir:v,onAsignarTipo:P,onEliminar:C},null,8,["seccion","x","y","ancho-disponible","alto-disponible","escala","path","path-seleccionado","tipos-ventana","perfil-divisor-h","perfil-divisor-v"]))),128))]),_:1},8,["config"])]),_:1})]),_:1})]),c.value?(b(),N(_o,{key:0,variant:"tonal",class:"mt-4 pa-3"},{default:t(()=>[a(So,{class:"d-flex align-center justify-space-between"},{default:t(()=>[K("span",null,[a(L,{left:""},{default:t(()=>s[13]||(s[13]=[p("mdi-cursor-default-click")])),_:1}),p(" SecciÃ³n seleccionada: "+R(c.value),1)]),a(W,{size:"small",icon:"",onClick:s[5]||(s[5]=O=>c.value=null)},{default:t(()=>[a(L,null,{default:t(()=>s[14]||(s[14]=[p("mdi-close")])),_:1})]),_:1})]),_:1}),a(co,{dense:"",class:"mt-2"},{default:t(()=>[a($,{cols:"6",md:"3"},{default:t(()=>[a(W,{block:"",color:"primary",variant:"tonal",onClick:s[6]||(s[6]=O=>po("horizontal"))},{default:t(()=>[a(L,{left:""},{default:t(()=>s[15]||(s[15]=[p("mdi-arrow-split-horizontal")])),_:1}),s[16]||(s[16]=p(" Dividir Horizontal "))]),_:1})]),_:1}),a($,{cols:"6",md:"3"},{default:t(()=>[a(W,{block:"",color:"primary",variant:"tonal",onClick:s[7]||(s[7]=O=>po("vertical"))},{default:t(()=>[a(L,{left:""},{default:t(()=>s[17]||(s[17]=[p("mdi-arrow-split-vertical")])),_:1}),s[18]||(s[18]=p(" Dividir Vertical "))]),_:1})]),_:1}),a($,{cols:"12",md:"4"},{default:t(()=>{var O;return[a(ko,{"model-value":(O=Q(c.value))==null?void 0:O.tipoVentanaId,items:i.tiposVentana,"item-title":"nombre","item-value":"id",label:"Asignar Tipo de Ventana",density:"compact",variant:"outlined","onUpdate:modelValue":bo},null,8,["model-value","items"])]}),_:1}),a($,{cols:"12",md:"2"},{default:t(()=>[a(W,{block:"",color:"error",variant:"tonal",onClick:io},{default:t(()=>[a(L,{left:""},{default:t(()=>s[19]||(s[19]=[p("mdi-delete")])),_:1}),s[20]||(s[20]=p(" Eliminar "))]),_:1})]),_:1})]),_:1})]),_:1})):ao("",!0),a(ye,{class:"mt-4"},{default:t(()=>[a(W,{color:"secondary",variant:"outlined",onClick:Z},{default:t(()=>[a(L,{left:""},{default:t(()=>s[21]||(s[21]=[p("mdi-refresh")])),_:1}),s[22]||(s[22]=p(" Reiniciar "))]),_:1}),a(Ce),a(W,{color:"primary",onClick:Bo},{default:t(()=>[a(L,{left:""},{default:t(()=>s[23]||(s[23]=[p("mdi-check")])),_:1}),s[24]||(s[24]=p(" Aplicar ConfiguraciÃ³n "))]),_:1})]),_:1}),ao("",!0)]),_:1})}}},$a=Ko(Ta,[["__scopeId","data-v-933c13a9"]]),za=xo({text:String,...To(),...Uo()},"VToolbarTitle"),Ee=Po()({name:"VToolbarTitle",props:za(),setup(i,I){let{slots:r}=I;return Ao(()=>{const V=!!(r.default||r.text||i.text);return a(i.tag,{class:["v-toolbar-title",i.class],style:i.style},{default:()=>{var w;return[V&&a("div",{class:"v-toolbar-title__placeholder"},[r.text?r.text():i.text,(w=r.default)==null?void 0:w.call(r)])]}})}),{}}}),ja=[null,"prominent","default","comfortable","compact"],Oa=xo({absolute:Boolean,collapse:Boolean,color:String,density:{type:String,default:"default",validator:i=>ja.includes(i)},extended:Boolean,extensionHeight:{type:[Number,String],default:48},flat:Boolean,floating:Boolean,height:{type:[Number,String],default:64},image:String,title:String,...Qe(),...To(),...ge(),...ve(),...Uo({tag:"header"}),...be()},"VToolbar"),Ma=Po()({name:"VToolbar",props:Oa(),setup(i,I){var h;let{slots:r}=I;const{backgroundColorClasses:V,backgroundColorStyles:w}=Jo(eo(i,"color")),{borderClasses:g}=Je(i),{elevationClasses:y}=me(i),{roundedClasses:S}=fe(i),{themeClasses:c}=_e(i),{rtlClasses:F}=Ke(),B=Xe(!!(i.extended||(h=r.extension)!=null&&h.call(r))),j=z(()=>parseInt(Number(i.height)+(i.density==="prominent"?Number(i.height):0)-(i.density==="comfortable"?8:0)-(i.density==="compact"?16:0),10)),M=z(()=>B.value?parseInt(Number(i.extensionHeight)+(i.density==="prominent"?Number(i.extensionHeight):0)-(i.density==="comfortable"?4:0)-(i.density==="compact"?8:0),10):0);return Ve({VBtn:{variant:"text"}}),Ao(()=>{var E;const G=!!(i.title||r.title),T=!!(r.image||i.image),X=(E=r.extension)==null?void 0:E.call(r);return B.value=!!(i.extended||X),a(i.tag,{class:["v-toolbar",{"v-toolbar--absolute":i.absolute,"v-toolbar--collapse":i.collapse,"v-toolbar--flat":i.flat,"v-toolbar--floating":i.floating,[`v-toolbar--density-${i.density}`]:!0},V.value,g.value,y.value,S.value,c.value,F.value,i.class],style:[w.value,i.style]},{default:()=>[T&&a("div",{key:"image",class:"v-toolbar__image"},[r.image?a(Do,{key:"image-defaults",disabled:!i.image,defaults:{VImg:{cover:!0,src:i.image}}},r.image):a(Aa,{key:"image-img",cover:!0,src:i.image},null)]),a(Do,{defaults:{VTabs:{height:Oo(j.value)}}},{default:()=>{var lo,ro,H;return[a("div",{class:"v-toolbar__content",style:{height:Oo(j.value)}},[r.prepend&&a("div",{class:"v-toolbar__prepend"},[(lo=r.prepend)==null?void 0:lo.call(r)]),G&&a(Ee,{key:"title",text:i.title},{text:r.title}),(ro=r.default)==null?void 0:ro.call(r),r.append&&a("div",{class:"v-toolbar__append"},[(H=r.append)==null?void 0:H.call(r)])])]}}),a(Do,{defaults:{VTabs:{height:Oo(M.value)}}},{default:()=>[a(Yo,null,{default:()=>[B.value&&a("div",{class:"v-toolbar__extension",style:{height:Oo(M.value)}},[X])]})]})]})}),{contentHeight:j,extensionHeight:M}}}),wa={style:{position:"relative"}},Ra={class:"font-weight-medium"},La={key:0,class:"text-caption text-grey"},Ua={class:"d-flex justify-end"},Ba={key:3,class:"mt-6"},Fa=.45,qa={__name:"index",setup(i){const I=k([]),r=k([]),V=oa(),w=Ze(),g=k(!1),y=k(null),S=z(()=>{const n={};for(const e of r.value)n[Number(e.id)]=e.nombre;return n}),c=te({cliente_id:null,observaciones:"",material:"",color:"",tipoVidrio:"",productoVidrioProveedor:"",ventanas:[],productos:[]}),F=[{id:1,nombre:"Fija"},{id:2,nombre:"Proyectante"},{id:3,nombre:"Corredera"}];k({});const B=k(!1),j=te({cliente:null}),M=k([]),h=k([]),G=k([]),T=k([]),X=k([]),E=k([]),lo=k(!1),ro=k(null),H=k(""),v=k(!1);k("");const P=k(!1);k(0);const C=k({razon_social:"",identification:"",email:"",phone:"",address:"",ciudad:"",comuna:"",giro:""});z(()=>T.value.flatMap(n=>!n.colores_por_proveedor||!Array.isArray(n.colores_por_proveedor)?[]:n.colores_por_proveedor.map(e=>{var o;return{id:`${n.id}-${e.proveedor_id}`,producto_id:n.id,proveedor_id:e.proveedor_id,nombre:`${n.nombre} (${((o=e.proveedor)==null?void 0:o.nombre)||"Proveedor desconocido"})`}})));const Q=z(()=>{const n=c.tipoVidrio;return T.value.filter(e=>e.tipo_producto_id===n).flatMap(e=>!e.colores_por_proveedor||!Array.isArray(e.colores_por_proveedor)?[]:e.colores_por_proveedor.map(o=>{var l;return{id:o.id,producto_id:e.id,proveedor_id:o.proveedor_id,nombre:`${e.nombre} (${((l=o.proveedor)==null?void 0:l.nombre)||"Proveedor desconocido"})`}}))});he(async()=>{var n;console.log("ï¿½ğŸš€ğŸš€ ARCHIVO INDEX.VUE CARGADO"),console.log("ğŸ”„ Iniciando carga de datos..."),w.query.id&&(g.value=!0,y.value=w.query.id,console.log("ğŸ“ MODO EDICIÃ“N activado - ID:",y.value));try{const[e,o,l,m,f]=await Promise.all([J.get("/api/tipos_material"),J.get("/api/colores"),J.get("/api/tipos_producto"),J.get("/api/productos"),J.get("/api/tipos_ventana")]);if(console.log("âœ… Datos bÃ¡sicos cargados"),M.value=e.data,h.value=o.data,G.value=l.data.filter(_=>[1,2].includes(_.id)),T.value=m.data.filter(_=>[1,2].includes(_.tipo_producto_id)),console.log("ğŸ“¦ PRODUCTOS DE VIDRIO CARGADOS:",T.value.length),console.log("ğŸ“¦ Primer producto:",T.value[0]),T.value[0]){console.log("   - Tiene colores_por_proveedor?",!!T.value[0].colores_por_proveedor),console.log("   - Es array?",Array.isArray(T.value[0].colores_por_proveedor)),console.log("   - Cantidad:",(n=T.value[0].colores_por_proveedor)==null?void 0:n.length);const _=T.value.flatMap(A=>(A.colores_por_proveedor||[]).map(d=>d.id));console.log("   - IDs disponibles:",_),console.log("   - Â¿Incluye ID 64?:",_.includes(64)),console.log("   - Â¿Incluye ID 2?:",_.includes(2))}T.value.length>0&&(console.log("ğŸ“¦ ESTRUCTURA COMPLETA DEL PRIMER PRODUCTO:"),console.log(JSON.stringify(T.value[0],null,2))),r.value=f.data,console.log("TIPOS VENTANA CARGADOS:",r.value.length),console.log("ğŸ” Mapa de tipos ventana:",r.value.map(_=>`${_.id}: ${_.nombre}`)),console.log("ğŸ”„ Cargando primeros clientes..."),je(),g.value&&await Co(),document.addEventListener("click",_=>{const A=_.target;!A.closest(".v-text-field")&&!A.closest(".v-card")&&(v.value=!1)})}catch(e){console.error("âŒ Error cargando datos:",e),alert("Error cargando datos: "+e.message)}});const no=n=>(n=parseInt(n),T.value.flatMap(e=>!e.colores_por_proveedor||!Array.isArray(e.colores_por_proveedor)?[]:e.colores_por_proveedor.map(o=>({id:o.id,producto_id:e.id,proveedor_id:o.proveedor_id}))).find(e=>e.id===n)),Co=async()=>{try{console.log("ğŸ“¥ Cargando cotizaciÃ³n ID:",y.value);const e=(await J.get(`/api/cotizaciones/${y.value}`)).data;console.log("âœ… CotizaciÃ³n cargada:",e),console.log("ğŸ“¦ DETALLES COMPLETOS:",e.detalles),e.cliente&&(j.cliente=e.cliente,c.cliente_id=e.cliente.id,H.value=e.cliente.razon_social),c.observaciones=e.observaciones||"",e.ventanas&&e.ventanas.length>0&&(c.ventanas=e.ventanas.map(o=>{console.log("ğŸ”„ Mapeando ventana desde BD - DATOS COMPLETOS:",JSON.stringify(o,null,2)),console.log("ğŸ”„ tipo_ventana_id:",o.tipo_ventana_id),console.log("ğŸ”„ material_id:",o.material_id),console.log("ğŸ”„ color_id:",o.color_id),console.log("ğŸ”„ tipo_vidrio_id:",o.tipo_vidrio_id),console.log("ğŸ”„ producto_vidrio_proveedor_id:",o.producto_vidrio_proveedor_id);let l=o.material_id,m=o.tipo_vidrio_id;if(console.log("ğŸ”§ Valores originales - material_id:",o.material_id,"tipo_vidrio_id:",o.tipo_vidrio_id),!m&&o.producto_vidrio_proveedor_id){const A=parseInt(o.producto_vidrio_proveedor_id);console.log("ğŸ”§ Buscando ID:",A);for(const d of T.value)if(d.colores_por_proveedor){for(const U of d.colores_por_proveedor)if(parseInt(U.id)===A){m=d.tipo_producto_id,console.log("âœ… ENCONTRADO! Producto:",d.nombre,"â†’ tipo_producto_id:",m);break}if(m)break}m||console.log("âŒ ID",A,"no encontrado en ningÃºn producto")}if(!l&&o.tipo_ventana_id){console.log("ğŸ”§ Intentando inferir material..."),console.log("ğŸ”§ tiposVentanaTodos.value disponibles:",r.value.length),console.log("ğŸ”§ Buscando tipo_ventana_id:",o.tipo_ventana_id);const A=r.value.find(d=>d.id===o.tipo_ventana_id);console.log("ğŸ”§ Tipo de ventana encontrado:",A),A?(l=A.material_id,console.log("âœ… material inferido:",l,"desde tipo ventana:",A.nombre)):console.log("âŒ No se encontrÃ³ el tipo de ventana con ID:",o.tipo_ventana_id)}console.log("ğŸ”§ Valores finales - materialInferido:",l,"tipoVidrioInferido:",m);const f=no(o.producto_vidrio_proveedor_id),_={tipo:o.tipo_ventana_id,ancho:o.ancho,alto:o.alto,cantidad:o.cantidad||1,material:l,color:o.color_id,tipoVidrio:m,productoVidrioProveedor:o.producto_vidrio_proveedor_id,productoVidrio:f==null?void 0:f.producto_id,proveedorVidrio:f==null?void 0:f.proveedor_id,costo:o.costo||0,costo_unitario:o.costo_unitario||0,costo_total:o.costo||0,precio:o.precio||0,precio_unitario:o.precio_unitario||0,hojas_totales:o.hojas_totales,hojas_moviles:o.hojas_moviles,materiales:o.materiales||[],tipoVentanaIzquierda:o.tipo_ventana_izquierda,tipoVentanaCentro:o.tipo_ventana_centro,tipoVentanaDerecha:o.tipo_ventana_derecha,ancho_izquierda:o.ancho_izquierda,ancho_centro:o.ancho_centro,ancho_derecha:o.ancho_derecha,id:o.id};return console.log("ğŸ”„ Ventana mapeada:",_),console.log("ğŸ”„ tipoVidrio en ventana mapeada:",_.tipoVidrio),_}),console.log("âœ… Ventanas cargadas:",c.ventanas.length)),e.detalles&&e.detalles.length>0&&(c.productos=e.detalles.filter(o=>o.tipo_item==="producto").map(o=>{console.log("ğŸ“¦ Detalle del producto:",o);const l=o.producto_lista||o.productoLista||{},m=o.lista_precio||o.listaPrecio||{},f=l.tipo_producto||l.tipoProducto||{},_=l.unidad||{};return{id:o.id,producto_lista_id:o.producto_lista_id,lista_precio_id:o.lista_precio_id,descripcion:o.descripcion,cantidad:o.cantidad,precio_venta:o.precio_unitario,total:o.total,codigo:l.codigo||"",nombre:l.nombre||o.descripcion,tipo:f.nombre||"",unidad:_.nombre||_.simbolo||"",precio_costo:m.precio_costo||0,margen:m.margen||0}}),console.log("âœ… Productos cargados:",c.productos.length),console.log("ğŸ“¦ Primer producto mapeado:",c.productos[0]))}catch(n){console.error("âŒ Error cargando cotizaciÃ³n:",n),alert("Error al cargar la cotizaciÃ³n"),V.push({name:"cotizaciones"})}},uo=k(!1),po=k(!1),bo=k(!1),io=k(!1),Z=k(null),Bo=[{title:"Tipo",key:"tipo"},{title:"Ancho",key:"ancho"},{title:"Alto",key:"alto"},{title:"Cantidad",key:"cantidad"},{title:"Precio",key:"precio",align:"end"},{title:"Acciones",key:"acciones",sortable:!1}],x=[{title:"CÃ³digo",key:"codigo"},{title:"Nombre",key:"nombre"},{title:"Color",key:"color"},{title:"Proveedor",key:"proveedor"},{title:"Tipo",key:"tipo_producto"},{title:"Unidad",key:"unidad"},{title:"Cantidad",key:"cantidad"},{title:"Precio Costo",key:"precio_costo",align:"end"},{title:"Precio Venta",key:"precio_venta",align:"end"},{title:"Acciones",key:"acciones",sortable:!1}],s=()=>{console.log("â• ABRIENDO MODAL PARA NUEVA VENTANA"),console.log("â• productosVidrio disponibles:",T.value.length),Z.value=null,uo.value=!0},D=()=>{bo.value=!bo.value},q=()=>{io.value=!0},mo=n=>{console.log("ğŸ”§ EDITANDO VENTANA - Ãndice:",n);const e=c.ventanas[n];console.log("ğŸ”§ Datos originales de la ventana:",e);const o={...e,index:n};if(!o.tipoVidrio&&o.productoVidrioProveedor){const l=parseInt(o.productoVidrioProveedor);console.log("ğŸ” Buscando tipoVidrio para producto ID:",l);for(const m of T.value)if(m.colores_por_proveedor&&m.colores_por_proveedor.find(_=>parseInt(_.id)===l)){o.tipoVidrio=m.tipo_producto_id,console.log("âœ… tipoVidrio inferido:",o.tipoVidrio);break}}if(!o.material&&o.tipo){const l=r.value.find(m=>parseInt(m.id)===parseInt(o.tipo));l&&l.material_id&&(o.material=l.material_id,console.log("âœ… material_id inferido:",o.material))}console.log("âœ… Ventana COMPLETA preparada:",o),console.log("âœ… tipoVidrio final:",o.tipoVidrio),console.log("âœ… material final:",o.material),console.log("âœ… productoVidrioProveedor final:",o.productoVidrioProveedor),Z.value=o,po.value=!0},ho=n=>{console.log("ğŸ’¾ VENTANA RECIBIDA DEL MODAL:",n),console.log("ğŸ’¾ tipoVidrio en ventana recibida:",n.tipoVidrio),console.log("ğŸ’¾ productoVidrioProveedor en ventana recibida:",n.productoVidrioProveedor),console.log("ğŸ’¾ color en ventana recibida:",n.color),console.log("ğŸ’¾ tipo en ventana recibida:",n.tipo),n.index!==void 0?c.ventanas[n.index]={...n}:c.ventanas.push({...n}),console.log("ğŸ’¾ Ventana guardada en cotizacion.ventanas:",c.ventanas[c.ventanas.length-1]),uo.value=!1},O=n=>{console.log("ğŸ“¦ PRODUCTOS RECIBIDOS DEL MODAL:",n),n.forEach(e=>{var l,m,f,_,A,d,U;const o={producto_lista_id:e.producto_lista_id,lista_precio_id:e.lista_precio_id,nombre:e.nombre||((l=e.producto)==null?void 0:l.nombre),codigo:e.codigo||((m=e.producto)==null?void 0:m.codigo_proveedor),color:e.color||"-",proveedor:e.proveedor||"-",tipo_producto:e.tipo||((_=(f=e.producto)==null?void 0:f.tipoProducto)==null?void 0:_.nombre)||"-",unidad:e.unidad||((d=(A=e.producto)==null?void 0:A.unidad)==null?void 0:d.abreviacion)||"-",cantidad:e.cantidad,precio_costo:e.precio_costo,margen:e.margen,precio_venta:e.precio_venta,descripcion:e.descripcion||e.nombre||((U=e.producto)==null?void 0:U.nombre)||"",total:e.precio_venta*e.cantidad,esVidrio:e.esVidrio||!1,ancho_mm:e.ancho_mm||null,alto_mm:e.alto_mm||null,m2:e.m2||null,pulido:e.pulido||!1};console.log("âœ… PRODUCTO AGREGADO A COTIZACIÃ“N:",o),c.productos.push(o)})},oo=n=>{c.productos.splice(n,1)},Xo=n=>new Intl.NumberFormat("es-CL").format(n||0),Ie=n=>{c.ventanas.splice(n,1)},Se=le(async(n,e)=>{if(!n.productoVidrio||!n.proveedorVidrio){console.warn("âš ï¸ Faltan datos en el payload para calcular materiales:",n);return}try{const o=await J.post("/api/cotizador/calcular-materiales",n);e.costo_unitario=o.data.costo_unitario;const l=Number(e.cantidad)>0?Number(e.cantidad):1;e.costo_total=o.data.costo_unitario*l;const m=Math.ceil(o.data.costo_unitario/(1-Fa));e.precio_unitario=m,e.precio=m*l,e.materiales=o.data.materiales}catch(o){console.error("âŒ Error al calcular materiales",o),e.costo_total=0,e.materiales=[]}},1e3);Fo(()=>c.ventanas,n=>{n.forEach(e=>{Fo(()=>[e.tipo,e.ancho,e.alto,e.cantidad,e.material,e.color,e.tipoVidrio,e.productoVidrioProveedor,e.hojas_totales,e.hojas_moviles],()=>{const o=[];e.tipo||o.push("tipo_ventana_id faltante"),e.ancho||o.push("ancho faltante"),e.alto||o.push("alto faltante"),(!e.cantidad||e.cantidad<=0)&&o.push("cantidad invÃ¡lida"),e.productoVidrioProveedor||o.push("productoVidrioProveedor faltante");const l=no(e.productoVidrioProveedor);if(l||o.push(`relaciÃ³n producto-proveedor no encontrada (ID: ${e.productoVidrioProveedor})`),o.length>0){console.log(`â„¹ï¸ Esperando datos completos para recalcular ventana (tipo ${e.tipo}):`,o.join(", "));return}const m={...e,productoVidrio:l.producto_id,proveedorVidrio:l.proveedor_id,hojas_moviles:e.tipo===3||e.tipo===46?e.hojas_moviles:void 0};console.log("âœ… Recalculando ventana:",m),Se(m,e)},{deep:!0,immediate:!1})})},{deep:!0}),Fo(()=>j.cliente,n=>{console.log("âœ… Cliente seleccionado:",n),n&&(console.log("âœ… Nombre:",n.razon_social),console.log("âœ… RUT:",n.identification))});const ke=()=>{P.value=!0},De=async()=>{var e,o;const n=(e=H.value)==null?void 0:e.trim();if(console.log("ğŸ” BÃšSQUEDA LOCAL:",n),j.cliente&&n!==j.cliente.razon_social&&(j.cliente=null,c.cliente_id=null),!n||n.length<2){E.value=[],v.value=!1;return}lo.value=!0,v.value=!0;try{const l=await J.get(`/api/clientes/buscar?q=${encodeURIComponent(n)}`);console.log("âœ… RESPUESTA LOCAL:",l.data),((o=l.data)==null?void 0:o.length)>0?(E.value=l.data.map(m=>({id:m.id,razon_social:m.razon_social||`${m.first_name||""} ${m.last_name||""}`.trim()||"Sin nombre",identification:m.identification||"",email:m.email||"",phone:m.phone||""})),console.log("âœ… CLIENTES PROCESADOS:",E.value),v.value=!0):(E.value=[],v.value=!1,console.log("âŒ NO HAY CLIENTES"))}catch(l){console.error("âŒ ERROR:",l),E.value=[],v.value=!1}finally{lo.value=!1}},Ne=n=>{console.log("âœ… CLIENTE SELECCIONADO:",n),j.cliente=n,c.cliente_id=n.id,H.value=n.razon_social,v.value=!1,E.value=[]},Te=()=>{E.value.length>0&&(v.value=!0)},$e=()=>{H.value="",E.value=[],v.value=!1,j.cliente=null},ze=async()=>{var n,e;try{console.log("ğŸ’¾ Guardando cliente local:",C.value);const o=await J.post("/api/clientes",C.value);console.log("âœ… Respuesta completa:",o.data);const l=o.data.cliente||o.data;console.log("âœ… Cliente creado:",l),E.value.push(l),j.cliente=l,c.cliente_id=l.id,H.value=l.razon_social,v.value=!1,E.value=[],P.value=!1,C.value={razon_social:"",identification:"",email:"",phone:"",address:"",ciudad:""},console.log("âœ… Cliente seleccionado:",j.cliente),console.log("âœ… Cliente ID asignado:",c.cliente_id),console.log("âœ… TÃ©rmino bÃºsqueda:",H.value),alert("âœ… Cliente creado y seleccionado exitosamente")}catch(o){console.error("âŒ Error al crear cliente:",o),alert("âŒ Error al crear cliente: "+(((e=(n=o.response)==null?void 0:n.data)==null?void 0:e.message)||o.message))}};le(async n=>{var e;if(n||(n=H.value),console.log("ğŸ” Buscando clientes con query:",n),!n||n.length<2){E.value=X.value.slice(0,20),console.log("ğŸ“‹ Mostrando clientes iniciales:",E.value.length);return}lo.value=!0;try{console.log("ğŸŒ Buscando en API de Bsale...");const o=await J.get(`/api/bsale-clientes/buscar?q=${encodeURIComponent(n)}`);console.log("âœ… Respuesta de API:",o.data),o.data&&o.data.items&&o.data.items.length>0?(E.value=o.data.items.map(l=>{console.log("ğŸ” Procesando cliente:",l);let m="";l.company&&l.company.trim()?m=l.company.trim():l.firstName||l.lastName?m=`${l.firstName||""} ${l.lastName||""}`.trim():l.razon_social?m=l.razon_social:l.displayName?m=l.displayName:m="Cliente sin nombre",(!m||m.trim()==="")&&(m=`Cliente ID: ${l.id}`);const f={id:l.id,razon_social:m,identification:l.identification||"",email:l.email||"",phone:l.phone||"",address:l.address||"",city:l.city||"",municipality:l.municipality||"",first_name:l.firstName||"",last_name:l.lastName||"",company:l.company||"",tipo_cliente:l.companyOrPerson==1?"empresa":"persona"};return console.log("âœ… Cliente procesado:",f),f}),console.log("âœ… Total clientes procesados:",E.value.length),console.log("âœ… Lista final:",E.value),E.value.length>0&&(console.log("ğŸ” Primer cliente para autocomplete:",{id:E.value[0].id,razon_social:E.value[0].razon_social,hasId:!!E.value[0].id,hasTitle:!!E.value[0].razon_social}),setTimeout(()=>{ro.value&&ro.value.menu&&(console.log("ğŸ¯ Forzando apertura del menÃº..."),ro.value.menu=!0)},100))):(console.log("âŒ No se encontraron clientes en la respuesta"),E.value=[])}catch(o){console.error("âŒ Error en bÃºsqueda:",o),console.error("âŒ Detalles del error:",(e=o.response)==null?void 0:e.data),E.value=[]}finally{lo.value=!1}},300);const je=async()=>{var n;try{const e=await J.get("/api/bsale-clientes?limit=50&offset=0");console.log("âœ… Primeros clientes cargados:",e.data);const o=((n=e.data.items)==null?void 0:n.map(l=>({id:l.id,razon_social:l.razon_social||l.displayName||"Sin nombre",identification:l.identification,email:l.email,phone:l.phone,address:l.address,city:l.city,municipality:l.municipality,first_name:l.firstName,last_name:l.lastName,company:l.company,tipo_cliente:l.companyOrPerson==1?"empresa":"persona"})))||[];X.value=o,E.value=o.slice(0,20),console.log("âœ… Clientes iniciales listos:",X.value.length)}catch(e){console.error("âŒ Error cargando clientes iniciales:",e),E.value=[]}},Oe=async()=>{var e,o;await new Promise(l=>setTimeout(l,2e3));const n=[];console.log("ğŸ” INICIANDO CAPTURA DE IMÃGENES"),console.log("ğŸ” VENTANA REFS:",I.value),console.log("ğŸ” TOTAL VENTANAS:",c.ventanas.length);for(let l=0;l<c.ventanas.length;l++){const m=c.ventanas[l];console.log(`ğŸ” VENTANA ${l} - TIPO:`,m.tipo);try{const f=I.value[l];if(console.log(`ğŸ” COMPONENTE ${l}:`,f),console.log(`ğŸ” TIPO DE COMPONENTE ${l}:`,typeof f),console.log(`ğŸ” $el DE COMPONENTE ${l}:`,f==null?void 0:f.$el),console.log(`ğŸ” TIPO DE $el ${l}:`,typeof(f==null?void 0:f.$el)),f!=null&&f.exportarImagen&&typeof f.exportarImagen=="function"){console.log(`ğŸ”§ Usando exportarImagen() del componente ${l}`);try{const _=await f.exportarImagen();if(_&&_!==null){console.log(`âœ… IMAGEN ${l} CAPTURADA VIA exportarImagen:`,_.substring(0,50)),n.push(_);continue}else console.warn(`âš ï¸ exportarImagen() devolviÃ³ null para componente ${l}`)}catch(_){console.error(`âŒ Error en exportarImagen del componente ${l}:`,_)}}if(f!=null&&f.$el&&f.$el.nodeType===Node.ELEMENT_NODE&&typeof f.$el.querySelectorAll=="function"){console.log(`ğŸ” ELEMENTO DOM ${l} VÃLIDO:`,f.$el.tagName);const _=f.$el.querySelectorAll("canvas");console.log(`ğŸ” CANVAS ENCONTRADOS EN COMPONENTE ${l}:`,_.length);let A=null;for(let d=0;d<_.length;d++){const U=_[d];console.log(`ğŸ” CANVAS ${l}.${d} - DIMENSIONES:`,U.width,"x",U.height);try{const Eo=U.getContext("2d").getImageData(0,0,U.width,U.height).data.some($o=>$o!==0);if(console.log(`ğŸ” CANVAS ${l}.${d} - TIENE CONTENIDO:`,Eo),Eo){A=U;break}}catch(Y){console.error(`âŒ Error verificando canvas ${l}.${d}:`,Y)}}if(A){try{const U=(e=A.getStage)==null?void 0:e.call(A);U&&(console.log(`ğŸ”„ Forzando redibujado de Konva en ventana ${l}`),U.draw(),await new Promise(Y=>setTimeout(Y,500)))}catch{console.log(`â„¹ï¸ Ventana ${l} no es Konva`)}const d=A.toDataURL("image/png");console.log(`âœ… IMAGEN ${l} CAPTURADA VIA CANVAS:`,d.substring(0,50)),n.push(d)}else if(_.length>0){console.log("ğŸ”§ Usando primer canvas aunque estÃ© vacÃ­o...");try{const d=_[0].toDataURL("image/png");n.push(d)}catch(d){console.error("âŒ Error en toDataURL:",d),n.push(null)}}else console.warn(`âš ï¸ No se encontraron canvas en componente ${l}`),n.push(null)}else{console.warn(`âš ï¸ Componente ${l} no tiene $el vÃ¡lido o querySelectorAll`),console.log("ğŸ” Â¿$el existe?:",!!(f!=null&&f.$el)),console.log("ğŸ” Â¿Es Element?:",(f==null?void 0:f.$el)instanceof Element),console.log("ğŸ” Â¿Tiene querySelectorAll?:",typeof((o=f==null?void 0:f.$el)==null?void 0:o.querySelectorAll)),console.log("ğŸ”§ Ãšltimo recurso: buscando canvas globalmente...");const _=document.querySelectorAll("canvas");if(console.log("ğŸ” Canvas globales encontrados:",_.length),_.length>l)try{const A=_[l].toDataURL("image/png");console.log(`âœ… IMAGEN ${l} CAPTURADA VIA BÃšSQUEDA GLOBAL`),n.push(A)}catch(A){console.error("âŒ Error en canvas global:",A),n.push(null)}else n.push(null)}}catch(f){console.error(`âŒ ERROR GENERAL capturando imagen ${l}:`,f),n.push(null)}}return console.log("ğŸ–¼ï¸ RESULTADO FINAL:",n.map((l,m)=>`${m}: ${l?"OK":"NULL"}`)),n},Me=async()=>{var n,e,o;B.value=!0;try{const l=await Oe();console.log("ğŸ–¼ï¸ IMÃGENES CAPTURADAS:",l),console.log("ğŸ–¼ï¸ NÃšMERO DE IMÃGENES:",l.length),console.log("ğŸ–¼ï¸ PRIMERA IMAGEN (primeros 100 chars):",(n=l[0])==null?void 0:n.substring(0,100));const m=j.cliente;if(!m){alert("Debes seleccionar un cliente");return}const f=c.ventanas.length>0,_=c.productos&&c.productos.length>0;if(!f&&!_){alert("Debes agregar al menos una ventana o un producto a la cotizaciÃ³n");return}const A={cliente_id:m.id,vendedor_id:1,fecha:new Date().toISOString().split("T")[0],estado_cotizacion_id:c.estado_cotizacion_id??1,observaciones:c.observaciones,imagenes_ventanas:l,ventanas:c.ventanas.map((d,U)=>{console.log(`ğŸ” Mapeando ventana ${U}:`,d),console.log("ğŸ” v.tipoVidrio (para tipo_vidrio_id):",d.tipoVidrio),console.log("ğŸ” v.productoVidrioProveedor:",d.productoVidrioProveedor);const Y=no(d.productoVidrioProveedor),yo={id:d.id,tipo_ventana_id:d.tipo,ancho:d.ancho,alto:d.alto,cantidad:d.cantidad,color_id:d.color,tipo_vidrio_id:d.tipoVidrio,producto_vidrio_proveedor_id:d.productoVidrioProveedor,producto_id:Y==null?void 0:Y.producto_id,proveedor_id:Y==null?void 0:Y.proveedor_id,costo:d.costo_total||d.costo||0,costo_unitario:d.costo_unitario||0,precio:d.precio||0,precio_unitario:d.precio_unitario||0,tipo_ventana_izquierda:d.tipoVentanaIzquierda??null,tipo_ventana_centro:d.tipoVentanaCentro??null,tipo_ventana_derecha:d.tipoVentanaDerecha??null,ancho_izquierda:d.ancho_izquierda??null,ancho_centro:d.ancho_centro??null,ancho_derecha:d.ancho_derecha??null,hojas_totales:d.hojas_totales??null,hojas_moviles:d.hojas_moviles??null,hoja_movil_seleccionada:d.hojaMovilSeleccionada??null,hoja1_al_frente:d.hoja1AlFrente??null};return console.log(`ğŸ” Ventana ${U} mapeada:`,yo),console.log("ğŸ” tipo_vidrio_id en ventana mapeada:",yo.tipo_vidrio_id),yo}),productos:(c.productos||[]).map(d=>({id:d.id,producto_lista_id:d.producto_lista_id,lista_precio_id:d.lista_precio_id,descripcion:d.descripcion||d.nombre||"",cantidad:d.cantidad,precio_unitario:d.precio_venta/d.cantidad,total:d.total||d.precio_venta*d.cantidad,esVidrio:d.esVidrio||!1,ancho_mm:d.ancho_mm||null,alto_mm:d.alto_mm||null,m2:d.m2||null,pulido:d.pulido||!1}))};console.log("ğŸ“¤ PAYLOAD A ENVIAR:",A),console.log("ğŸ“¤ VENTANAS ESPECÃFICAS:",A.ventanas),console.log("ğŸ“¤ PRODUCTOS ESPECÃFICOS:",A.productos),g.value?(console.log("ğŸ”„ Actualizando cotizaciÃ³n existente ID:",y.value),await J.put(`/api/cotizaciones/${y.value}`,A),alert("CotizaciÃ³n actualizada correctamente")):(console.log("âœ¨ Creando nueva cotizaciÃ³n"),await J.post("/api/cotizaciones",A),alert("CotizaciÃ³n guardada correctamente")),V.push({name:"cotizaciones"})}catch(l){console.error("Error al guardar cotizaciÃ³n:",l),(o=(e=l.response)==null?void 0:e.data)!=null&&o.message?alert(l.response.data.message):alert("Error al guardar la cotizaciÃ³n")}finally{B.value=!1}};return(n,e)=>(b(),to(Vo,null,[a(Ca,{fluid:""},{default:t(()=>[a(_o,{class:"pa-6",elevation:"2"},{default:t(()=>[a(Io,{class:"text-h5 mb-4"},{default:t(()=>[p(R(g.value?"Editar CotizaciÃ³n":"Nueva CotizaciÃ³n"),1)]),_:1}),a(So,{class:"text-h5"},{default:t(()=>e[17]||(e[17]=[p("Datos generales")])),_:1}),a(fo,{class:"mb-4"}),a(co,{dense:""},{default:t(()=>[a($,{cols:"6",md:"4"},{default:t(()=>[a(co,{"no-gutters":"",align:"center"},{default:t(()=>[a($,null,{default:t(()=>[K("div",wa,[a(vo,{modelValue:H.value,"onUpdate:modelValue":e[0]||(e[0]=o=>H.value=o),onInput:De,onFocus:Te,"onClick:clear":$e,label:"Cliente",placeholder:"Buscar por RUT o nombre...",outlined:"",clearable:"",loading:lo.value,color:"primary","append-inner-icon":j.cliente?"mdi-check-circle":"mdi-magnify",hint:j.cliente?`Seleccionado: ${j.cliente.razon_social}`:"","persistent-hint":""},null,8,["modelValue","loading","append-inner-icon","hint"]),v.value&&E.value.length>0?(b(),N(_o,{key:0,style:{position:"absolute",top:"100%",left:"0",right:"0","z-index":"1000","max-height":"300px","overflow-y":"auto"},class:"mt-1",elevation:"8"},{default:t(()=>[a(ba,{density:"compact"},{default:t(()=>[(b(!0),to(Vo,null,Lo(E.value,o=>(b(),N(Mo,{key:o.id,onClick:l=>Ne(o),class:"cursor-pointer",hover:""},{prepend:t(()=>[a(L,null,{default:t(()=>e[18]||(e[18]=[p("mdi-account")])),_:1})]),default:t(()=>[a(wo,null,{default:t(()=>[p(R(o.razon_social),1)]),_:2},1024),a(Ro,null,{default:t(()=>[p(R(o.identification),1)]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})):ao("",!0)])]),_:1}),a($,{cols:"auto"},{default:t(()=>[a(W,{icon:"",color:"primary",onClick:ke,class:"ml-2"},{default:t(()=>[a(L,null,{default:t(()=>e[19]||(e[19]=[p("mdi-plus")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(co,{dense:""},{default:t(()=>[a($,{cols:"4"},{default:t(()=>[a(xa,{modelValue:c.observaciones,"onUpdate:modelValue":e[1]||(e[1]=o=>c.observaciones=o),label:"Observaciones","row-height":"15",rows:"1",outlined:"",color:"primary","auto-grow":""},null,8,["modelValue"])]),_:1})]),_:1}),a(fo,{class:"my-4"}),a(So,{class:"text-h5"},{default:t(()=>e[20]||(e[20]=[p("Items de la CotizaciÃ³n")])),_:1}),a(fo,{class:"mb-4"}),a(co,{class:"mb-4"},{default:t(()=>[a($,{cols:"auto"},{default:t(()=>[a(W,{color:"primary",onClick:D,disabled:!r.value.length},{default:t(()=>[a(L,{left:""},{default:t(()=>e[21]||(e[21]=[p("mdi-window-closed-variant")])),_:1}),e[22]||(e[22]=p(" Ventana "))]),_:1},8,["disabled"])]),_:1}),a($,{cols:"auto"},{default:t(()=>[a(W,{color:"success",onClick:q},{default:t(()=>[a(L,{left:""},{default:t(()=>e[23]||(e[23]=[p("mdi-package-variant")])),_:1}),e[24]||(e[24]=p(" Productos "))]),_:1})]),_:1})]),_:1}),a(Yo,null,{default:t(()=>[bo.value?(b(),N(_o,{key:0,class:"mb-4",outlined:""},{default:t(()=>[a(Go,null,{default:t(()=>[a(So,{class:"text-subtitle-1 font-weight-bold"},{default:t(()=>e[25]||(e[25]=[p("Pre-configuraciÃ³n de Ventana")])),_:1}),a(co,{dense:"",class:"mt-2"},{default:t(()=>[a($,{cols:"12",md:"6"},{default:t(()=>[a(ko,{modelValue:c.material,"onUpdate:modelValue":e[2]||(e[2]=o=>c.material=o),items:M.value,"item-title":"nombre","item-value":"id",label:"Material",outlined:"",dense:"",color:"primary"},null,8,["modelValue","items"])]),_:1}),a($,{cols:"12",md:"6"},{default:t(()=>[a(ko,{modelValue:c.color,"onUpdate:modelValue":e[3]||(e[3]=o=>c.color=o),items:h.value,"item-title":"nombre","item-value":"id",label:"Color",outlined:"",dense:"",color:"primary"},null,8,["modelValue","items"])]),_:1}),a($,{cols:"12",sm:"6"},{default:t(()=>[a(ko,{modelValue:c.tipoVidrio,"onUpdate:modelValue":e[4]||(e[4]=o=>c.tipoVidrio=o),items:G.value,"item-title":"nombre","item-value":"id",label:"Tipo de vidrio",outlined:"",dense:"",color:"primary"},null,8,["modelValue","items"])]),_:1}),a($,{cols:"12",sm:"6"},{default:t(()=>[a(ko,{modelValue:c.productoVidrioProveedor,"onUpdate:modelValue":e[5]||(e[5]=o=>c.productoVidrioProveedor=o),items:Q.value,"item-title":"nombre","item-value":"id",label:"Producto de vidrio",outlined:"",dense:"",color:"primary"},null,8,["modelValue","items"])]),_:1})]),_:1}),a(W,{color:"primary",onClick:s,block:"",class:"mt-2"},{default:t(()=>[a(L,{left:""},{default:t(()=>e[26]||(e[26]=[p("mdi-plus")])),_:1}),e[27]||(e[27]=p(" Agregar Ventana "))]),_:1})]),_:1})]),_:1})):ao("",!0)]),_:1}),c.ventanas.length>0?(b(),N(re,{key:0,headers:Bo,items:c.ventanas,class:"mt-4","items-per-page":5},{"item.tipo":t(({item:o})=>[p(R(S.value[Number(o.tipo)]||o.tipo),1)]),"item.acciones":t(({item:o,index:l})=>[a(W,{icon:"",onClick:m=>mo(l)},{default:t(()=>[a(L,null,{default:t(()=>e[28]||(e[28]=[p("mdi-pencil")])),_:1})]),_:2},1032,["onClick"]),a(W,{icon:"",color:"error",onClick:m=>Ie(l)},{default:t(()=>[a(L,null,{default:t(()=>e[29]||(e[29]=[p("mdi-delete")])),_:1})]),_:2},1032,["onClick"])]),_:1},8,["items"])):(b(),N(ne,{key:1,type:"info",variant:"tonal",class:"mt-4"},{default:t(()=>e[30]||(e[30]=[p(' No hay ventanas agregadas. Haz clic en "Agregar Ventana" para comenzar. ')])),_:1})),c.productos.length>0?(b(),N(re,{key:2,headers:x,items:c.productos,class:"mt-4","items-per-page":5},{top:t(()=>[a(Ma,{flat:"",color:"transparent"},{default:t(()=>[a(Ee,{class:"text-subtitle-1"},{default:t(()=>e[31]||(e[31]=[p("Productos")])),_:1})]),_:1})]),"item.nombre":t(({item:o})=>[K("div",null,[K("div",Ra,R(o.nombre),1),o.descripcion&&o.descripcion!==o.nombre?(b(),to("div",La,R(o.descripcion),1)):ao("",!0)])]),"item.precio_costo":t(({item:o})=>[p(" $"+R(Xo(o.precio_costo)),1)]),"item.margen":t(({item:o})=>[p(R(o.margen)+"% ",1)]),"item.precio_venta":t(({item:o})=>[p(" $"+R(Xo(o.precio_venta)),1)]),"item.acciones":t(({item:o,index:l})=>[a(W,{icon:"",color:"error",onClick:m=>oo(l)},{default:t(()=>[a(L,null,{default:t(()=>e[32]||(e[32]=[p("mdi-delete")])),_:1})]),_:2},1032,["onClick"])]),_:1},8,["items"])):ao("",!0),a(ta,{mostrar:uo.value,"onUpdate:mostrar":e[6]||(e[6]=o=>uo.value=o),materiales:M.value,colores:h.value,tiposVidrio:G.value,productosVidrio:T.value,tiposVentana:r.value,"material-default":c.material,"color-default":c.color,"tipo-vidrio-default":c.tipoVidrio,"producto-vidrio-default":c.productoVidrioProveedor,onGuardar:ho},null,8,["mostrar","materiales","colores","tiposVidrio","productosVidrio","tiposVentana","material-default","color-default","tipo-vidrio-default","producto-vidrio-default"]),a(va,{mostrar:po.value,"onUpdate:mostrar":e[7]||(e[7]=o=>po.value=o),ventana:Z.value,materiales:M.value,colores:h.value,tiposVidrio:G.value,productosVidrio:T.value,tiposVentana:r.value,onGuardar:ho},null,8,["mostrar","ventana","materiales","colores","tiposVidrio","productosVidrio","tiposVentana"]),a(ga,{mostrar:io.value,"onUpdate:mostrar":e[8]||(e[8]=o=>io.value=o),onAgregarProductos:O},null,8,["mostrar"]),a(fo,{class:"my-4"}),K("div",Ua,[a(W,{color:"primary",loading:B.value,disabled:B.value,onClick:Me},{loader:t(()=>[a(ea,{indeterminate:"",color:"white",size:"20"})]),default:t(()=>[p(" "+R(g.value?"Guardar Cambios":"Guardar CotizaciÃ³n"),1)]),_:1},8,["loading","disabled"])]),c.ventanas.length>0?(b(),to("div",Ba,[a(So,{class:"text-h5"},{default:t(()=>e[33]||(e[33]=[p("Vista previa de ventanas")])),_:1}),a(fo,{class:"mb-4"}),(b(!0),to(Vo,null,Lo(c.ventanas,(o,l)=>(b(),to("div",{key:l,class:"mb-4"},[a(_o,{class:"pa-4",outlined:""},{default:t(()=>[a(Io,null,{default:t(()=>[p(R(S.value[o.tipo]||`Ventana ${l+1}`),1)]),_:2},1024),a(co,null,{default:t(()=>[a($,{cols:"6"},{default:t(()=>{var m,f,_,A,d,U,Y,yo,Eo,$o,Qo,Zo,oe,ee,ae;return[o.tipo===1?(b(),N(ra,{key:0,ref_for:!0,ref:u=>{u&&(I.value[l]=u)},ancho:o.ancho,alto:o.alto,"color-marco":((m=h.value.find(u=>u.id===o.color))==null?void 0:m.nombre)||"blanco",material:o.material,tipoVidrio:o.tipoVidrio,productoVidrioProveedor:o.productoVidrioProveedor},null,8,["ancho","alto","color-marco","material","tipoVidrio","productoVidrioProveedor"])):o.tipo===2?(b(),N(_a,{key:1,ref_for:!0,ref:u=>{u&&(I.value[l]=u)},ancho:o.ancho,alto:o.alto,"color-marco":((f=h.value.find(u=>u.id===o.color))==null?void 0:f.nombre)||"blanco",material:o.material,tipoVidrio:o.tipoVidrio,productoVidrioProveedor:o.productoVidrioProveedor},null,8,["ancho","alto","color-marco","material","tipoVidrio","productoVidrioProveedor"])):o.tipo===45?(b(),N(aa,{key:2,ref_for:!0,ref:u=>{u&&(I.value[l]=u)},ancho:o.ancho,alto:o.alto,"color-marco":((_=h.value.find(u=>u.id===o.color))==null?void 0:_.nombre)||"blanco",material:o.material,tipoVidrio:o.tipoVidrio,productoVidrioProveedor:o.productoVidrioProveedor},null,8,["ancho","alto","color-marco","material","tipoVidrio","productoVidrioProveedor"])):o.tipo===56?(b(),N(na,{key:3,ref_for:!0,ref:u=>{u&&(I.value[l]=u)},ancho:o.ancho,alto:o.alto,"color-marco":((A=h.value.find(u=>u.id===o.color))==null?void 0:A.nombre)||"blanco",material:o.material,tipoVidrio:o.tipoVidrio,productoVidrioProveedor:o.productoVidrioProveedor},null,8,["ancho","alto","color-marco","material","tipoVidrio","productoVidrioProveedor"])):o.tipo===55?(b(),N(sa,{key:4,ref_for:!0,ref:u=>{u&&(I.value[l]=u)},ancho:o.ancho,alto:o.alto,"color-marco":((d=h.value.find(u=>u.id===o.color))==null?void 0:d.nombre)||"blanco",hoja1AlFrente:o.hoja1AlFrente,"hojas-moviles":o.hojas_moviles||2,"hoja-movil-seleccionada":o.hojaMovilSeleccionada||1},null,8,["ancho","alto","color-marco","hoja1AlFrente","hojas-moviles","hoja-movil-seleccionada"])):o.tipo===57?(b(),N(ca,{key:5,ref_for:!0,ref:u=>{u&&(I.value[l]=u)},ancho:o.ancho,alto:o.alto,"color-marco":((U=h.value.find(u=>u.id===o.color))==null?void 0:U.nombre)||"blanco",filas:o.filas||1,columnas:o.columnas||1,"altos-filas":o.altosFilas||[],"anchos-columnas":o.anchosColumnas||[],secciones:o.secciones||[[{tipo:1}]]},null,8,["ancho","alto","color-marco","filas","columnas","altos-filas","anchos-columnas","secciones"])):o.tipo===3?(b(),N(Va,{key:6,ref_for:!0,ref:u=>{u&&(I.value[l]=u)},ancho:o.ancho,alto:o.alto,"color-marco":((Y=h.value.find(u=>u.id===o.color))==null?void 0:Y.nombre)||"blanco",material:o.material,tipoVidrio:o.tipoVidrio,productoVidrioProveedor:o.productoVidrioProveedor,"hojas-totales":o.hojas_totales,"hojas-moviles":o.hojas_moviles,"hoja-movil-seleccionada":o.hojaMovilSeleccionada,"orden-hoja1-al-frente":o.hoja1AlFrente},null,8,["ancho","alto","color-marco","material","tipoVidrio","productoVidrioProveedor","hojas-totales","hojas-moviles","hoja-movil-seleccionada","orden-hoja1-al-frente"])):o.tipo===52?(b(),N(da,{key:7,ancho:o.ancho,alto:o.alto,"color-marco":((yo=h.value.find(u=>u.id===o.color))==null?void 0:yo.nombre)||"blanco",material:o.material,tipoVidrio:o.tipoVidrio,productoVidrioProveedor:o.productoVidrioProveedor,"hojas-totales":o.hojas_totales,"hojas-moviles":o.hojas_moviles,"hoja-movil-seleccionada":o.hojaMovilSeleccionada,"orden-hoja1-al-frente":o.hoja1AlFrente},null,8,["ancho","alto","color-marco","material","tipoVidrio","productoVidrioProveedor","hojas-totales","hojas-moviles","hoja-movil-seleccionada","orden-hoja1-al-frente"])):o.tipo===47?(b(),N(la,{key:8,ref_for:!0,ref:u=>{u&&(I.value[l]=u)},ancho:o.ancho,alto:o.alto,"color-marco":((Eo=h.value.find(u=>u.id===o.color))==null?void 0:Eo.nombre)||"blanco",material:o.material,tipoVidrio:o.tipoVidrio,productoVidrioProveedor:o.productoVidrioProveedor,"ancho-izquierda":o.ancho_izquierda,"ancho-centro":o.ancho_centro,"ancho-derecha":o.ancho_derecha,"tipo-ventana-izquierda":o.tipoVentanaIzquierda,"tipo-ventana-centro":o.tipoVentanaCentro,"tipo-ventana-derecha":o.tipoVentanaDerecha},null,8,["ancho","alto","color-marco","material","tipoVidrio","productoVidrioProveedor","ancho-izquierda","ancho-centro","ancho-derecha","tipo-ventana-izquierda","tipo-ventana-centro","tipo-ventana-derecha"])):o.tipo===46?(b(),N(ia,{key:9,ref_for:!0,ref:u=>{u&&(I.value[l]=u)},ancho:o.ancho,alto:o.alto,"color-marco":(($o=h.value.find(u=>u.id===o.color))==null?void 0:$o.nombre)||"blanco",material:o.material,tipoVidrio:o.tipoVidrio,productoVidrioProveedor:o.productoVidrioProveedor,"hojas-totales":o.hojas_totales,"hojas-moviles":o.hojas_moviles,"hoja-movil-seleccionada":o.hojaMovilSeleccionada,"orden-hoja1-al-frente":o.hoja1AlFrente},null,8,["ancho","alto","color-marco","material","tipoVidrio","productoVidrioProveedor","hojas-totales","hojas-moviles","hoja-movil-seleccionada","orden-hoja1-al-frente"])):o.tipo===53?(b(),N(ua,{key:10,ref_for:!0,ref:u=>{u&&(I.value[l]=u)},ancho:o.ancho,alto:o.alto,"color-marco":((Qo=h.value.find(u=>u.id===o.color))==null?void 0:Qo.nombre)||"blanco","lado-apertura":o.ladoApertura},null,8,["ancho","alto","color-marco","lado-apertura"])):o.tipo===49?(b(),N(pa,{key:11,ref_for:!0,ref:u=>{u&&(I.value[l]=u)},ancho:o.ancho,alto:o.alto,"color-marco":((Zo=h.value.find(u=>u.id===o.color))==null?void 0:Zo.nombre)||"blanco",material:o.material,tipoVidrio:o.tipoVidrio,productoVidrioProveedor:o.productoVidrioProveedor,"lado-inicial":o.ladoApertura||"izquierda"},null,8,["ancho","alto","color-marco","material","tipoVidrio","productoVidrioProveedor","lado-inicial"])):o.tipo===50?(b(),N(ma,{key:12,ref_for:!0,ref:u=>{u&&(I.value[l]=u)},ancho:o.ancho,alto:o.alto,"color-marco":((oe=h.value.find(u=>u.id===o.color))==null?void 0:oe.nombre)||"blanco",material:o.material,tipoVidrio:o.tipoVidrio,productoVidrioProveedor:o.productoVidrioProveedor,"lado-apertura":o.ladoApertura,"direccion-apertura":o.direccionApertura,"paso-libre":o.pasoLibre},null,8,["ancho","alto","color-marco","material","tipoVidrio","productoVidrioProveedor","lado-apertura","direccion-apertura","paso-libre"])):o.tipo===51?(b(),N(fa,{key:13,ref_for:!0,ref:u=>{u&&(I.value[l]=u)},ancho:o.ancho,alto:o.alto,"color-marco":((ee=h.value.find(u=>u.id===o.color))==null?void 0:ee.nombre)||"blanco","hoja-activa":o.hojaActiva,"direccion-apertura":o.direccionApertura,"paso-libre":o.pasoLibre},null,8,["ancho","alto","color-marco","hoja-activa","direccion-apertura","paso-libre"])):o.tipo===58?(b(),N($a,{key:14,ref_for:!0,ref:u=>{u&&(I.value[l]=u)},ancho:o.ancho,alto:o.alto,"color-marco":((ae=h.value.find(u=>u.id===o.color))==null?void 0:ae.nombre)||"blanco","configuracion-inicial":o.configuracionArmador,"tipos-ventana":F},null,8,["ancho","alto","color-marco","configuracion-inicial"])):ao("",!0)]}),_:2},1024),a($,{cols:"6"},{default:t(()=>[a(_o,{variant:"outlined"},{default:t(()=>[a(Io,null,{default:t(()=>e[34]||(e[34]=[p("Detalles")])),_:1}),a(Go,null,{default:t(()=>[K("p",null,[e[35]||(e[35]=K("strong",null,"Ancho:",-1)),p(" "+R(o.ancho)+"mm",1)]),K("p",null,[e[36]||(e[36]=K("strong",null,"Alto:",-1)),p(" "+R(o.alto)+"mm",1)]),K("p",null,[e[37]||(e[37]=K("strong",null,"Cantidad:",-1)),p(" "+R(o.cantidad),1)]),K("p",null,[e[38]||(e[38]=K("strong",null,"Precio:",-1)),p(" $"+R(o.precio),1)])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024)]))),128))])):ao("",!0)]),_:1})]),_:1}),a(Pa,{modelValue:P.value,"onUpdate:modelValue":e[16]||(e[16]=o=>P.value=o),"max-width":"600px"},{default:t(()=>[a(_o,null,{default:t(()=>[a(Io,{class:"text-h5 pa-4"},{default:t(()=>[a(L,{class:"mr-2",color:"primary"},{default:t(()=>e[39]||(e[39]=[p("mdi-account-plus")])),_:1}),e[40]||(e[40]=p(" Crear Cliente Nuevo "))]),_:1}),a(fo),a(Go,{class:"pa-4"},{default:t(()=>[a(ne,{type:"info",variant:"tonal",class:"mb-4"},{default:t(()=>e[41]||(e[41]=[p(" Este cliente se guardarÃ¡ en tu base de datos local. Para facturar, deberÃ¡s seleccionar un cliente sincronizado con Bsale. ")])),_:1}),a(Ea,{ref:"formCliente"},{default:t(()=>[a(co,null,{default:t(()=>[a($,{cols:"12"},{default:t(()=>[a(vo,{modelValue:C.value.razon_social,"onUpdate:modelValue":e[9]||(e[9]=o=>C.value.razon_social=o),label:"RazÃ³n Social / Nombre *",rules:[o=>!!o||"RazÃ³n social es requerida"],required:"",outlined:""},null,8,["modelValue","rules"])]),_:1}),a($,{cols:"12",md:"6"},{default:t(()=>[a(vo,{modelValue:C.value.identification,"onUpdate:modelValue":e[10]||(e[10]=o=>C.value.identification=o),label:"RUT",outlined:"",hint:"Formato: 12345678-9"},null,8,["modelValue"])]),_:1}),a($,{cols:"12",md:"6"},{default:t(()=>[a(vo,{modelValue:C.value.email,"onUpdate:modelValue":e[11]||(e[11]=o=>C.value.email=o),label:"Email",type:"email",outlined:""},null,8,["modelValue"])]),_:1}),a($,{cols:"12",md:"6"},{default:t(()=>[a(vo,{modelValue:C.value.phone,"onUpdate:modelValue":e[12]||(e[12]=o=>C.value.phone=o),label:"TelÃ©fono",outlined:""},null,8,["modelValue"])]),_:1}),a($,{cols:"12",md:"6"},{default:t(()=>[a(vo,{modelValue:C.value.ciudad,"onUpdate:modelValue":e[13]||(e[13]=o=>C.value.ciudad=o),label:"Ciudad",outlined:""},null,8,["modelValue"])]),_:1}),a($,{cols:"12"},{default:t(()=>[a(vo,{modelValue:C.value.address,"onUpdate:modelValue":e[14]||(e[14]=o=>C.value.address=o),label:"DirecciÃ³n",outlined:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},512)]),_:1}),a(fo),a(ye,{class:"pa-4"},{default:t(()=>[a(Ce),a(W,{color:"grey",text:"",onClick:e[15]||(e[15]=o=>P.value=!1)},{default:t(()=>e[42]||(e[42]=[p(" Cancelar ")])),_:1}),a(W,{color:"primary",onClick:ze},{default:t(()=>[a(L,{left:""},{default:t(()=>e[43]||(e[43]=[p("mdi-content-save")])),_:1}),e[44]||(e[44]=p(" Guardar Cliente "))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64))}},Ml=Ko(qa,[["__scopeId","data-v-338df023"]]);export{Ml as default};
